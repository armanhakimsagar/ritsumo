import{r as d,j as e}from"./ui-Ps9nvBG1.js";import{u as _e,K as De,t as h,h as Te,L as Ae,S as se,I as E,B as l,e as S,f as p,C as _,d as L,D as te,an as ae,l as re,n as ie,o as le,a as ke,b as Le,g as ne}from"./app-BTt_gkO3.js";import{S as ce,a as de,b as me,c as oe,d as b}from"./select-z0EzYxFC.js";import{T as he}from"./textarea-DPiv_-Qc.js";import{C as $}from"./checkbox-ux8-2I9a.js";import{T as Re,a as Fe,b as xe,c as f,d as Pe,e as N}from"./table-CxFq10cW.js";import{P as ze,L as Be}from"./page-template-BeQadk1c.js";import{D as Ee,a as $e,b as He,c as ge}from"./dropdown-menu-CvJwe1WI.js";import{F as Me}from"./filter-C99mLYzj.js";import{L as Oe}from"./list-D1IfOmxs.js";import{C as R}from"./circle-check-big-BMYVPbRH.js";import{C as F}from"./circle-x-BnYRe0cI.js";import{U as je}from"./user-DZ3jVi18.js";import{C as qe}from"./calendar-pZCS8WPy.js";import{T as Ie}from"./timer-Cde2YpCK.js";import{D as Ue}from"./dollar-sign-CY6xo33T.js";import{M as Ve}from"./message-square-DGoN5Yg5.js";import{E as Qe}from"./ellipsis-DhhTm3i6.js";import{E as Ge}from"./eye-BGcEqodV.js";import{C as Ke}from"./clock-NAV_RQL_.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./globe-BYIVGjA8.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./credit-card-BwPrmecT.js";import"./mail-CZ8KgBhk.js";import"./settings-CG31wyPI.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";function $s({approvals:a,filters:r,userWorkspaceRole:We,permissions:Xe}){var J,Y,Z,ee;const{t:i}=_e(),{flash:x,auth:P}=De().props,ue=(P==null?void 0:P.permissions)||[],[m,H]=d.useState(r.view||"grid"),[n,M]=d.useState(r.status||"all"),[c,O]=d.useState(r.search||""),[w,q]=d.useState(r.per_page||"12"),[z,I]=d.useState(!1),[o,D]=d.useState([]),[U,V]=d.useState(""),[pe,T]=d.useState(!1),[g,Q]=d.useState("approve");d.useEffect(()=>{x!=null&&x.success&&h.success(x.success),x!=null&&x.error&&h.error(x.error)},[x]);const y=Te(ue,"timesheet_approve"),fe=()=>{const s={page:1,per_page:w,view:m};n!=="all"&&(s.status=n),c.trim()&&(s.search=c.trim()),r.from_date&&(s.from_date=r.from_date),r.to_date&&(s.to_date=r.to_date),p.get(route("timesheet-approvals.index"),s,{preserveState:!1,preserveScroll:!1})},Ne=s=>{s.preventDefault(),fe()},ve=s=>{M(s);const t={page:1,per_page:w,view:m};c.trim()&&(t.search=c.trim()),s!=="all"&&(t.status=s),r.from_date&&(t.from_date=r.from_date),r.to_date&&(t.to_date=r.to_date),p.get(route("timesheet-approvals.index"),t,{preserveState:!1,preserveScroll:!1})},G=()=>{M("all"),O(""),q("12"),I(!1),p.get(route("timesheet-approvals.index"),{per_page:"12",view:m},{preserveState:!1,preserveScroll:!1})},A=()=>n!=="all"||c!==""||r.from_date||r.to_date,be=()=>(n!=="all"?1:0)+(c?1:0)+(r.from_date?1:0)+(r.to_date?1:0),we=(s,t,j)=>{const v=s==="approve"?route("timesheet-approvals.approve",t):route("timesheet-approvals.reject",t);h.loading(i(`${s==="approve"?"Approving":"Rejecting"} timesheet...`)),p.post(v,{comments:j||""},{onSuccess:()=>{h.dismiss()},onError:()=>{h.dismiss(),h.error(i(`Failed to ${s} timesheet`))}})},ye=()=>{if(o.length===0)return;const s=g==="approve"?route("timesheet-approvals.bulk-approve"):route("timesheet-approvals.bulk-reject");h.loading(i(`${g==="approve"?"Approving":"Rejecting"} timesheets...`)),p.post(s,{approval_ids:o,comments:U},{onSuccess:()=>{h.dismiss(),D([]),V(""),T(!1)},onError:()=>{h.dismiss(),h.error(i(`Failed to ${g} timesheets`))}})},K=s=>{D(t=>t.includes(s)?t.filter(j=>j!==s):[...t,s])},W=()=>{const s=a.data.filter(t=>t.status==="pending");o.length===s.length?D([]):D(s.map(t=>t.id))},X=s=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",k=({approval:s,action:t,trigger:j})=>{const[v,C]=d.useState(""),[u,B]=d.useState(!1);return e.jsxs(te,{open:u,onOpenChange:B,children:[e.jsx(ae,{asChild:!0,children:j}),e.jsxs(re,{className:"sm:max-w-md",children:[e.jsx(ie,{children:e.jsxs(le,{className:"flex items-center gap-2",children:[t==="approve"?e.jsx(R,{className:"h-5 w-5 text-green-600"}):e.jsx(F,{className:"h-5 w-5 text-red-600"}),t==="approve"?"Approve":"Reject"," Timesheet"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(je,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:s.timesheet.user.name})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[new Date(s.timesheet.start_date).toLocaleDateString()," - ",new Date(s.timesheet.end_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{className:"text-sm font-medium",children:t==="reject"?"Reason for rejection *":"Comments (optional)"}),e.jsx(he,{placeholder:t==="reject"?"Please provide reason for rejection...":"Add approval comments...",value:v,onChange:Ce=>C(Ce.target.value),rows:3,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(l,{variant:"outline",onClick:()=>B(!1),children:"Cancel"}),e.jsx(l,{variant:t==="approve"?"default":"destructive",disabled:t==="reject"&&!v.trim(),onClick:()=>{we(t,s.id,v),C(""),B(!1)},children:t==="approve"?"Approve":"Reject"})]})]})]})]})},Se=[{title:i("Dashboard"),href:route("dashboard")},{title:i("Timesheets"),href:route("timesheets.index")},{title:i("Approvals")}];return e.jsxs(ze,{title:i("Timesheet Approvals"),breadcrumbs:Se,noPadding:!0,children:[e.jsx(Ae,{title:i("Timesheet Approvals")}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow mb-4",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("form",{onSubmit:Ne,className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-64",children:[e.jsx(se,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(E,{placeholder:i("Search by employee name..."),value:c,onChange:s=>O(s.target.value),className:"w-full pl-9"})]}),e.jsxs(l,{type:"submit",size:"sm",children:[e.jsx(se,{className:"h-4 w-4 mr-1.5"}),i("Search")]})]}),e.jsx("div",{className:"ml-2",children:e.jsxs(l,{variant:A()?"default":"outline",size:"sm",className:"h-8 px-2 py-1",onClick:()=>I(!z),children:[e.jsx(Me,{className:"h-3.5 w-3.5 mr-1.5"}),i(z?"Hide Filters":"Filters"),A()&&e.jsx("span",{className:"ml-1 bg-primary-foreground text-primary rounded-full w-5 h-5 flex items-center justify-center text-xs",children:be()})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"border rounded-md p-0.5 mr-2",children:[e.jsx(l,{size:"sm",variant:m==="list"?"default":"ghost",className:"h-7 px-2",onClick:()=>H("list"),children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx(l,{size:"sm",variant:m==="grid"?"default":"ghost",className:"h-7 px-2",onClick:()=>H("grid"),children:e.jsx(Be,{className:"h-4 w-4"})})]}),e.jsx(S,{className:"text-xs text-muted-foreground",children:"Per Page:"}),e.jsxs(ce,{value:w,onValueChange:s=>{q(s);const t={page:1,per_page:s,view:m};n!=="all"&&(t.status=n),c.trim()&&(t.search=c.trim()),r.from_date&&(t.from_date=r.from_date),r.to_date&&(t.to_date=r.to_date),p.get(route("timesheet-approvals.index"),t,{preserveState:!1,preserveScroll:!1})},children:[e.jsx(de,{className:"w-16 h-8",children:e.jsx(me,{})}),e.jsxs(oe,{children:[e.jsx(b,{value:"12",children:"12"}),e.jsx(b,{value:"24",children:"24"}),e.jsx(b,{value:"48",children:"48"})]})]})]})]}),z&&e.jsx("div",{className:"w-full mt-3 p-4 bg-gray-50 border rounded-md",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:i("Status")}),e.jsxs(ce,{value:n,onValueChange:ve,children:[e.jsx(de,{className:"w-40",children:e.jsx(me,{placeholder:"All Status"})}),e.jsxs(oe,{children:[e.jsx(b,{value:"all",children:i("All Status")}),e.jsx(b,{value:"pending",children:i("Pending")}),e.jsx(b,{value:"approved",children:i("Approved")}),e.jsx(b,{value:"rejected",children:i("Rejected")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"From Date"}),e.jsx(E,{type:"date",value:r.from_date||"",onChange:s=>{const t={page:1,per_page:w,view:m};c&&(t.search=c),n!=="all"&&(t.status=n),s.target.value&&(t.from_date=s.target.value),r.to_date&&(t.to_date=r.to_date),p.get(route("timesheet-approvals.index"),t,{preserveState:!1,preserveScroll:!1})},className:"w-40"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:"To Date"}),e.jsx(E,{type:"date",value:r.to_date||"",onChange:s=>{const t={page:1,per_page:w,view:m};c&&(t.search=c),n!=="all"&&(t.status=n),r.from_date&&(t.from_date=r.from_date),s.target.value&&(t.to_date=s.target.value),p.get(route("timesheet-approvals.index"),t,{preserveState:!1,preserveScroll:!1})},className:"w-40"})]}),e.jsx(l,{variant:"outline",size:"sm",className:"h-9",onClick:G,disabled:!A(),children:"Reset Filters"})]})})]})}),o.length>0&&y&&e.jsx(_,{className:"border-l-4 border-l-blue-500 bg-blue-50/50",children:e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:[o.length," selected"]}),e.jsxs(te,{open:pe,onOpenChange:T,children:[e.jsx(ae,{asChild:!0,children:e.jsxs(l,{size:"sm",onClick:()=>Q("approve"),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Bulk Approve"]})}),e.jsxs(re,{children:[e.jsx(ie,{children:e.jsxs(le,{className:"flex items-center gap-2",children:[g==="approve"?e.jsx(R,{className:"h-5 w-5 text-green-600"}):e.jsx(F,{className:"h-5 w-5 text-red-600"}),g==="approve"?"Approve":"Reject"," Timesheets"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to ",g," ",o.length," timesheet(s)?"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{className:"text-sm font-medium",children:"Comments"}),e.jsx(he,{placeholder:`Add comments for ${g}...`,value:U,onChange:s=>V(s.target.value),rows:3,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(l,{variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsx(l,{variant:g==="approve"?"default":"destructive",onClick:ye,children:g==="approve"?"Approve":"Reject"})]})]})]})]}),e.jsxs(l,{size:"sm",variant:"destructive",onClick:()=>{Q("reject"),T(!0)},children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Bulk Reject"]})]}),e.jsx(l,{variant:"outline",size:"sm",onClick:W,children:o.length===a.data.filter(s=>s.status==="pending").length&&a.data.filter(s=>s.status==="pending").length>0?"Deselect All":"Select All Pending"})]})})}),m==="grid"||!m?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-4",children:(J=a==null?void 0:a.data)==null?void 0:J.map(s=>e.jsxs(_,{className:"hover:shadow-md transition-shadow",children:[e.jsx(ke,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="pending"&&y&&e.jsx($,{checked:o.includes(s.id),onCheckedChange:()=>K(s.id)}),e.jsx(Le,{className:"text-sm font-medium",children:s.timesheet.user.name})]}),e.jsx(ne,{className:X(s.status),variant:"secondary",children:s.status})]})}),e.jsxs(L,{className:"space-y-3 pt-0",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:[new Date(s.timesheet.start_date).toLocaleDateString()," - ",new Date(s.timesheet.end_date).toLocaleDateString()]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Total: ",e.jsxs("strong",{children:[s.timesheet.total_hours,"h"]})]}),e.jsxs("span",{children:["Billable: ",e.jsxs("strong",{className:"text-green-600",children:[s.timesheet.billable_hours,"h"]})]})]}),s.status==="pending"&&y&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(k,{approval:s,action:"approve",trigger:e.jsx(l,{size:"sm",className:"flex-1 h-7 text-xs",children:"Approve"})}),e.jsx(k,{approval:s,action:"reject",trigger:e.jsx(l,{size:"sm",variant:"destructive",className:"flex-1 h-7 text-xs",children:"Reject"})})]})]})]},s.id))}):e.jsx(_,{className:"border-0 shadow-sm",children:e.jsxs(Re,{children:[e.jsx(Fe,{children:e.jsxs(xe,{className:"border-gray-200",children:[e.jsx(f,{className:"w-12",children:y&&e.jsx($,{checked:o.length===a.data.filter(s=>s.status==="pending").length&&a.data.filter(s=>s.status==="pending").length>0,onCheckedChange:W})}),e.jsx(f,{className:"font-semibold text-gray-700",children:"Employee"}),e.jsx(f,{className:"font-semibold text-gray-700",children:"Period"}),e.jsx(f,{className:"font-semibold text-gray-700",children:"Total Hours"}),e.jsx(f,{className:"font-semibold text-gray-700",children:"Billable Hours"}),e.jsx(f,{className:"font-semibold text-gray-700",children:"Status"}),e.jsx(f,{className:"font-semibold text-gray-700",children:"Comments"}),e.jsx(f,{className:"text-right font-semibold text-gray-700",children:"Actions"})]})}),e.jsx(Pe,{children:(Y=a==null?void 0:a.data)==null?void 0:Y.map(s=>e.jsxs(xe,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(N,{children:s.status==="pending"&&y&&e.jsx($,{checked:o.includes(s.id),onCheckedChange:()=>K(s.id)})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.timesheet.user.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",s.timesheet.id]})]})]})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{className:"text-sm",children:[new Date(s.timesheet.start_date).toLocaleDateString()," - ",new Date(s.timesheet.end_date).toLocaleDateString()]})]})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-4 w-4 text-blue-500"}),e.jsxs("span",{className:"font-medium",children:[s.timesheet.total_hours,"h"]})]})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{className:"font-medium text-green-600",children:[s.timesheet.billable_hours,"h"]})]})}),e.jsx(N,{children:e.jsx(ne,{className:`${X(s.status)} border-0`,variant:"secondary",children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),e.jsx(N,{children:s.comments&&e.jsx("div",{className:"max-w-xs",children:e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm truncate",title:s.comments,children:s.comments})]})})}),e.jsx(N,{className:"text-right",children:s.status==="pending"&&y?e.jsxs(Ee,{children:[e.jsx($e,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(Qe,{className:"h-4 w-4"})})}),e.jsxs(He,{align:"end",children:[e.jsx(k,{approval:s,action:"approve",trigger:e.jsxs(ge,{onSelect:t=>t.preventDefault(),children:[e.jsx(R,{className:"h-4 w-4 mr-2 text-green-600"}),"Approve"]})}),e.jsx(k,{approval:s,action:"reject",trigger:e.jsxs(ge,{onSelect:t=>t.preventDefault(),children:[e.jsx(F,{className:"h-4 w-4 mr-2 text-red-600"}),"Reject"]})})]})]}):e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(Ge,{className:"h-4 w-4"})})})]},s.id))})]})}),((Z=a==null?void 0:a.data)==null?void 0:Z.length)===0&&e.jsx(_,{className:"border-0 shadow-sm",children:e.jsxs(L,{className:"p-12 text-center",children:[e.jsx("div",{className:"bg-gray-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:e.jsx(Ke,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No timesheet approvals found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:n!=="all"?"Try changing the status filter to see more results":"There are no timesheet approvals to review at the moment"}),A()&&e.jsx(l,{variant:"outline",onClick:G,children:"Clear Filters"})]})}),(a==null?void 0:a.links)&&a.data.length>0&&e.jsx(_,{className:"border-0 shadow-sm",children:e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-medium text-gray-900",children:(a==null?void 0:a.from)||0})," to ",e.jsx("span",{className:"font-medium text-gray-900",children:(a==null?void 0:a.to)||0})," of ",e.jsx("span",{className:"font-medium text-gray-900",children:(a==null?void 0:a.total)||0})," approvals"]}),e.jsx("div",{className:"flex gap-1",children:(ee=a==null?void 0:a.links)==null?void 0:ee.map((s,t)=>{const j=s.label==="&laquo; Previous"||s.label==="Next &raquo;",v=s.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(l,{variant:s.active?"default":"outline",size:j?"sm":"icon",className:`${j?"px-3":"h-9 w-9"} ${s.active?"bg-blue-600 hover:bg-blue-700":""}`,disabled:!s.url,onClick:()=>{if(s.url){const C=new URL(s.url,window.location.origin),u=new URLSearchParams(C.search);n!=="all"&&u.set("status",n),searchQuery.trim()&&u.set("search",searchQuery.trim()),r.from_date&&u.set("from_date",r.from_date),r.to_date&&u.set("to_date",r.to_date),u.set("view",m),u.set("per_page",w),p.get(`${C.pathname}?${u.toString()}`)}},children:j?v:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},t)})})]})})})]})]})}export{$s as default};
