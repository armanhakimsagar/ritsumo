import{r as x,j as r}from"./ui-Ps9nvBG1.js";import{P as U}from"./page-template-BeQadk1c.js";import{C as X}from"./CrudTable-Dq4zN5Ad.js";import{c as G}from"./columnRenderers-gRjLE1do.js";import{t as i}from"./i18n-DqlZoCzL.js";import{u as J,K as Q,t as d,S as _,I as W,B as w,e as k,f as u}from"./app-BTt_gkO3.js";import{S as E,a as A,b as T,c as R,d as g}from"./select-z0EzYxFC.js";import{F as Y}from"./filter-C99mLYzj.js";import"./vendor-B1hewrmX.js";import"./textarea-DPiv_-Qc.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./chevron-up-CaRG6751.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./clock-NAV_RQL_.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";import"./table-CxFq10cW.js";import"./activity-BmMDIvmq.js";import"./unlink-Da4sYO3X.js";import"./archive-B7y_TeQV.js";import"./minus-CDE_iHiI.js";import"./arrow-left-VMG9JuEa.js";import"./arrow-right-BKcgVE4F.js";import"./code-BqYpr4o9.js";import"./lock-open-B07HE5u7.js";import"./award-Bb-BmrHF.js";import"./indian-rupee-CXBAgLWO.js";import"./webhook-BDBcvkpM.js";import"./building-D7PWBF3-.js";import"./calendar-pZCS8WPy.js";import"./chart-column-CH-40Yjn.js";import"./chevron-left-BAvb6WGn.js";import"./circle-alert-DCoDy4PA.js";import"./circle-check-big-BMYVPbRH.js";import"./circle-check-B5E119oN.js";import"./circle-help-DcK-i_SQ.js";import"./circle-x-BnYRe0cI.js";import"./circle-B-lwSO-9.js";import"./coins-QSIO91L8.js";import"./columns-3-BJflJd0h.js";import"./crown-h0ONqO0b.js";import"./download-FY3rJJBK.js";import"./ellipsis-DhhTm3i6.js";import"./external-link-DZ7-d7Y_.js";import"./eye-off-CBRrilSi.js";import"./eye-BGcEqodV.js";import"./instagram-CVFp5Sx_.js";import"./file-3AWHN2l6.js";import"./grip-vertical-1PuRD1LT.js";import"./hard-drive-DkZiK8kb.js";import"./heart-CNQFES80.js";import"./house-Bz__QWIz.js";import"./info-CWa1AAnn.js";import"./key-Z3HmnV2-.js";import"./lightbulb-DQSQ9qNV.js";import"./link-2-pbuNzVBD.js";import"./link-DceUnw3z.js";import"./twitter-CZjBB1-K.js";import"./list-D1IfOmxs.js";import"./lock-BlSlbQY6.js";import"./map-pin-wCNGu7TE.js";import"./menu-BH-rpoiU.js";import"./message-circle-DFnVEf3y.js";import"./monitor-U4qpGUkK.js";import"./wifi-CvP3D_V4.js";import"./paperclip-h_SfHoPk.js";import"./pause-vB4M0M_Y.js";import"./tag-OznyPslI.js";import"./phone-CcborKQC.js";import"./pin-z3kXVgm0.js";import"./play-C9ujj4pR.js";import"./power-DtAmx68i.js";import"./quote-DqGKb1gV.js";import"./send-B0OsKa7V.js";import"./server-CK254A3D.js";import"./shield-D21jpLkF.js";import"./square-pen-BE6Ef4zh.js";import"./square-DyzuZ8y2.js";import"./star-LRbmONxX.js";import"./sticky-note-BnqKoA0i.js";import"./target-LDs0Bf_v.js";import"./timer-Cde2YpCK.js";import"./toggle-right-uccKRcAk.js";import"./trash-2-WsAE_ige.js";import"./trending-down-CxK3FgOd.js";import"./type-DfB6MBM_.js";import"./user-check-DxK1QmPp.js";import"./user-plus-cb7gLVi3.js";import"./users-ClK0ij4u.js";import"./wallet-CH1oYh2R.js";import"./zap-D5bA-otg.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";const n={entity:{endpoint:route("plan-orders.index"),permissions:{view:"view-plan-orders",create:"create-plan-orders",edit:"edit-plan-orders",delete:"delete-plan-orders"}},description:i("Manage plan orders and subscription requests"),table:{columns:[{key:"order_number",label:i("Order Number"),sortable:!0},{key:"ordered_at",label:i("Order Date"),sortable:!0,render:G.date()},{key:"user.name",label:i("User Name"),sortable:!1},{key:"plan.name",label:i("Plan Name"),sortable:!1},{key:"original_price",label:i("Original Price"),render:e=>{var a;return typeof window<"u"&&((a=window.appSettings)!=null&&a.formatCurrency)?window.appSettings.formatCurrency(parseFloat(e)):`${parseFloat(e).toFixed(2)}`}},{key:"coupon_code",label:i("Coupon Code"),render:e=>e||"-"},{key:"discount_amount",label:i("Discount"),render:e=>{var a;return e>0?typeof window<"u"&&((a=window.appSettings)!=null&&a.formatCurrency)?`-${window.appSettings.formatCurrency(parseFloat(e))}`:`-${parseFloat(e).toFixed(2)}`:"-"}},{key:"final_price",label:i("Final Price"),render:e=>{var a;return typeof window<"u"&&((a=window.appSettings)!=null&&a.formatCurrency)?window.appSettings.formatCurrency(parseFloat(e)):`${parseFloat(e).toFixed(2)}`}},{key:"status",label:i("Status"),render:e=>{const a={pending:{label:i("Pending"),className:"bg-yellow-100 text-yellow-800"},approved:{label:i("Approved"),className:"bg-green-100 text-green-800"},rejected:{label:i("Rejected"),className:"bg-red-100 text-red-800"}};return(a[e]||a.pending).label}}],actions:[{label:i("Approve"),icon:"Check",action:"approve",className:"text-green-600",condition:e=>e.status==="pending"},{label:i("Reject"),icon:"X",action:"reject",className:"text-red-600",condition:e=>e.status==="pending"}]},search:{placeholder:i("Search orders...")},filters:[{key:"status",label:i("Status"),type:"select",options:[{value:"all",label:i("All Status")},{value:"pending",label:i("Pending")},{value:"approved",label:i("Approved")},{value:"rejected",label:i("Rejected")}]}]};function rt(){var S,N,F,C,P;const{t:e}=J(),{flash:a,planOrders:l,filters:m={},auth:f,isMyOrders:q=!1}=Q().props,I=(f==null?void 0:f.permissions)||[],V=((S=f.user)==null?void 0:S.type)||((N=f.user)==null?void 0:N.role),[p,D]=x.useState(m.search||""),[h,y]=x.useState({}),[b,M]=x.useState(!1);x.useEffect(()=>{a!=null&&a.success&&d.success(a.success),a!=null&&a.error&&d.error(a.error)},[a]),x.useEffect(()=>{var o;const t={};(o=n.filters)==null||o.forEach(s=>{t[s.key]=m[s.key]||"all"}),y(t)},[]);const $=(t,o)=>{if(t==="approve")u.post(route("plan-orders.approve",o.id),{},{onSuccess:()=>{d.success(e("Plan order approved successfully"))},onError:()=>{d.error(e("Failed to approve plan order"))}});else if(t==="reject"){const s=prompt(e("Rejection reason (optional)")+":");u.post(route("plan-orders.reject",o.id),{notes:s},{onSuccess:()=>{d.success(e("Plan order rejected successfully"))},onError:()=>{d.error(e("Failed to reject plan order"))}})}},z=t=>{t.preventDefault(),L()},L=()=>{const t={page:1};p&&(t.search=p),Object.entries(h).forEach(([o,s])=>{s&&s!=="all"&&(t[o]=s)}),m.per_page&&(t.per_page=m.per_page),u.get(route("plan-orders.index"),t,{preserveState:!0,preserveScroll:!0})},B=(t,o)=>{y(j=>({...j,[t]:o}));const s={page:1};p&&(s.search=p);const c={...h,[t]:o};Object.entries(c).forEach(([j,v])=>{v&&v!=="all"&&(s[j]=v)}),m.per_page&&(s.per_page=m.per_page),u.get(route("plan-orders.index"),s,{preserveState:!0,preserveScroll:!0})},H=[{title:e("Dashboard"),href:route("dashboard")},{title:e("Plans"),href:route("plans.index")},{title:e("Plan Orders")}],K=()=>Object.entries(h).some(([t,o])=>o&&o!=="")||p!=="",O=q||V!=="superadmin"?[]:(F=n.table.actions)==null?void 0:F.map(t=>({...t,label:e(t.label)}));return r.jsxs(U,{title:e("Plan Orders"),url:"/plan-orders",breadcrumbs:H,noPadding:!0,children:[r.jsx("div",{className:"bg-white rounded-lg shadow mb-4",children:r.jsxs("div",{className:"p-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("form",{onSubmit:z,className:"flex gap-2",children:[r.jsxs("div",{className:"relative w-64",children:[r.jsx(_,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),r.jsx(W,{placeholder:e("Search plan orders..."),value:p,onChange:t=>D(t.target.value),className:"w-full pl-9"})]}),r.jsxs(w,{type:"submit",size:"sm",children:[r.jsx(_,{className:"h-4 w-4 mr-1.5"}),e("Search")]})]}),n.filters&&n.filters.length>0&&r.jsx("div",{className:"ml-2",children:r.jsxs(w,{variant:K()?"default":"outline",size:"sm",className:"h-8 px-2 py-1",onClick:()=>M(!b),children:[r.jsx(Y,{className:"h-3.5 w-3.5 mr-1.5"}),e(b?"Hide Filters":"Filters")]})})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(k,{className:"text-xs text-muted-foreground",children:[e("Per Page"),":"]}),r.jsxs(E,{value:((C=m.per_page)==null?void 0:C.toString())||"10",onValueChange:t=>{const o={page:1,per_page:parseInt(t)};p&&(o.search=p),Object.entries(h).forEach(([s,c])=>{c&&c!==""&&(o[s]=c)}),u.get(route("plan-orders.index"),o,{preserveState:!0,preserveScroll:!0})},children:[r.jsx(A,{className:"w-16 h-8",children:r.jsx(T,{})}),r.jsxs(R,{children:[r.jsx(g,{value:"10",children:"10"}),r.jsx(g,{value:"25",children:"25"}),r.jsx(g,{value:"50",children:"50"}),r.jsx(g,{value:"100",children:"100"})]})]})]})]}),b&&n.filters&&n.filters.length>0&&r.jsx("div",{className:"w-full mt-3 p-4 bg-gray-50 border rounded-md",children:r.jsx("div",{className:"flex flex-wrap gap-4 items-end",children:n.filters.map(t=>{var o;return r.jsxs("div",{className:"space-y-2",children:[r.jsx(k,{children:e(t.label)}),r.jsxs(E,{value:h[t.key]||"",onValueChange:s=>B(t.key,s),children:[r.jsx(A,{className:"w-40",children:r.jsx(T,{placeholder:e("All")+" "+e(t.label)})}),r.jsx(R,{children:(o=t.options)==null?void 0:o.map(s=>r.jsx(g,{value:s.value,children:e(s.label)},s.value))})]})]},t.key)})})})]})}),r.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[r.jsx(X,{columns:n.table.columns.map(t=>({...t,label:e(t.label)})),actions:O,data:(l==null?void 0:l.data)||[],from:(l==null?void 0:l.from)||1,onAction:$,permissions:I,entityPermissions:n.entity.permissions}),r.jsxs("div",{className:"p-4 border-t flex items-center justify-between ",children:[r.jsxs("div",{className:"text-sm text-muted-foreground",children:[e("Showing")," ",r.jsx("span",{className:"font-medium",children:(l==null?void 0:l.from)||0})," ",e("to")," ",r.jsx("span",{className:"font-medium",children:(l==null?void 0:l.to)||0})," ",e("of")," ",r.jsx("span",{className:"font-medium",children:(l==null?void 0:l.total)||0})," ",e("plan orders")]}),r.jsx("div",{className:"flex gap-1",children:(P=l==null?void 0:l.links)==null?void 0:P.map((t,o)=>{const s=t.label==="&laquo; Previous"||t.label==="Next &raquo;",c=t.label.replace("&laquo; ","").replace(" &raquo;","");return r.jsx(w,{variant:t.active?"default":"outline",size:s?"sm":"icon",className:s?"px-3":"h-8 w-8",disabled:!t.url,onClick:()=>t.url&&u.get(t.url),children:s?e(c):r.jsx("span",{dangerouslySetInnerHTML:{__html:t.label}})},o)})})]})]})]})}export{rt as default};
