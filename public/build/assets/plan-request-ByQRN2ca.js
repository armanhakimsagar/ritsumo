import{r as f,j as r}from"./ui-Ps9nvBG1.js";import{P as R}from"./page-template-BeQadk1c.js";import{C as Y}from"./CrudTable-Dq4zN5Ad.js";import{c as P}from"./columnRenderers-gRjLE1do.js";import{t as l}from"./i18n-DqlZoCzL.js";import{u as G,K as J,t as i,S as C,I as Q,B as y,e as k,f as c}from"./app-BTt_gkO3.js";import{S as E,a as A,b as T,c as _,d as b}from"./select-z0EzYxFC.js";import{F as U}from"./filter-C99mLYzj.js";import"./vendor-B1hewrmX.js";import"./textarea-DPiv_-Qc.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./chevron-up-CaRG6751.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./clock-NAV_RQL_.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";import"./table-CxFq10cW.js";import"./activity-BmMDIvmq.js";import"./unlink-Da4sYO3X.js";import"./archive-B7y_TeQV.js";import"./minus-CDE_iHiI.js";import"./arrow-left-VMG9JuEa.js";import"./arrow-right-BKcgVE4F.js";import"./code-BqYpr4o9.js";import"./lock-open-B07HE5u7.js";import"./award-Bb-BmrHF.js";import"./indian-rupee-CXBAgLWO.js";import"./webhook-BDBcvkpM.js";import"./building-D7PWBF3-.js";import"./calendar-pZCS8WPy.js";import"./chart-column-CH-40Yjn.js";import"./chevron-left-BAvb6WGn.js";import"./circle-alert-DCoDy4PA.js";import"./circle-check-big-BMYVPbRH.js";import"./circle-check-B5E119oN.js";import"./circle-help-DcK-i_SQ.js";import"./circle-x-BnYRe0cI.js";import"./circle-B-lwSO-9.js";import"./coins-QSIO91L8.js";import"./columns-3-BJflJd0h.js";import"./crown-h0ONqO0b.js";import"./download-FY3rJJBK.js";import"./ellipsis-DhhTm3i6.js";import"./external-link-DZ7-d7Y_.js";import"./eye-off-CBRrilSi.js";import"./eye-BGcEqodV.js";import"./instagram-CVFp5Sx_.js";import"./file-3AWHN2l6.js";import"./grip-vertical-1PuRD1LT.js";import"./hard-drive-DkZiK8kb.js";import"./heart-CNQFES80.js";import"./house-Bz__QWIz.js";import"./info-CWa1AAnn.js";import"./key-Z3HmnV2-.js";import"./lightbulb-DQSQ9qNV.js";import"./link-2-pbuNzVBD.js";import"./link-DceUnw3z.js";import"./twitter-CZjBB1-K.js";import"./list-D1IfOmxs.js";import"./lock-BlSlbQY6.js";import"./map-pin-wCNGu7TE.js";import"./menu-BH-rpoiU.js";import"./message-circle-DFnVEf3y.js";import"./monitor-U4qpGUkK.js";import"./wifi-CvP3D_V4.js";import"./paperclip-h_SfHoPk.js";import"./pause-vB4M0M_Y.js";import"./tag-OznyPslI.js";import"./phone-CcborKQC.js";import"./pin-z3kXVgm0.js";import"./play-C9ujj4pR.js";import"./power-DtAmx68i.js";import"./quote-DqGKb1gV.js";import"./send-B0OsKa7V.js";import"./server-CK254A3D.js";import"./shield-D21jpLkF.js";import"./square-pen-BE6Ef4zh.js";import"./square-DyzuZ8y2.js";import"./star-LRbmONxX.js";import"./sticky-note-BnqKoA0i.js";import"./target-LDs0Bf_v.js";import"./timer-Cde2YpCK.js";import"./toggle-right-uccKRcAk.js";import"./trash-2-WsAE_ige.js";import"./trending-down-CxK3FgOd.js";import"./type-DfB6MBM_.js";import"./user-check-DxK1QmPp.js";import"./user-plus-cb7gLVi3.js";import"./users-ClK0ij4u.js";import"./wallet-CH1oYh2R.js";import"./zap-D5bA-otg.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";const m={entity:{endpoint:route("plan-requests.index"),permissions:{view:"view-plan-requests",create:"create-plan-requests",edit:"edit-plan-requests",delete:"delete-plan-requests"}},description:l("Manage plan upgrade requests from users"),table:{columns:[{key:"user.name",label:l("Name"),sortable:!0},{key:"user.email",label:l("Email"),sortable:!0},{key:"plan.name",label:l("Plan Name"),sortable:!0},{key:"duration",label:l("Billing Cycle"),render:t=>t==="yearly"?l("Yearly"):l("Monthly")},{key:"subtotal",label:l("Subtotal"),render:t=>t?`${parseFloat(t).toFixed(2)}`:"-"},{key:"total",label:l("Total"),render:t=>t?`${parseFloat(t).toFixed(2)}`:"-"},{key:"status",label:l("Status"),render:P.status()},{key:"created_at",label:l("Requested At"),sortable:!0,render:P.date()}],actions:[{label:l("Approve"),icon:"Check",action:"approve",className:"text-green-600",condition:t=>t.status==="pending"},{label:l("Reject"),icon:"X",action:"reject",className:"text-red-600",condition:t=>t.status==="pending"}]},search:{placeholder:l("Search plan requests...")},filters:[{key:"status",label:l("Status"),type:"select",options:[{value:"all",label:l("All Status")},{value:"pending",label:l("Pending")},{value:"approved",label:l("Approved")},{value:"rejected",label:l("Rejected")},{value:"cancelled",label:l("Cancelled")}]}]};function tr(){var S,q,w,F;const{t}=G(),{flash:n,planRequests:o,filters:d={},auth:h,isMyRequests:I=!1}=J().props,V=(h==null?void 0:h.permissions)||[],M=((S=h.user)==null?void 0:S.type)||((q=h.user)==null?void 0:q.role),[p,O]=f.useState(d.search||""),[x,N]=f.useState({}),[g,z]=f.useState(!1);f.useEffect(()=>{n!=null&&n.success&&i.success(n.success),n!=null&&n.error&&i.error(n.error)},[n]),f.useEffect(()=>{var s;const e={};(s=m.filters)==null||s.forEach(a=>{e[a.key]=d[a.key]||"all"}),N(e)},[]);const B=(e,s)=>{e==="approve"?c.post(route("plan-requests.approve",s.id),{},{onSuccess:()=>{i.success(t("Plan request approved successfully"))},onError:()=>{i.error(t("Failed to approve plan request"))}}):e==="reject"?c.post(route("plan-requests.reject",s.id),{},{onSuccess:()=>{i.success(t("Plan request rejected successfully"))},onError:()=>{i.error(t("Failed to reject plan request"))}}):e==="cancel"?c.delete(route("my-plan-requests.cancel",s.id),{onSuccess:()=>{i.success(t("Plan request cancelled successfully"))},onError:()=>{i.error(t("Failed to cancel plan request"))}}):e==="delete"&&c.delete(route("plan-requests.destroy",s.id),{onSuccess:()=>{i.success(t("Plan request deleted successfully"))},onError:()=>{i.error(t("Failed to delete plan request"))}})},D=e=>{e.preventDefault(),L()},L=()=>{const e={page:1};p&&(e.search=p),Object.entries(x).forEach(([s,a])=>{a&&a!=="all"&&(e[s]=a)}),d.per_page&&(e.per_page=d.per_page),c.get(route("plan-requests.index"),e,{preserveState:!0,preserveScroll:!0})},X=(e,s)=>{N(j=>({...j,[e]:s}));const a={page:1};p&&(a.search=p);const u={...x,[e]:s};Object.entries(u).forEach(([j,v])=>{v&&v!=="all"&&(a[j]=v)}),d.per_page&&(a.per_page=d.per_page),c.get(route("plan-requests.index"),a,{preserveState:!0,preserveScroll:!0})},H=[{title:t("Dashboard"),href:route("dashboard")},{title:t("Plans"),href:route("plans.index")},{title:t("Plan Requests")}],$=()=>Object.entries(x).some(([e,s])=>s&&s!=="")||p!=="",K=I||M!=="superadmin"?[{label:t("Cancel"),icon:"X",action:"cancel",className:"text-red-600",condition:e=>e.status==="pending"}]:[{label:t("Approve"),icon:"Check",action:"approve",className:"text-green-600",condition:e=>e.status==="pending"},{label:t("Reject"),icon:"X",action:"reject",className:"text-red-600",condition:e=>e.status==="pending"},{label:t("Delete"),icon:"Trash2",action:"delete",className:"text-red-600",condition:e=>e.status==="cancelled"}];return r.jsxs(R,{title:t("Plan Requests"),url:"/plan-requests",breadcrumbs:H,noPadding:!0,children:[r.jsx("div",{className:"bg-white rounded-lg shadow mb-4",children:r.jsxs("div",{className:"p-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("form",{onSubmit:D,className:"flex gap-2",children:[r.jsxs("div",{className:"relative w-64",children:[r.jsx(C,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),r.jsx(Q,{placeholder:t("Search plan requests..."),value:p,onChange:e=>O(e.target.value),className:"w-full pl-9"})]}),r.jsxs(y,{type:"submit",size:"sm",children:[r.jsx(C,{className:"h-4 w-4 mr-1.5"}),t("Search")]})]}),m.filters&&m.filters.length>0&&r.jsx("div",{className:"ml-2",children:r.jsxs(y,{variant:$()?"default":"outline",size:"sm",className:"h-8 px-2 py-1",onClick:()=>z(!g),children:[r.jsx(U,{className:"h-3.5 w-3.5 mr-1.5"}),t(g?"Hide Filters":"Filters")]})})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(k,{className:"text-xs text-muted-foreground",children:[t("Per Page"),":"]}),r.jsxs(E,{value:((w=d.per_page)==null?void 0:w.toString())||"10",onValueChange:e=>{const s={page:1,per_page:parseInt(e)};p&&(s.search=p),Object.entries(x).forEach(([a,u])=>{u&&u!==""&&(s[a]=u)}),c.get(route("plan-requests.index"),s,{preserveState:!0,preserveScroll:!0})},children:[r.jsx(A,{className:"w-16 h-8",children:r.jsx(T,{})}),r.jsxs(_,{children:[r.jsx(b,{value:"10",children:"10"}),r.jsx(b,{value:"25",children:"25"}),r.jsx(b,{value:"50",children:"50"}),r.jsx(b,{value:"100",children:"100"})]})]})]})]}),g&&m.filters&&m.filters.length>0&&r.jsx("div",{className:"w-full mt-3 p-4 bg-gray-50 border rounded-md",children:r.jsx("div",{className:"flex flex-wrap gap-4 items-end",children:m.filters.map(e=>{var s;return r.jsxs("div",{className:"space-y-2",children:[r.jsx(k,{children:t(e.label)}),r.jsxs(E,{value:x[e.key]||"",onValueChange:a=>X(e.key,a),children:[r.jsx(A,{className:"w-40",children:r.jsx(T,{placeholder:t("All")+" "+t(e.label)})}),r.jsx(_,{children:(s=e.options)==null?void 0:s.map(a=>r.jsx(b,{value:a.value,children:t(a.label)},a.value))})]})]},e.key)})})})]})}),r.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[r.jsx(Y,{columns:m.table.columns.map(e=>({...e,label:t(e.label)})),actions:K,data:(o==null?void 0:o.data)||[],from:(o==null?void 0:o.from)||1,onAction:B,permissions:V,entityPermissions:m.entity.permissions}),r.jsxs("div",{className:"p-4 border-t flex items-center justify-between",children:[r.jsxs("div",{className:"text-sm text-muted-foreground",children:[t("Showing")," ",r.jsx("span",{className:"font-medium",children:(o==null?void 0:o.from)||0})," ",t("to")," ",r.jsx("span",{className:"font-medium",children:(o==null?void 0:o.to)||0})," ",t("of")," ",r.jsx("span",{className:"font-medium",children:(o==null?void 0:o.total)||0})," ",t("plan requests")]}),r.jsx("div",{className:"flex gap-1",children:(F=o==null?void 0:o.links)==null?void 0:F.map((e,s)=>{const a=e.label==="&laquo; Previous"||e.label==="Next &raquo;",u=e.label.replace("&laquo; ","").replace(" &raquo;","");return r.jsx(y,{variant:e.active?"default":"outline",size:a?"sm":"icon",className:a?"px-3":"h-8 w-8",disabled:!e.url,onClick:()=>e.url&&c.get(e.url),children:a?t(u):r.jsx("span",{dangerouslySetInnerHTML:{__html:e.label}})},s)})})]})]})]})}export{tr as default};
