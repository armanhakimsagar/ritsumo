import{R as N,r as M,j as e}from"./ui-Ps9nvBG1.js";import{u as A,K as I,t as i,C as c,a as m,b as x,g as j,d as l,q as b,G as T,D as B,l as E,n as F,o as L,B as w,f as h}from"./app-BTt_gkO3.js";import{P as R,A as U,c as $,a as q}from"./page-template-BeQadk1c.js";import{f as r}from"./currency-kzm_C5pv.js";import{I as H}from"./invoice-payment-modal-Cy-ZsaFZ.js";import{S as z}from"./square-pen-BE6Ef4zh.js";import{S as G}from"./send-B0OsKa7V.js";import{C as K}from"./credit-card-BwPrmecT.js";import{L as O}from"./link-DceUnw3z.js";import{D as W}from"./dollar-sign-CY6xo33T.js";import{C as J}from"./calendar-pZCS8WPy.js";import{C as Q}from"./clock-NAV_RQL_.js";import{B as V}from"./building-D7PWBF3-.js";import{U as X}from"./user-DZ3jVi18.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./textarea-DPiv_-Qc.js";import"./select-z0EzYxFC.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";import"./invoice-payment-form-DWi7BJoK.js";import"./react-stripe.esm-BlLEi23z.js";import"./alert-CnBrcYs9.js";import"./circle-alert-DCoDy4PA.js";import"./external-link-DZ7-d7Y_.js";import"./indian-rupee-CXBAgLWO.js";function He(){var y,f;const{t:a}=A(),{invoice:s,userWorkspaceRole:u,flash:n}=I().props,[k,g]=N.useState(!1),[_,d]=N.useState(!1);M.useEffect(()=>{n!=null&&n.success&&i.success(n.success),n!=null&&n.error&&i.error(n.error)},[n]);const C=t=>({draft:"bg-gray-100 text-gray-800",sent:"bg-blue-100 text-blue-800",viewed:"bg-yellow-100 text-yellow-800",paid:"bg-green-100 text-green-800",partial_paid:"bg-orange-100 text-orange-800",overdue:"bg-red-100 text-red-800",cancelled:"bg-gray-100 text-gray-800"})[t]||"bg-gray-100 text-gray-800",o=t=>{switch(t){case"edit":h.get(route("invoices.edit",s.id));break;case"mark-paid":d(!0);break;case"send":i.loading("Sending invoice..."),h.post(route("invoices.send",s.id),{},{onSuccess:()=>{i.dismiss()},onError:()=>{i.dismiss(),i.error("Failed to send invoice")}});break;case"pay":g(!0);break;case"copy-payment-link":const v=route("invoices.payment",s.payment_token);navigator.clipboard.writeText(v).then(()=>{i.success(a("Payment link copied to clipboard"))}).catch(()=>{i.error(a("Failed to copy payment link"))});break}},S=()=>{h.reload()},D=()=>{i.loading("Marking invoice as paid..."),h.post(route("invoices.mark-paid",s.id),{},{onSuccess:()=>{i.dismiss(),d(!1)},onError:()=>{i.dismiss(),i.error("Failed to mark invoice as paid"),d(!1)}})},p=[];s.status==="draft"&&["owner","manager"].includes(u)&&p.push({label:a("Edit"),icon:e.jsx(z,{className:"h-4 w-4 mr-2"}),variant:"outline",onClick:()=>o("edit")},{label:a("Send"),icon:e.jsx(G,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:()=>o("send")}),s.status!=="paid"&&s.status!=="draft"&&s.status!=="cancelled"&&(u==="client"?p.push({label:a("Pay Now"),icon:e.jsx(K,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:()=>o("pay")}):p.push({label:a("Copy Payment Link"),icon:e.jsx(O,{className:"h-4 w-4 mr-2"}),variant:"outline",onClick:()=>o("copy-payment-link")},{label:a("Mark as Paid"),icon:e.jsx(W,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:()=>o("mark-paid")}));const P=[{title:a("Dashboard"),href:route("dashboard")},{title:a("Invoices"),href:route("invoices.index")},{title:s.invoice_number}];return e.jsx(R,{title:`${a("Invoice")} ${s.invoice_number}`,url:`/invoices/${s.id}`,actions:p,breadcrumbs:P,children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs(c,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(x,{className:"text-2xl",children:s.invoice_number}),e.jsx("p",{className:"text-muted-foreground mt-1",children:s.title})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(j,{className:C(s.status),variant:"secondary",children:s.status.toUpperCase()}),s.is_overdue&&e.jsxs("p",{className:"text-red-600 text-sm mt-1",children:[s.days_overdue," ",a("days overdue")]})]})]})}),e.jsxs(l,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:a("Invoice Details")}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[a("Date"),":"]})," ",new Date(s.invoice_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[a("Due"),":"]})," ",new Date(s.due_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[a("Project"),":"]})," ",s.project.title]})]})]})]})}),s.client&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:a("Bill To")}),e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(U,{className:"h-8 w-8",children:[e.jsx($,{src:s.client.avatar}),e.jsx(q,{children:(y=s.client.name)==null?void 0:y.charAt(0)})]}),e.jsx("span",{className:"font-medium",children:s.client.name})]})})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide",children:a("Amount")}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-2xl font-bold",children:r(s.total_amount)}),s.paid_amount>0&&e.jsxs("div",{className:"text-sm text-gray-600",children:[a("Paid"),": ",r(s.paid_amount),s.payment_method&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["via ",s.payment_method.charAt(0).toUpperCase()+s.payment_method.slice(1),s.payment_reference&&e.jsxs("span",{className:"ml-1",children:["(",s.payment_reference,")"]})]})]}),s.total_amount-s.paid_amount>0&&e.jsxs("div",{className:"text-sm font-medium text-red-600",children:[a("Due Amount"),": ",r(s.total_amount-s.paid_amount)]})]})]})})]}),s.description&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h2",{className:"font-semibold text-sm text-gray-600 uppercase tracking-wide mb-2",children:a("Description")}),e.jsx("p",{className:"text-gray-700",children:s.description})]})]})]}),e.jsxs(c,{children:[e.jsx(m,{children:e.jsx(x,{children:a("Invoice Items")})}),e.jsxs(l,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 font-medium text-gray-600",children:a("Description")}),e.jsx("th",{className:"text-right py-2 font-medium text-gray-600",children:a("Rate")}),e.jsx("th",{className:"text-right py-2 font-medium text-gray-600",children:a("Amount")})]})}),e.jsx("tbody",{children:s.items.map(t=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.description}),t.task&&e.jsxs("div",{className:"text-sm text-gray-500",children:[a("Task"),": ",t.task.title]}),t.expense&&e.jsxs("div",{className:"text-sm text-gray-500",children:[a("Expense"),": ",t.expense.title]}),e.jsx(j,{variant:"outline",className:"text-xs mt-1",children:t.type})]})}),e.jsx("td",{className:"text-right py-3",children:r(t.rate)}),e.jsx("td",{className:"text-right py-3 font-medium",children:r(t.amount)})]},t.id))})]})}),e.jsx(b,{className:"my-4"}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"w-64 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a("Subtotal"),":"]}),e.jsx("span",{children:r(s.subtotal)})]}),s.discount_amount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsxs("span",{children:[a("Discount"),":"]}),e.jsxs("span",{children:["-",r(s.discount_amount)]})]}),s.tax_rate>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a("Tax")," (",s.tax_rate,"%):"]}),e.jsx("span",{children:r(s.tax_amount)})]}),e.jsx(b,{}),e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsxs("span",{children:[a("Total"),":"]}),e.jsx("span",{children:r(s.total_amount)})]}),s.paid_amount>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsxs("span",{children:[a("Paid"),":"]}),e.jsx("span",{children:r(s.paid_amount)})]}),e.jsxs("div",{className:"flex justify-between font-bold text-red-600",children:[e.jsxs("span",{children:[a("Balance Due"),":"]}),e.jsx("span",{children:r(s.total_amount-s.paid_amount)})]})]})]})})]})]}),(s.notes||s.terms)&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.notes&&e.jsxs(c,{children:[e.jsx(m,{children:e.jsx(x,{className:"text-lg",children:a("Notes")})}),e.jsx(l,{children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:s.notes})})]}),s.terms&&e.jsxs(c,{children:[e.jsx(m,{children:e.jsx(x,{className:"text-lg",children:a("Terms & Conditions")})}),e.jsx(l,{children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:s.terms})})]})]}),s.payment_method&&e.jsxs(c,{children:[e.jsx(m,{children:e.jsx(x,{className:"text-lg",children:a("Payment Information")})}),e.jsx(l,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-medium text-sm text-gray-600 uppercase tracking-wide mb-2",children:a("Payment Method")}),e.jsx("p",{className:"capitalize",children:s.payment_method})]}),s.payment_reference&&e.jsxs("div",{children:[e.jsx("h2",{className:"font-medium text-sm text-gray-600 uppercase tracking-wide mb-2",children:a("Reference")}),e.jsx("p",{className:"font-mono text-sm",children:s.payment_reference})]}),((f=s.payment_details)==null?void 0:f.status)&&e.jsxs("div",{children:[e.jsx("h2",{className:"font-medium text-sm text-gray-600 uppercase tracking-wide mb-2",children:a("Status")}),e.jsx(j,{variant:s.payment_details.status==="completed"?"default":"secondary",children:s.payment_details.status})]})]})})]}),e.jsx(c,{children:e.jsx(l,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsxs("span",{children:[a("Created by")," ",s.creator.name]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsxs("span",{children:[a("Created on")," ",new Date(s.created_at).toLocaleDateString()]})]})]})})}),e.jsx(H,{invoice:s,open:k,onClose:()=>g(!1),onSuccess:S}),e.jsx(B,{open:_,onOpenChange:d,children:e.jsxs(E,{children:[e.jsx(F,{children:e.jsx(L,{children:a("Mark Invoice as Paid")})}),e.jsxs("p",{children:[a("Are you sure you want to mark invoice")," ",s.invoice_number," ",a("as paid"),"?"]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(w,{variant:"outline",onClick:()=>d(!1),children:a("Cancel")}),e.jsx(w,{onClick:D,children:a("Mark as Paid")})]})]})})]})})}export{He as default};
