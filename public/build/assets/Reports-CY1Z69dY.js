import{r as N,j as e}from"./ui-Ps9nvBG1.js";import{u as M,K as V,L as K,C as n,a as R,b as k,d,e as h,I as D,B as f,g as o,G as U}from"./app-BTt_gkO3.js";import{S as P,a as A,b as L,c as B,d as j}from"./select-z0EzYxFC.js";import{P as $}from"./page-template-BeQadk1c.js";import{f as b}from"./currency-kzm_C5pv.js";import{C as v}from"./chart-column-CH-40Yjn.js";import{R as q}from"./language-switcher-AzCP_3T2.js";import{C as X}from"./clock-NAV_RQL_.js";import{D as E}from"./dollar-sign-CY6xo33T.js";import{A as z}from"./activity-BmMDIvmq.js";import{U as Q}from"./users-ClK0ij4u.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";import"./textarea-DPiv_-Qc.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./credit-card-BwPrmecT.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./globe-BYIVGjA8.js";import"./settings-CG31wyPI.js";import"./dropdown-menu-CvJwe1WI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";import"./switch-DG4amuEJ.js";function Ae({members:H,projects:O,defaultFilters:p,defaultReportData:y,permissions:W}){var C,S,T,F;const{t}=M(),{auth:g}=V().props;g!=null&&g.permissions;const[c,m]=N.useState(p),[a,w]=N.useState(y),[x,_]=N.useState(!1),G=async()=>{var s;_(!0);try{const r=await(await fetch(route("timesheet-reports.generate"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify(c)})).json();w(r)}catch(l){console.error("Failed to generate report:",l)}finally{_(!1)}},I=[{title:t("Dashboard"),href:route("dashboard")},{title:t("Timesheets"),href:route("timesheets.index")},{title:t("Reports")}];return e.jsxs($,{title:t("Timesheet Reports"),breadcrumbs:I,action:e.jsxs(f,{variant:"outline",onClick:()=>window.location.href=route("customer-reports.index"),className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Customer Report"]}),children:[e.jsx(K,{title:t("Timesheet Reports")}),e.jsxs(n,{className:"mb-6",children:[e.jsx(R,{children:e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5"}),t("Report Filters")]})}),e.jsxs(d,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:t("Project")}),e.jsxs(P,{value:c.project_id,onValueChange:s=>m(l=>({...l,project_id:s})),children:[e.jsx(A,{children:e.jsx(L,{})}),e.jsxs(B,{children:[e.jsx(j,{value:"all",children:t("All Projects")}),O.map(s=>e.jsx(j,{value:s.id.toString(),children:s.title},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:t("Member")}),e.jsxs(P,{value:c.user_id,onValueChange:s=>m(l=>({...l,user_id:s})),children:[e.jsx(A,{children:e.jsx(L,{})}),e.jsxs(B,{children:[e.jsx(j,{value:"all",children:t("All Members")}),H.map(s=>e.jsx(j,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:t("Start Date")}),e.jsx(D,{type:"date",value:c.start_date,onChange:s=>m(l=>({...l,start_date:s.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:t("End Date")}),e.jsx(D,{type:"date",value:c.end_date,onChange:s=>m(l=>({...l,end_date:s.target.value}))})]})]}),e.jsxs("div",{className:"mt-4 flex items-center space-x-2",children:[e.jsx(f,{onClick:G,disabled:x||!c.start_date||!c.end_date,className:"flex-1 md:flex-none",children:t(x?"Generating...":"Generate Report")}),e.jsx(f,{variant:"outline",onClick:()=>{m(p),w(y)},disabled:x,title:"Reset to latest reports",children:e.jsx(q,{className:"h-4 w-4"})})]})]})]}),a&&e.jsxs(n,{children:[e.jsx(R,{children:e.jsxs("div",{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[t("Report Results"),x&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})]}),JSON.stringify(c)===JSON.stringify(p)&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:t("Showing latest reports (Last 30 days)")})]})}),e.jsxs(d,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:t("Summary")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(n,{className:"bg-gradient-to-r from-blue-50 to-blue-100 border-blue-200",children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:e.jsx(X,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:t("Total Hours")}),e.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:[parseFloat(((C=a.summary)==null?void 0:C.total_hours)||0).toFixed(1),"h"]})]})]})})}),e.jsx(n,{className:"bg-gradient-to-r from-green-50 to-green-100 border-green-200",children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500 rounded-lg",children:e.jsx(E,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:t("Billable Hours")}),e.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[parseFloat(((S=a.summary)==null?void 0:S.billable_hours)||0).toFixed(1),"h"]})]})]})})}),e.jsx(n,{className:"bg-gradient-to-r from-purple-50 to-purple-100 border-purple-200",children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500 rounded-lg",children:e.jsx(E,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-600",children:t("Total Amount")}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:b(((T=a.summary)==null?void 0:T.total_amount)||0)})]})]})})}),e.jsx(n,{className:"bg-gradient-to-r from-orange-50 to-orange-100 border-orange-200",children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-500 rounded-lg",children:e.jsx(z,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:t("Entries")}),e.jsx("p",{className:"text-2xl font-bold text-orange-900",children:((F=a.summary)==null?void 0:F.entries_count)||0})]})]})})})]})]}),a.projects&&a.projects.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["Projects (",a.projects.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.projects.map((s,l)=>e.jsx(n,{className:"hover:shadow-md transition-shadow",children:e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(v,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"font-semibold text-gray-900",children:s.project_name}),e.jsx(o,{variant:s.status==="completed"?"default":"secondary",className:"text-xs",children:s.status})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[s.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${s.progress}%`}})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Tasks"}),e.jsxs("span",{children:[s.tasks_completed,"/",s.tasks_total]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all",style:{width:`${s.task_progress}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Hours:"}),e.jsxs(o,{variant:"secondary",children:[parseFloat(s.total_hours).toFixed(1),"h"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Billable Hours:"}),e.jsxs(o,{variant:"default",className:"bg-green-100 text-green-800",children:[parseFloat(s.billable_hours).toFixed(1),"h"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Amount:"}),e.jsx("span",{className:"font-semibold text-gray-900",children:b(s.total_amount)})]})]})]})},l))})]}),a.members&&a.members.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["Team Members (",a.members.length,")"]}),e.jsx("div",{className:"space-y-6",children:a.members.map((s,l)=>e.jsx(n,{className:"hover:shadow-md transition-shadow",children:e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-gray-900",children:s.member_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[parseFloat(s.total_hours).toFixed(1),"h total •",b(s.total_amount)," earned"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"font-medium text-gray-900",children:"Projects & Tasks"}),s.projects.map((r,J)=>e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h2",{className:"font-medium text-gray-900",children:r.project_name}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium",children:[parseFloat(r.hours).toFixed(1),"h"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[parseFloat(r.billable_hours).toFixed(1),"h billable"]})]})]}),r.tasks.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h2",{className:"text-sm font-medium text-gray-700 mb-2",children:["Tasks (",r.tasks.length,")"]}),e.jsxs("div",{className:"space-y-1",children:[r.tasks.slice(0,3).map((i,u)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:i.title}),e.jsx(o,{variant:i.status==="Done"?"default":"secondary",className:"text-xs",children:i.status})]},u)),r.tasks.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",r.tasks.length-3," more tasks"]})]})]}),r.entries.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recent Entries"}),e.jsxs("div",{className:"space-y-1",children:[r.entries.slice(0,3).map((i,u)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:new Date(i.date).toLocaleDateString()}),i.description&&e.jsxs("span",{className:"text-gray-500 ml-2",children:["• ",i.description.substring(0,30),"..."]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:[parseFloat(i.hours).toFixed(1),"h"]}),i.is_billable&&e.jsx(o,{variant:"outline",className:"text-xs",children:"Billable"})]})]},u)),r.entries.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",r.entries.length-3," more entries"]})]})]})]},J))]})]})},l))})]})]})]}),!a&&e.jsx(n,{children:e.jsxs(d,{className:"p-8 text-center",children:[e.jsx(v,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No timesheet data found for the selected criteria"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Try adjusting your date range or filters"})]})})]})}export{Ae as default};
