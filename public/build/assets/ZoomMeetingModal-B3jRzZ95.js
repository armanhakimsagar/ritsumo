import{r as h,j as e}from"./ui-Ps9nvBG1.js";import{D as T,l as z,n as P,o as Z,e as n,I as u,g as q,X as I,H as k,B as S,f as w}from"./app-BTt_gkO3.js";import{T as O}from"./textarea-DPiv_-Qc.js";import{S as N,a as D,b as y,c as C,d as b}from"./select-z0EzYxFC.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";function Q({isOpen:j,onClose:p,meeting:i,projects:F,members:B}){const[s,x]=h.useState({title:"",description:"",start_time:"",duration:60,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,project_id:"",password:"",member_ids:[]}),[f,d]=h.useState([]),[c,m]=h.useState({}),[g,l]=h.useState(!1);h.useEffect(()=>{var t,r;j&&(i?(x({title:i.title||"",description:i.description||"",start_time:i.start_time?new Date(i.start_time).toISOString().slice(0,16):"",duration:i.duration||60,timezone:i.timezone||Intl.DateTimeFormat().resolvedOptions().timeZone,project_id:((t=i.project_id)==null?void 0:t.toString())||"none",password:i.password||"",member_ids:((r=i.members)==null?void 0:r.map(a=>a.id.toString()))||[]}),i.project_id&&_(i.project_id.toString())):(x({title:"",description:"",start_time:"",duration:60,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,project_id:"none",password:"",member_ids:[]}),d([])),m({}),l(!1))},[j,i]);const _=async t=>{if(!t||t==="none"){d([]);return}try{const r=await fetch(route("api.projects.members",t));if(r.ok){const a=await r.json();d(a||[])}else console.error("Failed to load project members:",r.status),d([])}catch(r){console.error("Failed to load project members:",r),d([])}},E=t=>{const r=t==="none"?"":t;o("project_id",r),o("member_ids",[]),_(r)},o=(t,r)=>{x(a=>({...a,[t]:r})),c[t]&&m(a=>{const v={...a};return delete v[t],v})},M=t=>{if(t.preventDefault(),g)return;const r={};if(s.title||(r.title="Title is required"),s.start_time||(r.start_time="Start time is required"),Object.keys(r).length>0){m(r);return}l(!0),i?w.put(route("zoom-meetings.update",i.id),s,{onSuccess:()=>{l(!1),p()},onError:a=>{l(!1),m(a)}}):w.post(route("zoom-meetings.store"),s,{onSuccess:()=>{l(!1),p()},onError:a=>{l(!1),m(a)}})};return e.jsx(T,{open:j,onOpenChange:p,children:e.jsxs(z,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(P,{children:e.jsx(Z,{children:i?"Edit Zoom Meeting":"Create Zoom Meeting"})}),e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"title",children:"Meeting Title *"}),e.jsx(u,{id:"title",value:s.title,onChange:t=>o("title",t.target.value),placeholder:"Enter meeting title",required:!0}),c.title&&e.jsx("p",{className:"text-sm text-red-600",children:c.title})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(O,{id:"description",value:s.description,onChange:t=>o("description",t.target.value),placeholder:"Meeting agenda or description",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"start_time",children:"Start Date & Time *"}),e.jsx(u,{id:"start_time",type:"datetime-local",value:s.start_time,onChange:t=>o("start_time",t.target.value),required:!0}),c.start_time&&e.jsx("p",{className:"text-sm text-red-600",children:c.start_time})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"duration",children:"Duration (minutes) *"}),e.jsx(u,{id:"duration",type:"number",min:"15",max:"480",value:s.duration,onChange:t=>o("duration",parseInt(t.target.value)||60),placeholder:"Enter duration in minutes",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"project_id",children:"Project"}),e.jsxs(N,{value:s.project_id||"none",onValueChange:E,children:[e.jsx(D,{className:"bg-white",children:e.jsx(y,{placeholder:"Select project (optional)"})}),e.jsxs(C,{className:"bg-white border shadow-lg z-[9999]",children:[e.jsx(b,{value:"none",className:"bg-white hover:bg-gray-100",children:"No project"}),F.map(t=>e.jsx(b,{value:t.id.toString(),className:"bg-white hover:bg-gray-100",children:t.title},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"password",children:"Password"}),e.jsx(u,{id:"password",type:"password",value:s.password,onChange:t=>o("password",t.target.value),placeholder:"Enter meeting password (optional)"})]})]}),s.project_id&&s.project_id!=="none"&&e.jsxs("div",{children:[e.jsx(n,{htmlFor:"member_ids",children:"Members"}),e.jsxs(N,{value:"",onValueChange:t=>{t&&!s.member_ids.includes(t)&&o("member_ids",[...s.member_ids,t])},children:[e.jsx(D,{className:"bg-white",children:e.jsx(y,{placeholder:"Select members..."})}),e.jsx(C,{className:"bg-white border shadow-lg z-[9999]",children:f.map(t=>e.jsxs(b,{value:t.id.toString(),className:"bg-white hover:bg-gray-100",disabled:s.member_ids.includes(t.id.toString()),children:[t.name," (",t.email,") - ",t.role]},t.id))})]}),s.member_ids.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:s.member_ids.map(t=>{const r=f.find(a=>a.id.toString()===t);return r?e.jsxs(q,{variant:"secondary",className:"flex items-center space-x-1",children:[e.jsx("span",{children:r.name}),e.jsx("button",{type:"button",onClick:()=>{o("member_ids",s.member_ids.filter(a=>a!==t))},className:"ml-1 hover:text-red-600",children:e.jsx(I,{className:"h-3 w-3"})})]},t):null})})]}),e.jsxs(k,{children:[e.jsx(S,{type:"button",variant:"outline",onClick:p,children:"Cancel"}),e.jsx(S,{type:"submit",disabled:g,children:g?"Saving...":i?"Update Meeting":"Create Meeting"})]})]})]})})}export{Q as default};
