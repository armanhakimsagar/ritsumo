import{r as d,j as e}from"./ui-Ps9nvBG1.js";import{S as ee,I as ne,B as i,e as U,f as n,g as M,u as Ce,K as ke,t as j,h as W,L as _e,C as v,a as se,b as te,d as _,P as le}from"./app-BTt_gkO3.js";import{P as De,f as Te}from"./page-template-BeQadk1c.js";import{T as ce}from"./TimeEntryForm-Bcc_Wmjo.js";import{C as ae}from"./checkbox-ux8-2I9a.js";import{S as K,a as G,b as J,c as Q,d as N}from"./select-z0EzYxFC.js";import{C as re}from"./CrudDeleteModal-CAwcbZOF.js";import{f as Be}from"./timesheetUtils-B5XLnIH8.js";import{P as Fe}from"./progress-B213Sqsa.js";import{F as Ee}from"./filter-C99mLYzj.js";import{C as ie}from"./circle-check-big-BMYVPbRH.js";import{C as L}from"./clock-NAV_RQL_.js";import{C as de}from"./calendar-pZCS8WPy.js";import{S as Pe}from"./square-pen-BE6Ef4zh.js";import{T as Ae}from"./trash-2-WsAE_ige.js";import{C as He}from"./chevron-left-BAvb6WGn.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./textarea-DPiv_-Qc.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./chevron-up-CaRG6751.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";import"./index-C9qibMqK.js";function Oe({entries:u,timesheetId:D,projects:H,onRefresh:o,filters:c={}}){var Z,R;const[x,y]=d.useState([]),[h,w]=d.useState(null),[T,g]=d.useState(!1),[B,F]=d.useState(!1),[b,S]=d.useState(null),[I,E]=d.useState(!1),[r,P]=d.useState(c.search||""),[p,A]=d.useState(c.project||"all"),[m,O]=d.useState(c.billable||"all"),[C,z]=d.useState(!1),l=Array.isArray(u)?u:u.data||[],a=Array.isArray(u)?null:u,V=s=>{s.preventDefault(),oe()},oe=()=>{const s={page:1};r&&(s.search=r),p!=="all"&&(s.project=p),m!=="all"&&(s.billable=m),c.per_page&&(s.per_page=c.per_page),n.get(window.location.pathname,s,{preserveState:!0,preserveScroll:!1})},me=s=>{A(s);const t={page:1};r&&(t.search=r),s!=="all"&&(t.project=s),m!=="all"&&(t.billable=m),c.per_page&&(t.per_page=c.per_page),n.get(window.location.pathname,t,{preserveState:!0,preserveScroll:!1})},xe=s=>{O(s);const t={page:1};r&&(t.search=r),p!=="all"&&(t.project=p),s!=="all"&&(t.billable=s),c.per_page&&(t.per_page=c.per_page),n.get(window.location.pathname,t,{preserveState:!0,preserveScroll:!1})},q=()=>p!=="all"||m!=="all"||r!=="",he=()=>(p!=="all"?1:0)+(m!=="all"?1:0)+(r?1:0),pe=()=>{A("all"),O("all"),P(""),z(!1),n.get(window.location.pathname,{page:1,per_page:c.per_page},{preserveState:!0,preserveScroll:!1})},ue=s=>{var f;const t={id:s.id,timesheet_id:D,project_id:s.project.id,task_id:(f=s.task)==null?void 0:f.id,date:s.date,start_time:s.start_time,end_time:s.end_time,hours:s.hours,description:s.description,is_billable:s.is_billable};w(t),g(!0)},ge=s=>{S(s),F(!0)},je=()=>{b&&n.delete(route("timesheet-entries.destroy",{timesheet_entry:b.id}),{onSuccess:()=>{o==null||o(),F(!1),S(null)},onError:s=>{console.error("Delete failed:",s),alert("Failed to delete entry. Please try again.")}})},be=()=>{x.length!==0&&E(!0)},fe=()=>{n.delete(route("timesheet-entries.bulk-delete"),{data:{entry_ids:x},onSuccess:()=>{y([]),o==null||o(),E(!1)},onError:s=>{console.error("Bulk delete failed:",s),alert("Failed to delete entries. Please try again.")}})},X=s=>{x.length!==0&&n.post(route("timesheet-entries.bulk-update"),{entry_ids:x,is_billable:s},{onSuccess:()=>{y([]),o==null||o()},onError:t=>{console.error("Bulk update failed:",t),alert("Failed to update entries. Please try again.")}})},Ne=s=>{y(t=>t.includes(s)?t.filter(f=>f!==s):[...t,s])},ve=()=>{x.length===l.length?y([]):y(l.map(s=>s.id))},ye=()=>l.reduce((s,t)=>s+(Number(t.hours)||0),0),we=()=>l.filter(s=>s.is_billable).reduce((s,t)=>s+(Number(t.hours)||0),0),$=ye(),Y=we(),k=Be($,Y);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("form",{onSubmit:V,className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-64",children:[e.jsx(ee,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:"Search entries...",value:r,onChange:s=>P(s.target.value),className:"w-full pl-9"})]}),e.jsxs(i,{type:"submit",size:"sm",children:[e.jsx(ee,{className:"h-4 w-4 mr-1.5"}),"Search"]})]}),e.jsx("div",{className:"ml-2",children:e.jsxs(i,{variant:q()?"default":"outline",size:"sm",className:"h-8 px-2 py-1",onClick:()=>z(!C),children:[e.jsx(Ee,{className:"h-3.5 w-3.5 mr-1.5"}),C?"Hide Filters":"Filters",q()&&e.jsx("span",{className:"ml-1 bg-primary-foreground text-primary rounded-full w-5 h-5 flex items-center justify-center text-xs",children:he()})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"text-xs text-muted-foreground",children:"Per Page:"}),e.jsxs(K,{value:((Z=c.per_page)==null?void 0:Z.toString())||"10",onValueChange:s=>{const t={page:1,per_page:parseInt(s)};r&&(t.search=r),p!=="all"&&(t.project=p),m!=="all"&&(t.billable=m),n.get(window.location.pathname,t,{preserveState:!0,preserveScroll:!1})},children:[e.jsx(G,{className:"w-16 h-8",children:e.jsx(J,{})}),e.jsxs(Q,{children:[e.jsx(N,{value:"10",children:"10"}),e.jsx(N,{value:"25",children:"25"}),e.jsx(N,{value:"50",children:"50"})]})]})]})]}),C&&e.jsx("div",{className:"w-full mt-3 p-4 bg-gray-50 border rounded-md",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"Project"}),e.jsxs(K,{value:p,onValueChange:me,children:[e.jsx(G,{className:"w-40",children:e.jsx(J,{placeholder:"All Projects"})}),e.jsxs(Q,{children:[e.jsx(N,{value:"all",children:"All Projects"}),H.map(s=>e.jsx(N,{value:s.id.toString(),children:s.title},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"Billable"}),e.jsxs(K,{value:m,onValueChange:xe,children:[e.jsx(G,{className:"w-40",children:e.jsx(J,{placeholder:"All Types"})}),e.jsxs(Q,{children:[e.jsx(N,{value:"all",children:"All Types"}),e.jsx(N,{value:"true",children:"Billable"}),e.jsx(N,{value:"false",children:"Non-billable"})]})]})]}),e.jsx(i,{variant:"outline",size:"sm",className:"h-9",onClick:pe,disabled:!q(),children:"Reset Filters"})]})})]})}),l.length>0&&e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-xl p-6 mb-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-6 bg-blue-500 rounded-full"}),"Time Summary"]}),k.match&&$>0&&e.jsxs(M,{className:"bg-green-100 text-green-800 border-green-300 px-3 py-1",variant:"outline",children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"All Hours Billable"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Hours"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.total})]}),k.match&&e.jsx(ie,{className:"h-5 w-5 text-green-500 ml-auto",title:"Hours match"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(de,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Billable Hours"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:k.billable})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Billable Rate"}),e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[k.percentage,"%"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Fe,{value:k.percentage,className:"w-full h-4 bg-gray-200"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-xs font-medium text-white drop-shadow",children:[Y,"h / ",$,"h"]})})]})]})]})}),x.length>0&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg",children:[e.jsxs("span",{className:"text-sm font-medium",children:[x.length," selected"]}),e.jsx(i,{size:"sm",onClick:()=>X(!0),children:"Mark Billable"}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>X(!1),children:"Mark Non-Billable"}),e.jsx(i,{size:"sm",variant:"destructive",onClick:be,children:"Delete Selected"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx(ae,{checked:x.length===l.length&&l.length>0,onCheckedChange:ve})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Project"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Task"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hours"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Billable"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(s=>{var t;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(ae,{checked:x.includes(s.id),onCheckedChange:()=>Ne(s.id)})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:new Date(s.date).toLocaleDateString()}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.project.title}),s.description&&e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:s.description})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:((t=s.task)==null?void 0:t.title)||"-"}),e.jsxs("td",{className:"px-4 py-3 text-sm font-medium text-blue-600",children:[s.hours,"h"]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(M,{variant:s.is_billable?"default":"secondary",className:s.is_billable?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:s.is_billable?"ðŸ’° Billable":"Non-billable"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>ue(s),className:"h-8 w-8 text-amber-500 hover:text-amber-700",title:"Edit",children:e.jsx(Pe,{className:"h-4 w-4"})}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>ge(s),className:"h-8 w-8 text-red-500 hover:text-red-700",title:"Delete",children:e.jsx(Ae,{className:"h-4 w-4"})})]})})]},s.id)})})]})})}),l.length===0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx(L,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No time entries found"})]}),(a==null?void 0:a.links)&&e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.from)||0})," to ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.to)||0})," of ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.total)||0})," entries"]}),e.jsx("div",{className:"flex gap-1",children:(R=a==null?void 0:a.links)==null?void 0:R.map((s,t)=>{const f=s.label==="&laquo; Previous"||s.label==="Next &raquo;",Se=s.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(i,{variant:s.active?"default":"outline",size:f?"sm":"icon",className:f?"px-3":"h-8 w-8",disabled:!s.url,onClick:()=>s.url&&n.get(s.url),children:f?Se:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},t)})})]}),e.jsx(ce,{isOpen:T,onClose:()=>{g(!1),w(null)},timeEntry:h||void 0,timesheetId:D,projects:H}),e.jsx(re,{isOpen:B,onClose:()=>{F(!1),S(null)},onConfirm:je,itemName:b?`${b.hours}h entry for ${b.project.title}`:"",entityName:"time entry"}),e.jsx(re,{isOpen:I,onClose:()=>E(!1),onConfirm:fe,itemName:`${x.length} time entries`,entityName:"time entries"})]})}function Cs({entries:u,projects:D,selectedDate:H,timesheetId:o,filters:c={},permissions:x}){const{t:y}=Ce(),{flash:h,auth:w}=ke().props,T=(w==null?void 0:w.permissions)||[],[g,B]=d.useState(new Date(H)),[F,b]=d.useState(!1);d.useEffect(()=>{h!=null&&h.success&&j.success(h.success),h!=null&&h.error&&j.error(h.error)},[h]);const S=l=>{const a=new Date(g);a.setDate(a.getDate()+(l==="next"?1:-1)),B(a);const V=a.toISOString().split("T")[0];n.get(route("timesheets.daily-view"),{date:V},{preserveState:!0})},I=()=>{const l=new Date;B(l);const a=l.toISOString().split("T")[0];n.get(route("timesheets.daily-view"),{date:a},{preserveState:!0})},E=l=>{const a=new Date(l.target.value);B(a),n.get(route("timesheets.daily-view"),{date:l.target.value},{preserveState:!0})},r=Array.isArray(u)?u:u.data||[],P=()=>r.reduce((l,a)=>l+(Number(a.hours)||0),0),p=()=>r.filter(l=>l.is_billable).reduce((l,a)=>l+(Number(a.hours)||0),0),A=l=>l.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),m=g.toDateString()===new Date().toDateString(),O=g.getDay()===0||g.getDay()===6,C=[];W(T,"timesheet_update")&&r.length>0&&C.push({label:"Mark Billable",variant:"outline",onClick:()=>{j.loading("Marking entries as billable..."),n.post(route("timesheet-entries.bulk-update"),{entry_ids:r.map(l=>l.id),is_billable:!0},{onSuccess:()=>{j.dismiss()},onError:()=>{j.dismiss(),j.error("Failed to update entries")}})}},{label:"Mark Non-Billable",variant:"outline",onClick:()=>{j.loading("Marking entries as non-billable..."),n.post(route("timesheet-entries.bulk-update"),{entry_ids:r.map(l=>l.id),is_billable:!1},{onSuccess:()=>{j.dismiss()},onError:()=>{j.dismiss(),j.error("Failed to update entries")}})}});const z=[{title:"Dashboard",href:route("dashboard")},{title:"Timesheets",href:route("timesheets.index")},{title:"Daily View"}];return e.jsxs(De,{title:"Daily Time Tracking",actions:C,breadcrumbs:z,children:[e.jsx(_e,{title:`Daily View - ${A(g)}`}),e.jsx(v,{className:"mb-6",children:e.jsx(se,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(i,{variant:"outline",size:"icon",onClick:()=>S("prev"),children:e.jsx(He,{className:"h-4 w-4"})}),e.jsx("div",{className:"text-center",children:e.jsxs(te,{className:"text-xl",children:[A(g),m&&e.jsx(M,{className:"ml-2",children:"Today"}),O&&e.jsx(M,{variant:"secondary",className:"ml-2",children:"Weekend"})]})}),e.jsx(i,{variant:"outline",size:"icon",onClick:()=>S("next"),children:e.jsx(Te,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{type:"date",value:g.toISOString().split("T")[0],onChange:E,className:"w-auto"}),!m&&e.jsx(i,{variant:"outline",onClick:I,children:"Today"})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(v,{children:e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Total Hours"})]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:[(P()||0).toFixed(2),"h"]})]})}),e.jsx(v,{children:e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:"Billable Hours"})]}),e.jsxs("div",{className:"text-2xl font-bold text-green-900",children:[(p()||0).toFixed(2),"h"]})]})}),e.jsx(v,{children:e.jsxs(_,{className:"p-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-sm font-medium text-purple-600",children:"Entries"})}),e.jsx("div",{className:"text-2xl font-bold text-purple-900",children:r.length})]})}),e.jsx(v,{children:e.jsxs(_,{className:"p-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-sm font-medium text-orange-600",children:"Utilization"})}),e.jsxs("div",{className:"text-2xl font-bold text-orange-900",children:[((P()||0)/8*100).toFixed(0),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Based on 8h day"})]})})]}),e.jsxs(v,{children:[e.jsx(se,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(te,{children:"Time Entries"}),W(T,"timesheet_create")&&e.jsxs(i,{onClick:()=>b(!0),children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Add Entry"]})]})}),e.jsx(_,{children:e.jsx(Oe,{entries:u,timesheetId:o,projects:D,filters:c,onRefresh:()=>window.location.reload()})})]}),r.length===0&&e.jsx(v,{className:"mt-6",children:e.jsxs(_,{className:"p-8 text-center",children:[e.jsx(L,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No time entries for this day"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Start tracking your time by adding your first entry"}),W(T,"timesheet_create")&&e.jsxs(i,{onClick:()=>b(!0),children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Add Time Entry"]})]})}),e.jsx(ce,{isOpen:F,onClose:()=>b(!1),timesheetId:o,projects:D})]})}export{Cs as default};
