import{r as l,j as a}from"./ui-Ps9nvBG1.js";import{P as K}from"./page-template-BeQadk1c.js";import{u as I,K as B,t as n,B as m,w as L,f as g,C as $,I as D,D as J,l as U,n as W,o as _,H as z}from"./app-BTt_gkO3.js";import{S as G}from"./scroll-area-B8km6OEG.js";import{R as T}from"./react-country-flag.esm-2v5ikZ5v.js";import{a as Q,R as V}from"./language-switcher-AzCP_3T2.js";import{L as Y}from"./lock-BlSlbQY6.js";import{P as Z}from"./power-DtAmx68i.js";import{T as ee}from"./trash-2-WsAE_ige.js";import"./vendor-B1hewrmX.js";import"./textarea-DPiv_-Qc.js";import"./select-z0EzYxFC.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./clock-NAV_RQL_.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./globe-BYIVGjA8.js";import"./settings-CG31wyPI.js";import"./dropdown-menu-CvJwe1WI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./switch-DG4amuEJ.js";function Me(){var N;const{t}=I(),{languages:C,defaultLang:d,defaultData:f,availableLanguages:i}=B().props,[o,k]=l.useState(d),[w,u]=l.useState(f),[E,x]=l.useState(!1),[y,h]=l.useState(!1),[j,R]=l.useState(""),[F,A]=l.useState(!1),[O,p]=l.useState(!1),[v,b]=l.useState(!1);l.useEffect(()=>{k(d)},[d]),l.useEffect(()=>{if(o===d&&Object.keys(f).length>0){u(f);return}x(!0),fetch(`${route("language.load")}?lang=${o}`).then(e=>e.json()).then(e=>{e.data?u(e.data):u({}),x(!1)}).catch(()=>{u({}),x(!1),n.error(t("Failed to load language file"))})},[o,d,f,t]);const P=(e,r)=>{u(s=>({...s,[e]:r}))},M=e=>{var r;return e&&e.preventDefault(),h(!0),fetch(route("language.save"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||"",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({_method:"PATCH",lang:o,data:w})}).then(s=>s.status===403?s.json().then(X=>{n.error(X.message),h(!1)}):s.json()).then(s=>{s&&(s.success?n.success(s.success||t("Language updated successfully")):s.error?n.error(s.error):n.success(t("Language updated successfully")),h(!1))}).catch(s=>{console.error("Save error:",s),n.error(t("Failed to update language file")),h(!1)}),!1},q=async()=>{var e;try{const r=await fetch(route("languages.delete",o),{method:"DELETE",headers:{"X-CSRF-TOKEN":((e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.getAttribute("content"))||"",Accept:"application/json"}}),s=await r.json();if(r.status===403){n.error(s.message);return}r.ok?(n.success(t("Language deleted successfully")),p(!1),g.get(route("manage-language",{lang:"en"}))):n.error(s.message||s.error||t("Failed to delete language"))}catch{n.error(t("Failed to delete language"))}},H=async()=>{var e;b(!0);try{const r=await fetch(route("languages.toggle",o),{method:"PATCH",headers:{"X-CSRF-TOKEN":((e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.getAttribute("content"))||"",Accept:"application/json"}}),s=await r.json();if(r.status===403){n.error(s.message);return}r.ok?(n.success(t("Language status updated successfully")),!S||o!=="en"?g.get(route("manage-language",{lang:"en"})):g.get(route("manage-language",{lang:o}))):n.error(s.message||s.error||t("Failed to update language status"))}catch{n.error(t("Failed to update language status"))}finally{b(!1)}},c=i==null?void 0:i.find(e=>e.code===o),S=(c==null?void 0:c.enabled)??!0;return a.jsxs(K,{title:t("Manage Language"),url:"/manage-language",actions:[...o!=="en"?[{label:t(v?"Updating...":S?"Disable Language":"Enable Language"),icon:v?a.jsx(V,{className:"h-4 w-4 animate-spin"}):a.jsx(Z,{className:"h-4 w-4"}),variant:"outline",onClick:H},{label:t("Delete Language"),icon:a.jsx(ee,{className:"h-4 w-4"}),variant:"destructive",onClick:()=>p(!0)}]:[]],children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[a.jsx("div",{className:"md:w-64 flex-shrink-0",children:a.jsx("div",{className:"sticky top-20",children:a.jsx(G,{className:"h-[calc(100vh-5rem)]",children:a.jsx("div",{className:"pr-4 space-y-1",children:(i==null?void 0:i.map(e=>a.jsxs(m,{variant:"ghost",className:L("w-full justify-start",{"bg-muted font-medium":o===e.code,"opacity-50":e.enabled===!1}),onClick:()=>{o!==e.code&&g.get(route("manage-language",{lang:e.code}))},children:[e.countryCode&&a.jsx(T,{countryCode:e.countryCode,svg:!0,style:{width:"1.2em",height:"1.2em",marginRight:"8px"}}),a.jsx("span",{className:e.enabled===!1?"text-muted-foreground":"",children:e.name}),e.enabled===!1&&a.jsx(Y,{className:"h-4 w-4 ml-auto text-muted-foreground"})]},e.code)))||C.map(e=>a.jsxs(m,{variant:"ghost",className:L("w-full justify-start",{"bg-muted font-medium":o===e.code}),onClick:()=>{o!==e.code&&g.get(route("manage-language",{lang:e.code}))},children:[e.countryCode&&a.jsx(T,{countryCode:e.countryCode,svg:!0,style:{width:"1.2em",height:"1.2em",marginRight:"8px"}}),e.name]},e.code))})})})}),a.jsx("div",{className:"flex-1",children:a.jsxs($,{className:"p-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4 gap-2",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:[(c==null?void 0:c.flag)&&a.jsx("span",{className:"mr-2",children:c.flag}),t("Edit Labels for")," ",(N=(i||C).find(e=>e.code===o))==null?void 0:N.name]}),a.jsx(D,{placeholder:t("Search labels..."),value:j,onChange:e=>R(e.target.value),className:"w-full md:w-72"})]}),E?a.jsx("div",{children:t("Loading...")}):a.jsx("form",{onSubmit:e=>(e.preventDefault(),M(e),!1),children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(w).filter(([e,r])=>e.toLowerCase().includes(j.toLowerCase())||r.toLowerCase().includes(j.toLowerCase())).map(([e,r])=>a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-xs text-muted-foreground truncate mb-1",children:e}),a.jsx(D,{className:"w-full",value:r,onChange:s=>P(e,s.target.value)})]},e))}),a.jsx("div",{className:"pt-6 text-right",children:a.jsx(m,{type:"submit",disabled:y,children:y?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"animate-spin h-4 w-4 border-2 border-t-transparent border-primary rounded-full"}),t("Saving...")]}):t("Save Changes")})})]})})]})})]}),a.jsx(Q,{open:F,onOpenChange:A,onSuccess:()=>{window.location.reload()}}),a.jsx(J,{open:O,onOpenChange:p,children:a.jsxs(U,{children:[a.jsx(W,{children:a.jsx(_,{children:t("Delete Language")})}),a.jsxs("p",{children:[t("Are you sure you want to delete the")," ",a.jsx("strong",{children:o})," ",t("language? This will remove all translation files and cannot be undone."),"."]}),a.jsxs(z,{children:[a.jsx(m,{variant:"outline",onClick:()=>p(!1),children:t("Cancel")}),a.jsx(m,{variant:"destructive",onClick:q,children:t("Delete Language")})]})]})})]})}export{Me as default};
