import{r as d,j as e}from"./ui-Ps9nvBG1.js";import{u as W,al as A,C as I,a as H,d as T,e as u,I as P,B as E,r as q,t as n,f as U}from"./app-BTt_gkO3.js";import{S as c}from"./switch-DG4amuEJ.js";import{M as z}from"./message-square-DGoN5Yg5.js";import{C as D}from"./circle-help-DcK-i_SQ.js";import{S as F}from"./send-B0OsKa7V.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";function se({settings:t={}}){var f,w,g,b,N,v,S,C,y,B;const{t:s}=W(),[i,p]=d.useState(!!t.slack_enabled),[r,k]=d.useState(t.slack_webhook_url??""),[o,_]=d.useState({new_project:!!((f=t.slack_notifications)!=null&&f.new_project),new_task:!!((w=t.slack_notifications)!=null&&w.new_task),task_stage_updated:!!((g=t.slack_notifications)!=null&&g.task_stage_updated),new_milestone:!!((b=t.slack_notifications)!=null&&b.new_milestone),milestone_status_updated:!!((N=t.slack_notifications)!=null&&N.milestone_status_updated),new_task_comment:!!((v=t.slack_notifications)!=null&&v.new_task_comment),new_invoice:!!((S=t.slack_notifications)!=null&&S.new_invoice),invoice_status_updated:!!((C=t.slack_notifications)!=null&&C.invoice_status_updated),expense_approval:!!((y=t.slack_notifications)!=null&&y.expense_approval),new_budget:!!((B=t.slack_notifications)!=null&&B.new_budget)}),[G,x]=d.useState(!1),[j,h]=d.useState(!1);d.useEffect(()=>{p(!!t.slack_enabled),k(t.slack_webhook_url??"");const a=t.slack_notifications||{};_({new_project:!!a.new_project,new_task:!!a.new_task,task_stage_updated:!!a.task_stage_updated,new_milestone:!!a.new_milestone,milestone_status_updated:!!a.milestone_status_updated,new_task_comment:!!a.new_task_comment,new_invoice:!!a.new_invoice,invoice_status_updated:!!a.invoice_status_updated,expense_approval:!!a.expense_approval,new_budget:!!a.new_budget})},[t]);const L=async a=>{a.preventDefault(),x(!0),n.loading(s("Saving Slack settings..."));try{await U.post(route("slack.settings.update"),{slack_enabled:i,slack_webhook_url:r,slack_notifications:o},{preserveState:!0,onSuccess:()=>{n.dismiss(),n.success(s("Slack settings updated successfully"))},onError:m=>{n.dismiss(),n.error(s("Failed to save Slack settings")),console.error("Slack settings error:",m)},onFinish:()=>{x(!1)}})}catch{n.dismiss(),n.error(s("Failed to save Slack settings")),x(!1)}},R=async()=>{if(!r){n.error(s("Please enter a webhook URL first"));return}h(!0),n.loading(s("Sending test message..."));try{await U.post(route("slack.test-webhook"),{webhook_url:r,debug:!1},{preserveState:!0,onSuccess:()=>{n.dismiss(),n.success(s("Test message sent successfully to Slack!"))},onError:a=>{n.dismiss(),n.error(s("Failed to send test message")),console.error("Slack test error:",a)},onFinish:()=>{h(!1)}})}catch{n.dismiss(),n.error(s("Failed to send test message")),h(!1)}},l=(a,m)=>{_(M=>({...M,[a]:m}))};return e.jsx(A,{title:s("Slack Integration"),description:s("Configure Slack webhook integration for real-time notifications"),action:e.jsxs(E,{type:"submit",form:"slack-settings-form",size:"sm",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),s("Save Changes")]}),children:e.jsx("form",{id:"slack-settings-form",onSubmit:L,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(I,{children:[e.jsx(H,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-base font-medium",children:s("Integration Settings")})]})}),e.jsxs(T,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-md",children:[e.jsxs("div",{children:[e.jsx(u,{className:"font-medium",children:s("Enable Slack Integration")}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s("Turn on to receive notifications in Slack")})]}),e.jsx(c,{checked:i,onCheckedChange:p})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"font-medium",children:s("Webhook URL")}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(P,{type:"url",placeholder:s("https://hooks.slack.com/services/..."),value:r,onChange:a=>k(a.target.value),disabled:!i,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("Create a Slack app and add an Incoming Webhook to get this URL")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{className:"font-medium",children:s("Notification Types")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Project")}),e.jsx(c,{checked:o.new_project,onCheckedChange:a=>l("new_project",a),disabled:!i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Task")}),e.jsx(c,{checked:o.new_task,onCheckedChange:a=>l("new_task",a),disabled:!i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("Task Stage Updated")}),e.jsx(c,{checked:o.task_stage_updated,onCheckedChange:a=>l("task_stage_updated",a),disabled:!i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Milestone")}),e.jsx(c,{checked:o.new_milestone,onCheckedChange:a=>l("new_milestone",a),disabled:!i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("Milestone Status Updated")}),e.jsx(c,{checked:o.milestone_status_updated,onCheckedChange:a=>l("milestone_status_updated",a),disabled:!i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Task Comment")}),e.jsx(c,{checked:o.new_task_comment,onCheckedChange:a=>l("new_task_comment",a),disabled:!i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Invoice")}),e.jsx(c,{checked:o.new_invoice,onCheckedChange:a=>l("new_invoice",a),disabled:!i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("Invoice Status Updated")}),e.jsx(c,{checked:o.invoice_status_updated,onCheckedChange:a=>l("invoice_status_updated",a),disabled:!i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("Expense Approval")}),e.jsx(c,{checked:o.expense_approval,onCheckedChange:a=>l("expense_approval",a),disabled:!i})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Budget")}),e.jsx(c,{checked:o.new_budget,onCheckedChange:a=>l("new_budget",a),disabled:!i})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("Select which types of notifications to send to Slack")})]})]})]})}),e.jsx("div",{className:"space-y-6",children:e.jsx(I,{children:e.jsxs(T,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(F,{className:"h-4 w-4 text-primary"}),e.jsx("h3",{className:"text-base font-medium",children:s("Test Slack Integration")})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:s("Send a test message to verify your Slack configuration is working correctly.")}),e.jsxs(E,{type:"button",onClick:R,disabled:!i||!r||j,className:"w-full",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),s(j?"Sending...":"Send Test Message")]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center mb-6 mt-4",children:s("Enter a webhook URL to test the integration")}),e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-2",children:s("Setup Instructions")}),e.jsxs("ol",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:s("Go to your Slack workspace")}),e.jsx("li",{children:s("Create a new Slack app")}),e.jsx("li",{children:s("Enable Incoming Webhooks")}),e.jsx("li",{children:s("Add webhook to workspace")}),e.jsx("li",{children:s("Copy the webhook URL here")})]})]})]})})})]})})})}export{se as default};
