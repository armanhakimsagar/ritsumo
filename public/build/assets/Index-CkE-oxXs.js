import{r as f,j as e}from"./ui-Ps9nvBG1.js";import{u as te,K as ae,t,m as le,P as _,L as oe,g as L,B as u,D as A,l as F,n as q,o as G,I as y,f as de}from"./app-BTt_gkO3.js";import{P as ne}from"./page-template-BeQadk1c.js";import{C as ie}from"./CrudDeleteModal-CAwcbZOF.js";import{D as ce,a as me,b as xe,c as C}from"./dropdown-menu-CvJwe1WI.js";import{S as j}from"./settings-CG31wyPI.js";import{G as ue}from"./grip-vertical-1PuRD1LT.js";import{E as ge}from"./ellipsis-DhhTm3i6.js";import{S as he}from"./square-pen-BE6Ef4zh.js";import{S as pe}from"./star-LRbmONxX.js";import{T as fe}from"./trash-2-WsAE_ige.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./textarea-DPiv_-Qc.js";import"./select-z0EzYxFC.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./globe-BYIVGjA8.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./clock-NAV_RQL_.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";function ss({statuses:o,permissions:R}){var B;const{t:r}=te(),{flash:d,permissions:U}=ae().props,a=R||U,[W,m]=f.useState(!1),[b,g]=f.useState(null),[z,N]=f.useState(!1),[h,v]=f.useState(null);f.useEffect(()=>{d!=null&&d.success&&t.success(d.success),d!=null&&d.error&&t.error(d.error)},[d]);const{data:x,setData:n,post:H,put:E,delete:K,reset:i}=le({name:"",color:"#ef4444"}),T=s=>{s.preventDefault(),b?(t.loading("Updating status..."),E(route("bug-statuses.update",b.id),{onSuccess:()=>{t.dismiss(),m(!1),g(null),i()},onError:()=>{t.dismiss(),t.error("Failed to update status")}})):(t.loading("Creating status..."),H(route("bug-statuses.store"),{onSuccess:()=>{t.dismiss(),m(!1),i()},onError:()=>{t.dismiss(),t.error("Failed to create status")}}))},V=s=>{g(s),n({name:s.name,color:s.color}),m(!0)},Y=s=>{v(s),N(!0)},J=()=>{h&&(t.loading("Deleting status..."),K(route("bug-statuses.destroy",h.id),{onSuccess:()=>{t.dismiss(),N(!1),v(null)},onError:()=>{t.dismiss(),N(!1),v(null)}}))},Q=s=>{t.loading("Setting default status..."),E(route("bug-statuses.set-default",s.id),{onSuccess:()=>{t.dismiss()},onError:()=>{t.dismiss(),t.error("Failed to set default status")}})},X=(s,l)=>{s.dataTransfer.setData("text/plain",l.id.toString()),s.dataTransfer.effectAllowed="move",s.target.style.opacity="0.5"},Z=s=>{s.target.style.opacity="1",document.querySelectorAll(".drag-over").forEach(l=>{l.classList.remove("drag-over")})},$=s=>{s.preventDefault(),s.dataTransfer.dropEffect="move",s.currentTarget.classList.add("drag-over")},P=s=>{s.currentTarget.classList.remove("drag-over")},ee=(s,l)=>{s.preventDefault(),s.currentTarget.classList.remove("drag-over");const S=s.dataTransfer.getData("text/plain");if(S&&S!==l.id.toString()){const w=o.find(c=>c.id.toString()===S);if(w){const c=[...o],I=c.findIndex(p=>p.id===w.id),O=c.findIndex(p=>p.id===l.id);if(I!==-1&&O!==-1){c.splice(I,1),c.splice(O,0,w);const p=c.map((D,re)=>({id:D.id,order:re+1}));de.post(route("bug-statuses.reorder"),{statuses:p},{preserveState:!0,preserveScroll:!0,onError:D=>{t.error("Failed to reorder statuses"),console.error("Reorder failed:",D)}})}}}},k=()=>{g(null),i(),m(!0)},M=[];a!=null&&a.create&&M.push({label:r("Add Status"),icon:e.jsx(_,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:k});const se=[{title:r("Dashboard"),href:route("dashboard")},{title:r("Bugs"),href:route("bugs.index")},{title:r("Bug Statuses")}];return e.jsxs(ne,{title:r("Bug Statuses"),url:"/bug-statuses",actions:M,breadcrumbs:se,children:[e.jsx(oe,{title:r("Bug Statuses")}),e.jsx("style",{children:`
                .drag-over {
                    border-color: #3b82f6 !important;
                    background-color: #eff6ff !important;
                    transform: scale(1.02);
                }
            `}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white border rounded-lg p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(j,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:r("Total Statuses")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.length})]})]})}),e.jsx("div",{className:"bg-white border rounded-lg p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(j,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:r("Total Bugs")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.reduce((s,l)=>s+(l.bugs_count||0),0)})]})]})}),e.jsx("div",{className:"bg-white border rounded-lg p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(j,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:r("Default Status")}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:((B=o.find(s=>s.is_default))==null?void 0:B.name)||r("None")})]})]})}),e.jsx("div",{className:"bg-white border rounded-lg p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(j,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:r("Avg Bugs/Status")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.length>0?Math.round(o.reduce((s,l)=>s+(l.bugs_count||0),0)/o.length):0})]})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:r("Bug Workflow Statuses")}),e.jsx(L,{variant:"secondary",className:"ml-2",children:r("Drag to reorder")})]}),e.jsxs("div",{className:"space-y-3",children:[o.map(s=>e.jsx("div",{className:"bg-white border rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",draggable:!0,onDragStart:l=>X(l,s),onDragEnd:Z,onDragOver:$,onDragLeave:P,onDrop:l=>ee(l,s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"cursor-move p-1 hover:bg-gray-100 rounded",children:e.jsx(ue,{className:"h-5 w-5 text-gray-400"})}),e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white shadow-sm",style:{backgroundColor:s.color}}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),s.is_default&&e.jsx(L,{variant:"outline",className:"text-xs",children:r("Default")})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Order: ",s.order]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.bugs_count||0}),e.jsx("p",{className:"text-sm text-gray-500",children:r("bugs")})]}),e.jsx("div",{className:"text-right",children:e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:s.color})}),e.jsxs(ce,{children:[e.jsx(me,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(ge,{className:"h-4 w-4"})})}),e.jsxs(xe,{align:"end",children:[(a==null?void 0:a.update)&&e.jsxs(C,{onClick:()=>V(s),children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),r("Edit")]}),(a==null?void 0:a.set_default)&&!s.is_default&&e.jsxs(C,{onClick:()=>Q(s),children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),r("Set as Default")]}),(a==null?void 0:a.delete)&&s.bugs_count===0&&e.jsxs(C,{onClick:()=>Y(s),className:"text-red-600",disabled:s.bugs_count>0,children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),r("Delete")]})]})]})]})]})},s.id)),o.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r("No statuses yet")}),e.jsx("p",{className:"text-gray-500 mb-4",children:r("Create your first bug status to get started")}),(a==null?void 0:a.create)&&e.jsxs(u,{onClick:k,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),r("Add Your First Status")]})]})]})]})]}),e.jsx(A,{open:W&&!b,onOpenChange:s=>{m(s),s||i()},children:e.jsxs(F,{className:"sm:max-w-md",children:[e.jsx(q,{children:e.jsx(G,{children:r("Create New Status")})}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status Name"}),e.jsx(y,{value:x.name,onChange:s=>n("name",s.target.value),placeholder:"Enter status name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"color",value:x.color,onChange:s=>n("color",s.target.value),className:"w-12 h-10 rounded-md border border-gray-300 cursor-pointer"}),e.jsx(y,{value:x.color,onChange:s=>n("color",s.target.value),placeholder:"#ef4444",className:"flex-1"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>{m(!1),i()},children:"Cancel"}),e.jsx(u,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Create Status"})]})]})]})}),e.jsx(A,{open:!!b,onOpenChange:s=>{s||(g(null),i())},children:e.jsxs(F,{className:"sm:max-w-md",children:[e.jsx(q,{children:e.jsx(G,{children:r("Edit Status")})}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status Name"}),e.jsx(y,{value:x.name,onChange:s=>n("name",s.target.value),placeholder:"Enter status name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"color",value:x.color,onChange:s=>n("color",s.target.value),className:"w-12 h-10 rounded-md border border-gray-300 cursor-pointer"}),e.jsx(y,{value:x.color,onChange:s=>n("color",s.target.value),placeholder:"#ef4444",className:"flex-1"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>{g(null),i()},children:"Cancel"}),e.jsx(u,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Update Status"})]})]})]})}),e.jsx(ie,{isOpen:z,onClose:()=>{N(!1),v(null)},onConfirm:J,itemName:(h==null?void 0:h.name)||"",entityName:"bug status"})]})}export{ss as default};
