import{r as u,j as e}from"./ui-Ps9nvBG1.js";import{P as ee,L as se}from"./page-template-BeQadk1c.js";import{u as te,K as ae,t as j,S as V,I as re,f as h,B as i,C as le,a as ie,b as ce,g as H,d as de,i as S,j as C,k as _}from"./app-BTt_gkO3.js";import{S as q,a as A,b as T,c as z,d as o}from"./select-z0EzYxFC.js";import{f as k}from"./currency-kzm_C5pv.js";import{F as ne}from"./filter-C99mLYzj.js";import{L as oe}from"./list-D1IfOmxs.js";import{C as $}from"./circle-check-big-BMYVPbRH.js";import{C as G}from"./circle-x-BnYRe0cI.js";import{C as K}from"./circle-alert-DCoDy4PA.js";import{C as me}from"./clock-NAV_RQL_.js";import"./vendor-B1hewrmX.js";import"./textarea-DPiv_-Qc.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./chevron-up-CaRG6751.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";function Qe({expenses:l,stats:v,projects:b,filters:m,permissions:X}){var P,B,M;const{t:I}=te(),{flash:x,permissions:J}=ae().props,a=X||J,[c,R]=u.useState((m==null?void 0:m.search)||""),[d,E]=u.useState((m==null?void 0:m.status)||"all"),[n,F]=u.useState((m==null?void 0:m.project_id)||"all"),[L,O]=u.useState(!1),[y,D]=u.useState("cards");u.useEffect(()=>{x!=null&&x.success&&j.success(x.success),x!=null&&x.error&&j.error(x.error)},[x]);const Q=s=>{s.preventDefault(),U()},U=()=>{const s={page:1};c&&(s.search=c),d!=="all"&&(s.status=d),n!=="all"&&(s.project_id=n),h.get(route("expense-approvals.index"),s,{preserveState:!0})},W=()=>{R(""),E("all"),F("all"),h.get(route("expense-approvals.index"),{page:1})},w=()=>c||d!=="all"||n!=="all",p=(s,t)=>{const r=t==="approve"?"Approving":t==="reject"?"Rejecting":"Processing";j.loading(`${r} expense...`);const g=t==="approve"?"expense-approvals.approve":t==="reject"?"expense-approvals.reject":"expense-approvals.request-info",N={};t==="reject"?N.notes="Expense rejected by approver":t==="request_info"?N.notes="Additional information required":N.notes="",h.post(route(g,s),N,{onSuccess:()=>{j.dismiss()},onError:f=>{j.dismiss(),console.error("Expense approval error:",f);const Z=(f==null?void 0:f.message)||`Failed to ${t} expense`;j.error(Z)}})},Y=[{title:"Dashboard",href:route("dashboard")},{title:I("Budget & Expenses")},{title:"Expense Approvals"}];return e.jsx(ee,{title:I("Expense Approvals"),breadcrumbs:Y,noPadding:!0,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:v.pending_count}),e.jsx("div",{className:"text-sm text-gray-600",children:"Pending Approval"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:v.requires_info_count}),e.jsx("div",{className:"text-sm text-gray-600",children:"Requires Info"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:v.approved_today}),e.jsx("div",{className:"text-sm text-gray-600",children:"Approved Today"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:k(v.pending_amount||0)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Pending Amount"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("form",{onSubmit:Q,className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-64",children:[e.jsx(V,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-400"}),e.jsx(re,{placeholder:"Search expenses...",value:c,onChange:s=>{R(s.target.value),clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{const t={page:1};s.target.value&&(t.search=s.target.value),d!=="all"&&(t.status=d),n!=="all"&&(t.project_id=n),h.get(route("expense-approvals.index"),t,{preserveState:!0})},500)},className:"pl-9"})]}),e.jsxs(i,{type:"submit",size:"sm",children:[e.jsx(V,{className:"h-4 w-4 mr-1.5"}),"Search"]})]}),e.jsxs(i,{variant:w()?"default":"outline",size:"sm",onClick:()=>O(!L),children:[e.jsx(ne,{className:"h-4 w-4 mr-1.5"}),"Filters",w()&&e.jsx("span",{className:"ml-1 bg-primary-foreground text-primary rounded-full w-5 h-5 flex items-center justify-center text-xs",children:(c?1:0)+(d!=="all"?1:0)+(n!=="all"?1:0)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(q,{value:((P=l.per_page)==null?void 0:P.toString())||"20",onValueChange:s=>{const t={page:1,per_page:parseInt(s)};c&&(t.search=c),d!=="all"&&(t.status=d),n!=="all"&&(t.project_id=n),h.get(route("expense-approvals.index"),t,{preserveState:!0})},children:[e.jsx(A,{className:"w-20",children:e.jsx(T,{})}),e.jsxs(z,{children:[e.jsx(o,{value:"10",children:"10"}),e.jsx(o,{value:"20",children:"20"}),e.jsx(o,{value:"50",children:"50"}),e.jsx(o,{value:"100",children:"100"})]})]}),e.jsxs("div",{className:"border rounded-md p-0.5",children:[e.jsx(i,{size:"sm",variant:y==="cards"?"default":"ghost",className:"h-7 px-2",onClick:()=>D("cards"),children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx(i,{size:"sm",variant:y==="table"?"default":"ghost",className:"h-7 px-2",onClick:()=>D("table"),children:e.jsx(oe,{className:"h-4 w-4"})})]})]})]}),L&&e.jsx("div",{className:"p-4 bg-gray-50 rounded-md",children:e.jsxs("div",{className:"flex gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs(q,{value:d,onValueChange:s=>{E(s);const t={page:1};c&&(t.search=c),s!=="all"&&(t.status=s),n!=="all"&&(t.project_id=n),h.get(route("expense-approvals.index"),t,{preserveState:!0})},children:[e.jsx(A,{className:"w-40",children:e.jsx(T,{})}),e.jsxs(z,{children:[e.jsx(o,{value:"all",children:"All"}),e.jsx(o,{value:"pending",children:"Pending"}),e.jsx(o,{value:"approved",children:"Approved"}),e.jsx(o,{value:"rejected",children:"Rejected"}),e.jsx(o,{value:"requires_info",children:"Requires Info"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Project"}),e.jsxs(q,{value:n,onValueChange:s=>{F(s);const t={page:1};c&&(t.search=c),d!=="all"&&(t.status=d),s!=="all"&&(t.project_id=s),h.get(route("expense-approvals.index"),t,{preserveState:!0})},children:[e.jsx(A,{className:"w-48",children:e.jsx(T,{placeholder:"All Projects"})}),e.jsxs(z,{children:[e.jsx(o,{value:"all",children:"All"}),b==null?void 0:b.map(s=>e.jsx(o,{value:s.id.toString(),children:s.title},s.id))]})]})]}),e.jsx(i,{variant:"outline",size:"sm",onClick:W,disabled:!w(),children:"Reset Filters"})]})})]})}),l&&l.data&&l.data.length>0?y==="cards"?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:l.data.map(s=>{var t,r;return e.jsxs(le,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(ie,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(ce,{className:"text-lg mb-1",children:s.title}),e.jsx("div",{className:"text-sm text-gray-500 mb-2",children:e.jsx("span",{className:"font-medium",children:(t=s.project)==null?void 0:t.title})}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Submitted by ",(r=s.submitter)==null?void 0:r.name," â€¢ ",new Date(s.expense_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsx("div",{className:"text-xl font-bold text-gray-900 mb-1",children:k(s.amount)}),e.jsx(H,{variant:"secondary",className:s.status==="requires_info"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800",children:s.status==="requires_info"?"Requires Info":"Pending"})]})]})}),e.jsxs(de,{className:"pt-0",children:[s.description&&e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:s.description})}),s.budget_category&&e.jsx("div",{className:"mb-4",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:s.budget_category.name})}),e.jsxs("div",{className:"flex gap-2",children:[(a==null?void 0:a.approve)&&e.jsxs(i,{size:"sm",onClick:()=>p(s.id,"approve"),className:"bg-green-600 hover:bg-green-700 flex-1",children:[e.jsx($,{className:"h-4 w-4 mr-1"}),"Approve"]}),(a==null?void 0:a.reject)&&e.jsxs(i,{size:"sm",onClick:()=>p(s.id,"reject"),variant:"destructive",className:"flex-1",children:[e.jsx(G,{className:"h-4 w-4 mr-1"}),"Reject"]}),(a==null?void 0:a.request_info)&&s.status==="pending"&&e.jsxs(i,{size:"sm",onClick:()=>p(s.id,"request_info"),variant:"outline",className:"flex-1",children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),"Info"]})]})]})]},s.id)})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",l.from," to ",l.to," of ",l.total," expenses"]}),e.jsx("div",{className:"flex gap-1",children:(B=l.links)==null?void 0:B.map((s,t)=>{const r=s.label==="&laquo; Previous"||s.label==="Next &raquo;",g=s.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(i,{variant:s.active?"default":"outline",size:r?"sm":"icon",className:r?"px-3":"h-8 w-8",disabled:!s.url,onClick:()=>s.url&&h.get(s.url),children:r?g:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},t)})})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expense"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project & Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.data.map(s=>{var t,r;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.title}),e.jsxs("div",{className:"text-sm text-gray-500",children:["by ",(t=s.submitter)==null?void 0:t.name]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:(r=s.project)==null?void 0:r.title}),s.budget_category&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:s.budget_category.color}}),e.jsx("span",{className:"text-xs text-gray-500",children:s.budget_category.name})]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:k(s.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(H,{variant:"secondary",className:s.status==="requires_info"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800",children:s.status==="requires_info"?"Requires Info":"Pending"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.expense_date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-1",children:[(a==null?void 0:a.approve)&&e.jsxs(S,{children:[e.jsx(C,{asChild:!0,children:e.jsx(i,{size:"sm",onClick:()=>p(s.id,"approve"),className:"bg-green-600 hover:bg-green-700",children:e.jsx($,{className:"h-3 w-3"})})}),e.jsx(_,{children:"Approve"})]}),(a==null?void 0:a.reject)&&e.jsxs(S,{children:[e.jsx(C,{asChild:!0,children:e.jsx(i,{size:"sm",onClick:()=>p(s.id,"reject"),variant:"destructive",children:e.jsx(G,{className:"h-3 w-3"})})}),e.jsx(_,{children:"Reject"})]}),(a==null?void 0:a.request_info)&&s.status==="pending"&&e.jsxs(S,{children:[e.jsx(C,{asChild:!0,children:e.jsx(i,{size:"sm",onClick:()=>p(s.id,"request_info"),variant:"outline",children:e.jsx(K,{className:"h-3 w-3"})})}),e.jsx(_,{children:"Request Info"})]})]})})]},s.id)})})]}),e.jsxs("div",{className:"p-4 border-t flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",l.from," to ",l.to," of ",l.total," expenses"]}),e.jsx("div",{className:"flex gap-1",children:(M=l.links)==null?void 0:M.map((s,t)=>{const r=s.label==="&laquo; Previous"||s.label==="Next &raquo;",g=s.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(i,{variant:s.active?"default":"outline",size:r?"sm":"icon",className:r?"px-3":"h-8 w-8",disabled:!s.url,onClick:()=>s.url&&h.get(s.url),children:r?g:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},t)})})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx(me,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No pending approvals"}),e.jsx("p",{className:"text-sm text-gray-400",children:"All expenses have been processed"})]})]})})}export{Qe as default};
