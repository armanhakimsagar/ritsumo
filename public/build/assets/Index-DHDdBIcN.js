import{r as f,j as e}from"./ui-Ps9nvBG1.js";import{u as Le,D as Ge,l as Ke,n as Je,o as Qe,I as ne,B as h,r as Re,t as m,f as y,g as G,K as Xe,P as Te,L as Ye,C as oe,d as xe,S as Ae,e as W,a as Ze,b as We,i as O,j as V,k as I,z as ke}from"./app-BTt_gkO3.js";import es from"./TaskModal-yQUCMdqh.js";import{T as ss}from"./textarea-DPiv_-Qc.js";import{S as P,a as F,b as M,c as z,d as x}from"./select-z0EzYxFC.js";import{M as De,A as rs,a as ts,C as is}from"./minus-CDE_iHiI.js";import{T as de}from"./triangle-alert-BuDHDWvi.js";import{P as as,L as ls,A as he,c as me,a as ue}from"./page-template-BeQadk1c.js";import{P as Pe}from"./progress-B213Sqsa.js";import{C as ns}from"./CrudDeleteModal-CAwcbZOF.js";import{F as ds}from"./filter-C99mLYzj.js";import{L as cs}from"./list-D1IfOmxs.js";import{E as pe}from"./eye-BGcEqodV.js";import{S as ge}from"./square-pen-BE6Ef4zh.js";import{T as je}from"./trash-2-WsAE_ige.js";import{S as Fe}from"./square-check-big-B29hCoNu.js";import{U as os}from"./user-DZ3jVi18.js";import{C as Me}from"./trending-up-BkxnV74k.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./tabs-D83PhGuv.js";import"./dropdown-menu-CvJwe1WI.js";import"./ellipsis-DhhTm3i6.js";import"./message-square-DGoN5Yg5.js";import"./send-B0OsKa7V.js";import"./square-DyzuZ8y2.js";import"./calendar-pZCS8WPy.js";import"./download-FY3rJJBK.js";import"./file-3AWHN2l6.js";import"./paperclip-h_SfHoPk.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./globe-BYIVGjA8.js";import"./building-2-CVOsE0mA.js";import"./bug-DP5pb0Nw.js";import"./clock-NAV_RQL_.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./settings-CG31wyPI.js";import"./use-favicon-vjALIuby.js";function xs({isOpen:t,onClose:C,task:n,projects:w,members:o,milestones:d=[]}){var p,R,g,X;const{t:c}=Le(),K=!!n,[r,u]=f.useState({project_id:((p=n==null?void 0:n.project_id)==null?void 0:p.toString())||"",milestone_id:((R=n==null?void 0:n.milestone_id)==null?void 0:R.toString())||"none",title:(n==null?void 0:n.title)||"",description:(n==null?void 0:n.description)||"",priority:(n==null?void 0:n.priority)||"medium",start_date:(n==null?void 0:n.start_date)||"",end_date:(n==null?void 0:n.end_date)||"",assigned_to:((X=(g=n==null?void 0:n.assigned_to)==null?void 0:g.id)==null?void 0:X.toString())||"none"}),[k,Q]=f.useState([]),[v,J]=f.useState([]);f.useEffect(()=>{var a,b,H,U,L,S,q;if(n){const E=w.find(D=>D.id===n.project_id);Q((E==null?void 0:E.milestones)||[]);const se=((a=E==null?void 0:E.members)==null?void 0:a.filter(D=>{var $;return(($=D.user)==null?void 0:$.type)!=="client"}).map(D=>D.user))||[];J(se.length>0?se:o),u({project_id:((b=n.project_id)==null?void 0:b.toString())||"",milestone_id:((H=n.milestone_id)==null?void 0:H.toString())||"none",title:n.title,description:n.description||"",priority:n.priority,start_date:((U=n.start_date)==null?void 0:U.split("T")[0])||"",end_date:((L=n.end_date)==null?void 0:L.split("T")[0])||"",assigned_to:((q=(S=n.assigned_to)==null?void 0:S.id)==null?void 0:q.toString())||"none"})}else u({project_id:"",milestone_id:"none",title:"",description:"",priority:"medium",start_date:"",end_date:"",assigned_to:"none"}),Q([]),J([])},[n,w,o]);const j=a=>{var L;u(S=>({...S,project_id:a,milestone_id:"none",assigned_to:"none"}));const b=w.find(S=>S.id.toString()===a),H=(b==null?void 0:b.milestones)||[];Q(H);const U=((L=b==null?void 0:b.members)==null?void 0:L.filter(S=>{var q;return((q=S.user)==null?void 0:q.type)!=="client"}).map(S=>S.user))||[];J(U.length>0?U:o)},ee=a=>{a.preventDefault();const b={...r,milestone_id:r.milestone_id==="none"?"":r.milestone_id,assigned_to:r.assigned_to==="none"?"":r.assigned_to};K?(m.loading(c("Updating task...")),y.put(route("tasks.update",n.id),b,{onSuccess:()=>{m.dismiss(),C()},onError:()=>{m.dismiss(),m.error(c("Failed to update task"))}})):(m.loading(c("Creating task...")),y.post(route("tasks.store"),b,{onSuccess:()=>{m.dismiss(),C()},onError:()=>{m.dismiss(),m.error(c("Failed to create task"))}}))};return e.jsx(Ge,{open:t,onOpenChange:C,children:e.jsxs(Ke,{className:"max-w-2xl",children:[e.jsx(Je,{children:e.jsx(Qe,{children:c(K?"Edit Task":"Create Task")})}),e.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[!K&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[c("Project")," * ",e.jsxs("span",{className:"text-xs text-gray-500",children:["(",c("Select to load milestones & team members"),")"]})]}),e.jsxs(P,{value:r.project_id||"",onValueChange:j,required:!0,children:[e.jsx(F,{children:e.jsx(M,{placeholder:c("Select a project")})}),e.jsx(z,{className:"z-[9999]",children:w.map(a=>e.jsx(x,{value:a.id.toString(),children:a.title},a.id))})]})]}),r.project_id&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c("Milestone")}),e.jsxs(P,{value:r.milestone_id,onValueChange:a=>u({...r,milestone_id:a}),children:[e.jsx(F,{children:e.jsx(M,{placeholder:k.length>0?c("Select a milestone (optional)"):c("No milestones available")})}),e.jsxs(z,{className:"z-[9999]",children:[e.jsx(x,{value:"none",children:c("No milestone")}),k.map(a=>e.jsx(x,{value:a.id.toString(),children:a.title},a.id))]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[c("Title")," *"]}),e.jsx(ne,{value:r.title,onChange:a=>u({...r,title:a.target.value}),placeholder:c("Enter task title"),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c("Description")}),e.jsx(ss,{value:r.description,onChange:a=>u({...r,description:a.target.value}),placeholder:c("Describe the task..."),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c("Priority")}),e.jsxs(P,{value:r.priority,onValueChange:a=>u({...r,priority:a}),children:[e.jsx(F,{children:e.jsx(M,{})}),e.jsxs(z,{className:"z-[9999]",children:[e.jsx(x,{value:"low",children:c("Low")}),e.jsx(x,{value:"medium",children:c("Medium")}),e.jsx(x,{value:"high",children:c("High")}),e.jsx(x,{value:"critical",children:c("Critical")})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign to"}),e.jsxs(P,{value:r.assigned_to,onValueChange:a=>u({...r,assigned_to:a}),disabled:!r.project_id,children:[e.jsx(F,{children:e.jsx(M,{placeholder:r.project_id?v.length>0?"Select assignee":"No team members available":"Select project first"})}),e.jsxs(z,{className:"z-[9999]",children:[e.jsx(x,{value:"none",children:"Unassigned"}),v.map(a=>e.jsxs(x,{value:a.id.toString(),children:[a.name," ",a.type!=="client"?"(Team)":"(Client)"]},a.id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx(ne,{type:"date",value:r.start_date,onChange:a=>u({...r,start_date:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date"}),e.jsx(ne,{type:"date",value:r.end_date,onChange:a=>u({...r,end_date:a.target.value})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(h,{type:"button",variant:"outline",onClick:C,children:"Cancel"}),e.jsxs(h,{type:"submit",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),K?"Update Task":"Create Task"]})]})]})]})})}function ze({priority:t,showIcon:C=!1}){const w=(d=>{switch(d){case"critical":return{color:"bg-red-100 text-red-800 border-red-200",icon:de,label:"Critical"};case"high":return{color:"bg-orange-100 text-orange-800 border-orange-200",icon:ts,label:"High"};case"medium":return{color:"bg-yellow-100 text-yellow-800 border-yellow-200",icon:De,label:"Medium"};case"low":return{color:"bg-green-100 text-green-800 border-green-200",icon:rs,label:"Low"};default:return{color:"bg-gray-100 text-gray-800 border-gray-200",icon:De,label:"Medium"}}})(t),o=w.icon;return e.jsxs(G,{className:w.color,children:[C&&e.jsx(o,{className:"h-3 w-3 mr-1"}),w.label]})}function hs({task:t,stages:C,variant:n="select"}){const w=d=>{y.put(route("tasks.change-stage",t.id),{task_stage_id:d})},o=C.find(d=>d.id===t.task_stage_id);return n==="badge"?e.jsx(G,{variant:"outline",style:{backgroundColor:(o==null?void 0:o.color)+"20",borderColor:o==null?void 0:o.color,color:o==null?void 0:o.color},children:o==null?void 0:o.name}):e.jsxs(P,{value:t.task_stage_id.toString(),onValueChange:w,children:[e.jsx(F,{children:e.jsx(M,{})}),e.jsx(z,{children:C.map(d=>e.jsx(x,{value:d.id.toString(),children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:d.color}}),e.jsx("span",{children:d.name})]})},d.id))})]})}function nr({tasks:t,projects:C,stages:n,members:w,filters:o,project_name:d,userWorkspaceRole:c,permissions:K}){var Ne,be,ye,we,_e,Ce,Se;const{t:r}=Le(),{flash:u,permissions:k}=Xe().props,Q=K||k,[v,J]=f.useState(o.search||""),[j,ee]=f.useState(o.project_id||"all"),[p,R]=f.useState(o.stage_id||"all"),[g,X]=f.useState(o.priority||"all"),[a,b]=f.useState(o.assigned_to||"all"),[H,U]=f.useState(!1),[L,S]=f.useState(null),[q,E]=f.useState(!1),[se,D]=f.useState(!1),[$,re]=f.useState(null),[A,ce]=f.useState(o.view||"kanban"),[Ee,te]=f.useState(!1),[Y,ie]=f.useState(null);f.useEffect(()=>{u!=null&&u.success&&m.success(u.success),u!=null&&u.error&&m.error(u.error)},[u]);const Oe=s=>{s.preventDefault(),Ve()},Ve=()=>{const s={page:1};v&&(s.search=v),j!=="all"&&(s.project_id=j),p!=="all"&&(s.stage_id=p),g!=="all"&&(s.priority=g),a!=="all"&&(s.assigned_to=a),s.view=A,d&&(s.project_name=d),y.get(route("tasks.index"),s,{preserveState:!0,preserveScroll:!0})},ae=(s,l)=>{const i={page:1};v&&(i.search=v),s==="project_id"&&ee(l),s==="stage_id"&&R(l),s==="priority"&&X(l),s==="assigned_to"&&b(l),j!=="all"&&s!=="project_id"&&(i.project_id=j),p!=="all"&&s!=="stage_id"&&(i.stage_id=p),g!=="all"&&s!=="priority"&&(i.priority=g),a!=="all"&&s!=="assigned_to"&&(i.assigned_to=a),l!=="all"&&(i[s]=l),i.view=A,d&&(i.project_name=d),y.get(route("tasks.index"),i,{preserveState:!0,preserveScroll:!0})},_=(s,l)=>{switch(s){case"view":Ie(l);break;case"edit":He(l);break;case"duplicate":m.loading("Duplicating task..."),y.post(route("tasks.duplicate",l),{},{onSuccess:()=>{m.dismiss()},onError:()=>{m.dismiss(),m.error("Failed to duplicate task")}});break;case"delete":const i=(Array.isArray(t)?t:(t==null?void 0:t.data)||[]).find(N=>N.id===l);i&&(ie(i),te(!0));break}},Ie=async s=>{try{const i=await(await fetch(route("tasks.show",s))).json();S(i.task),E(!0)}catch(l){console.error("Failed to load task:",l)}},He=async s=>{try{const i=await(await fetch(route("tasks.show",s))).json(),N={...i.task,project:C.find(B=>B.id===i.task.project_id)||i.task.project};re(N),D(!0)}catch(l){console.error("Failed to load task:",l)}},Z=()=>j!=="all"||p!=="all"||g!=="all"||a!=="all"||v!=="",Ue=()=>(j!=="all"?1:0)+(p!=="all"?1:0)+(g!=="all"?1:0)+(a!=="all"?1:0)+(v?1:0),ve=()=>{ee("all"),R("all"),X("all"),b("all"),J(""),U(!1),y.get(route("tasks.index"),{page:1,view:"kanban"},{preserveState:!0,preserveScroll:!0})},qe=()=>{Y&&(m.loading("Deleting task..."),y.delete(route("tasks.destroy",Y.id),{onSuccess:()=>{m.dismiss(),te(!1),ie(null)},onError:()=>{m.dismiss(),m.error("Failed to delete task"),te(!1),ie(null)}}))},le=s=>{if(!s)return!1;const l=new Date;return new Date(s)<l},$e=s=>({low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",fe=[];c!=="client"&&fe.push({label:r("Create Task"),icon:e.jsx(Te,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:()=>{re(null),D(!0)}});const Be=[{title:r("Dashboard"),href:route("dashboard")},...d?[{title:r("Projects"),href:route("projects.index")}]:[],{title:d?`${d} - ${r("Tasks")}`:r("Tasks")}];return e.jsxs(as,{title:d?`${d} - ${r("Tasks Management")}`:r("Tasks Management"),url:"/tasks",actions:fe,breadcrumbs:Be,noPadding:!0,children:[e.jsx(Ye,{title:r("Tasks")}),e.jsx(oe,{className:"mb-4 hover:shadow-md transition-shadow",children:e.jsx(xe,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:Array.isArray(t)?t.length:(t==null?void 0:t.total)||0}),e.jsx("div",{className:"text-xs text-gray-600",children:r("Total Tasks")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-yellow-600",children:(Array.isArray(t)?t:(t==null?void 0:t.data)||[]).filter(s=>!s.assigned_to).length}),e.jsx("div",{className:"text-xs text-gray-600",children:r("Unassigned")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:(Array.isArray(t)?t:(t==null?void 0:t.data)||[]).filter(s=>s.assigned_to).length}),e.jsx("div",{className:"text-xs text-gray-600",children:r("Assigned")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-red-600",children:(Array.isArray(t)?t:(t==null?void 0:t.data)||[]).filter(s=>s.end_date&&le(s.end_date)).length}),e.jsx("div",{className:"text-xs text-gray-600",children:r("Overdue")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-orange-600",children:(Array.isArray(t)?t:(t==null?void 0:t.data)||[]).filter(s=>s.priority==="high"||s.priority==="critical").length}),e.jsx("div",{className:"text-xs text-gray-600",children:r("High Priority")})]})]})})}),e.jsx("div",{className:"bg-white rounded-lg shadow mb-4",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("form",{onSubmit:Oe,className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-64",children:[e.jsx(Ae,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ne,{placeholder:r("Search tasks..."),value:v,onChange:s=>{J(s.target.value),clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{const l={page:1};s.target.value&&(l.search=s.target.value),j!=="all"&&(l.project_id=j),p!=="all"&&(l.stage_id=p),g!=="all"&&(l.priority=g),a!=="all"&&(l.assigned_to=a),l.view=A,d&&(l.project_name=d),y.get(route("tasks.index"),l,{preserveState:!0,preserveScroll:!0})},500)},className:"w-full pl-9"})]}),e.jsxs(h,{type:"submit",size:"sm",children:[e.jsx(Ae,{className:"h-4 w-4 mr-1.5"}),r("Search")]})]}),e.jsxs(h,{variant:Z()?"default":"outline",size:"sm",onClick:()=>U(!H),children:[e.jsx(ds,{className:"h-4 w-4 mr-1.5"}),r(H?"Hide Filters":"Filters"),Z()&&e.jsx("span",{className:"ml-1 bg-primary-foreground text-primary rounded-full w-5 h-5 flex items-center justify-center text-xs",children:Ue()})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1 border rounded-md p-1",children:[e.jsx(h,{variant:A==="card"?"default":"ghost",size:"sm",onClick:()=>{ce("card");const s={page:1,view:"grid"};v&&(s.search=v),j!=="all"&&(s.project_id=j),p!=="all"&&(s.stage_id=p),g!=="all"&&(s.priority=g),a!=="all"&&(s.assigned_to=a),d&&(s.project_name=d),y.get(route("tasks.index"),s,{preserveState:!0,preserveScroll:!0})},className:"h-7 px-2",children:e.jsx(ls,{className:"h-4 w-4"})}),e.jsx(h,{variant:A==="table"?"default":"ghost",size:"sm",onClick:()=>{ce("table");const s={page:1,view:"list"};v&&(s.search=v),j!=="all"&&(s.project_id=j),p!=="all"&&(s.stage_id=p),g!=="all"&&(s.priority=g),a!=="all"&&(s.assigned_to=a),d&&(s.project_name=d),y.get(route("tasks.index"),s,{preserveState:!0,preserveScroll:!0})},className:"h-7 px-2",children:e.jsx(cs,{className:"h-4 w-4"})}),e.jsx(h,{variant:A==="kanban"?"default":"ghost",size:"sm",onClick:()=>{ce("kanban");const s={view:"kanban"};v&&(s.search=v),j!=="all"&&(s.project_id=j),p!=="all"&&(s.stage_id=p),g!=="all"&&(s.priority=g),a!=="all"&&(s.assigned_to=a),d&&(s.project_name=d),y.get(route("tasks.index"),s,{preserveState:!0,preserveScroll:!0})},className:"h-7 px-2",children:e.jsx(is,{className:"h-4 w-4"})})]}),A!=="kanban"&&e.jsxs(e.Fragment,{children:[e.jsxs(W,{className:"text-xs text-muted-foreground",children:[r("Per Page"),":"]}),e.jsxs(P,{value:((Ne=t==null?void 0:t.per_page)==null?void 0:Ne.toString())||"20",onValueChange:s=>{const l={page:1,per_page:parseInt(s)};v&&(l.search=v),j!=="all"&&(l.project_id=j),p!=="all"&&(l.stage_id=p),g!=="all"&&(l.priority=g),a!=="all"&&(l.assigned_to=a),l.view=A,d&&(l.project_name=d),y.get(route("tasks.index"),l,{preserveState:!0,preserveScroll:!0})},children:[e.jsx(F,{className:"w-16 h-8",children:e.jsx(M,{})}),e.jsxs(z,{children:[e.jsx(x,{value:"20",children:"20"}),e.jsx(x,{value:"50",children:"50"}),e.jsx(x,{value:"100",children:"100"})]})]})]})]})]}),H&&e.jsx("div",{className:"p-4 bg-gray-50 border rounded-md",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:r("Project")}),e.jsxs(P,{value:j,onValueChange:s=>ae("project_id",s),children:[e.jsx(F,{className:"w-40",children:e.jsx(M,{placeholder:r("All Projects")})}),e.jsxs(z,{children:[e.jsx(x,{value:"all",children:r("All Projects")}),C.map(s=>e.jsx(x,{value:s.id.toString(),children:s.title},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:r("Status")}),e.jsxs(P,{value:p,onValueChange:s=>ae("stage_id",s),children:[e.jsx(F,{className:"w-40",children:e.jsx(M,{placeholder:"All Status"})}),e.jsxs(z,{children:[e.jsx(x,{value:"all",children:r("All")}),n.map(s=>e.jsx(x,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:r("Priority")}),e.jsxs(P,{value:g,onValueChange:s=>ae("priority",s),children:[e.jsx(F,{className:"w-40",children:e.jsx(M,{placeholder:"All Priority"})}),e.jsxs(z,{children:[e.jsx(x,{value:"all",children:r("All Priority")}),e.jsx(x,{value:"low",children:r("Low")}),e.jsx(x,{value:"medium",children:r("Medium")}),e.jsx(x,{value:"high",children:r("High")}),e.jsx(x,{value:"critical",children:r("Critical")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:r("Assignee")}),e.jsxs(P,{value:a,onValueChange:s=>ae("assigned_to",s),children:[e.jsx(F,{className:"w-40",children:e.jsx(M,{placeholder:"All Assignees"})}),e.jsxs(z,{children:[e.jsx(x,{value:"all",children:r("All Assignees")}),w.map(s=>e.jsx(x,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsx(h,{variant:"outline",size:"sm",className:"h-9",onClick:ve,disabled:!Z(),children:r("Reset Filters")})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow",children:A==="kanban"?e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg overflow-hidden",children:[e.jsx("style",{children:`
                            .kanban-scroll::-webkit-scrollbar {
                                height: 8px;
                            }
                            .kanban-scroll::-webkit-scrollbar-track {
                                background: #f1f5f9;
                                border-radius: 4px;
                            }
                            .kanban-scroll::-webkit-scrollbar-thumb {
                                background: #cbd5e1;
                                border-radius: 4px;
                            }
                            .kanban-scroll::-webkit-scrollbar-thumb:hover {
                                background: #94a3b8;
                            }
                            .column-scroll::-webkit-scrollbar {
                                width: 6px;
                            }
                            .column-scroll::-webkit-scrollbar-track {
                                background: #f8fafc;
                                border-radius: 3px;
                            }
                            .column-scroll::-webkit-scrollbar-thumb {
                                background: #e2e8f0;
                                border-radius: 3px;
                            }
                            .column-scroll::-webkit-scrollbar-thumb:hover {
                                background: #cbd5e1;
                            }
                        `}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 kanban-scroll",style:{height:"calc(100vh - 280px)",width:"100%"},children:n.map(s=>{const l=(Array.isArray(t)?t:(t==null?void 0:t.data)||[]).filter(i=>{var N;return((N=i.task_stage)==null?void 0:N.id)===s.id});return e.jsx("div",{className:"flex-shrink-0",style:{minWidth:"calc(20% - 16px)",width:"calc(20% - 16px)"},onDrop:i=>{i.preventDefault(),i.currentTarget.classList.remove("bg-blue-50");const N=i.dataTransfer.getData("taskId");N&&(m.loading("Updating task stage..."),y.put(route("tasks.change-stage",N),{task_stage_id:s.id},{onSuccess:()=>{m.dismiss()},onError:()=>{m.dismiss(),m.error("Failed to update task stage")}}))},onDragOver:i=>{i.preventDefault(),i.currentTarget.classList.add("bg-blue-50")},onDragLeave:i=>{i.currentTarget.classList.remove("bg-blue-50")},children:e.jsxs("div",{className:"bg-gray-100 rounded-lg h-full flex flex-col",children:[e.jsx("div",{className:"p-3 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-700",children:s.name}),e.jsx("span",{className:"text-xs text-gray-500 bg-gray-200 px-2 py-1 rounded-full",children:l.length})]})}),e.jsxs("div",{className:"p-2 space-y-2 overflow-y-auto flex-1 column-scroll",style:{maxHeight:"calc(100vh - 350px)"},children:[l.map(i=>{var N,B;return e.jsx("div",{draggable:!0,onDragStart:T=>{T.dataTransfer.setData("taskId",i.id.toString()),T.currentTarget.classList.add("opacity-50","scale-95")},onDragEnd:T=>{T.currentTarget.classList.remove("opacity-50","scale-95")},className:"cursor-move transition-all duration-200",children:e.jsx(oe,{className:"hover:shadow-md transition-all duration-200 border-l-4 hover:scale-105",style:{borderLeftColor:s.color},children:e.jsx(xe,{className:"p-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("h4",{className:"font-medium text-sm line-clamp-2 hover:text-blue-600 transition-colors cursor-pointer flex-1",onClick:()=>_("view",i.id),children:i.title}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(h,{variant:"ghost",size:"icon",onClick:T=>{T.stopPropagation(),_("view",i.id)},className:"h-6 w-6 text-blue-500 hover:text-blue-700",children:e.jsx(pe,{className:"h-3 w-3"})}),c!=="client"&&e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"ghost",size:"icon",onClick:T=>{T.stopPropagation(),_("edit",i.id)},className:"h-6 w-6 text-amber-500 hover:text-amber-700",children:e.jsx(ge,{className:"h-3 w-3"})}),e.jsx(h,{variant:"ghost",size:"icon",onClick:T=>{T.stopPropagation(),_("delete",i.id)},className:"h-6 w-6 text-red-500 hover:text-red-700",children:e.jsx(je,{className:"h-3 w-3"})})]})]})]}),i.description&&e.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:i.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ze,{priority:i.priority,showIcon:!0}),i.assigned_to&&e.jsxs(he,{className:"h-5 w-5",children:[e.jsx(me,{src:i.assigned_to.avatar}),e.jsx(ue,{className:"text-xs",children:(N=i.assigned_to.name)==null?void 0:N.charAt(0)})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:r("Progress")}),e.jsxs("span",{children:[i.progress,"%"]})]}),e.jsx(Pe,{value:i.progress,className:"h-1"})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[!d&&e.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:(B=i.project)==null?void 0:B.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.end_date&&le(i.end_date)&&e.jsxs(G,{variant:"destructive",className:"text-xs",children:[e.jsx(de,{className:"h-3 w-3 mr-1"}),"Overdue"]}),e.jsx("span",{children:i.end_date?new Date(i.end_date).toLocaleDateString():r("No due date")})]})]})]})})})},i.id)}),l.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(Fe,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:r("No tasks")})]})]})]})},s.id)})})]}):A==="card"?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:(be=t==null?void 0:t.data)==null?void 0:be.map(s=>{var l,i;return e.jsxs(oe,{className:"overflow-hidden hover:shadow-md transition-shadow",children:[e.jsxs(Ze,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(We,{className:"text-base line-clamp-1 cursor-pointer hover:text-blue-600 transition-colors",onClick:()=>_("view",s.id),children:s.title}),e.jsx("div",{className:"flex gap-1",children:e.jsx(hs,{task:s,stages:n,variant:"badge"})})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description||r("No description")})]}),e.jsx(xe,{className:"py-2",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:r("Progress")}),e.jsxs("span",{children:[s.progress,"%"]})]}),e.jsx(Pe,{value:s.progress,className:"h-1"})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx(ze,{priority:s.priority,showIcon:!0}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.end_date&&le(s.end_date)&&e.jsxs(G,{variant:"destructive",className:"text-xs",children:[e.jsx(de,{className:"h-3 w-3 mr-1"}),r("Overdue")]}),e.jsx("span",{className:"text-muted-foreground",children:s.end_date?new Date(s.end_date).toLocaleDateString():"No due date"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:s.assigned_to?e.jsxs(O,{children:[e.jsx(V,{asChild:!0,children:e.jsxs(he,{className:"h-6 w-6 cursor-pointer",children:[e.jsx(me,{src:s.assigned_to.avatar}),e.jsx(ue,{className:"text-xs",children:(l=s.assigned_to.name)==null?void 0:l.charAt(0)})]})}),e.jsx(I,{children:s.assigned_to.name})]}):e.jsx("div",{className:"h-6 w-6 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(os,{className:"h-3 w-3 text-gray-400"})})}),!d&&e.jsx("div",{className:"text-xs text-muted-foreground",children:(i=s.project)==null?void 0:i.title})]})]})}),e.jsxs(ke,{className:"flex justify-end gap-1 pt-0 pb-2",children:[e.jsxs(O,{children:[e.jsx(V,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>_("view",s.id),className:"text-blue-500 hover:text-blue-700 h-8 w-8",children:e.jsx(pe,{className:"h-4 w-4"})})}),e.jsx(I,{children:"View"})]}),c!=="client"&&e.jsxs(e.Fragment,{children:[e.jsxs(O,{children:[e.jsx(V,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>_("edit",s.id),className:"text-amber-500 hover:text-amber-700 h-8 w-8",children:e.jsx(ge,{className:"h-4 w-4"})})}),e.jsx(I,{children:"Edit"})]}),e.jsxs(O,{children:[e.jsx(V,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>_("duplicate",s.id),className:"text-green-500 hover:text-green-700 h-8 w-8",children:e.jsx(Me,{className:"h-4 w-4"})})}),e.jsx(I,{children:"Duplicate"})]}),e.jsxs(O,{children:[e.jsx(V,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>_("delete",s.id),className:"text-red-500 hover:text-red-700 h-8 w-8",children:e.jsx(je,{className:"h-4 w-4"})})}),e.jsx(I,{children:"Delete"})]})]})]})]},`card-${s.id}`)})})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("Task")}),!d&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stage"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assignee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progress"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(ye=t==null?void 0:t.data)==null?void 0:ye.map(s=>{var l,i,N,B,T;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 cursor-pointer hover:text-blue-600 transition-colors",onClick:()=>_("view",s.id),children:s.title}),e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:s.description})]})}),!d&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(l=s.project)==null?void 0:l.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(G,{variant:"outline",style:{backgroundColor:((i=s.task_stage)==null?void 0:i.color)+"20",borderColor:(N=s.task_stage)==null?void 0:N.color},children:(B=s.task_stage)==null?void 0:B.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(G,{className:$e(s.priority),variant:"outline",children:s.priority})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.assigned_to?e.jsxs("div",{className:"flex items-center",children:[e.jsxs(he,{className:"h-6 w-6 mr-2",children:[e.jsx(me,{src:s.assigned_to.avatar}),e.jsx(ue,{className:"text-xs",children:(T=s.assigned_to.name)==null?void 0:T.charAt(0)})]}),e.jsx("span",{className:"text-sm",children:s.assigned_to.name})]}):e.jsx("span",{className:"text-sm text-gray-400",children:r("Unassigned")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${s.progress}%`}})}),e.jsxs("span",{className:"text-sm text-gray-900",children:[s.progress,"%"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.end_date&&le(s.end_date)&&e.jsxs(G,{variant:"destructive",className:"text-xs",children:[e.jsx(de,{className:"h-3 w-3 mr-1"}),"Overdue"]}),e.jsx("span",{children:s.end_date?new Date(s.end_date).toLocaleDateString():"No due date"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(O,{children:[e.jsx(V,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>_("view",s.id),className:"text-blue-500 hover:text-blue-700 h-8 w-8",children:e.jsx(pe,{className:"h-4 w-4"})})}),e.jsx(I,{children:"View"})]}),c!=="client"&&e.jsxs(e.Fragment,{children:[e.jsxs(O,{children:[e.jsx(V,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>_("edit",s.id),className:"text-amber-500 hover:text-amber-700 h-8 w-8",children:e.jsx(ge,{className:"h-4 w-4"})})}),e.jsx(I,{children:"Edit"})]}),e.jsxs(O,{children:[e.jsx(V,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>_("duplicate",s.id),className:"text-green-500 hover:text-green-700 h-8 w-8",children:e.jsx(Me,{className:"h-4 w-4"})})}),e.jsx(I,{children:"Duplicate"})]}),e.jsxs(O,{children:[e.jsx(V,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>_("delete",s.id),className:"text-red-500 hover:text-red-700 h-8 w-8",children:e.jsx(je,{className:"h-4 w-4"})})}),e.jsx(I,{children:"Delete"})]})]})]})})]},`table-${s.id}`)})})]})})}),((we=t==null?void 0:t.data)==null?void 0:we.length)===0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx(Fe,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:r("No Tasks Found")}),e.jsx("p",{className:"text-gray-500 mb-4",children:Z()?r("No tasks match your current filters."):r("No tasks have been created yet.")}),Z()?e.jsx(h,{variant:"outline",onClick:ve,children:r("Clear Filters")}):e.jsxs(h,{onClick:()=>{re(null),D(!0)},children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),r("Create your first task")]})]}),(t==null?void 0:t.links)&&A!=="kanban"&&!Array.isArray(t)&&e.jsxs("div",{className:"mt-6 bg-white p-4 rounded-lg shadow flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[r("Showing")," ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.from)||0})," ",r("to")," ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.to)||0})," ",r("of")," ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.total)||0})," ",r("tasks")]}),e.jsx("div",{className:"flex gap-1",children:(_e=t==null?void 0:t.links)==null?void 0:_e.map((s,l)=>{const i=s.label==="&laquo; Previous"||s.label==="Next &raquo;",N=s.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(h,{variant:s.active?"default":"outline",size:i?"sm":"icon",className:i?"px-3":"h-8 w-8",disabled:!s.url,onClick:()=>s.url&&y.get(s.url),children:i?N:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},l)})})]}),L&&e.jsx(es,{task:L,isOpen:q,onClose:()=>{E(!1),S(null)},members:w,stages:n,milestones:((Ce=L.project)==null?void 0:Ce.milestones)||[],permissions:Q}),e.jsx(xs,{isOpen:se,onClose:()=>{D(!1),re(null)},task:$||void 0,projects:C,members:w,milestones:((Se=$==null?void 0:$.project)==null?void 0:Se.milestones)||[]}),e.jsx(ns,{isOpen:Ee,onClose:()=>{te(!1),ie(null)},onConfirm:qe,itemName:(Y==null?void 0:Y.title)||"",entityName:r("task")})]})}export{nr as default};
