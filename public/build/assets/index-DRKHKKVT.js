import{r as u,j as e}from"./ui-Ps9nvBG1.js";import{P as be,L as ve}from"./page-template-BeQadk1c.js";import{u as we,K as Ne,t as o,h as v,P as Se,S as G,I as ye,B as d,e as Y,f as m,C as Ce,a as _e,b as Pe,d as Fe,z as Te,i as S,j as y,k as C}from"./app-BTt_gkO3.js";import{S as Q,a as X,b as Z,c as ee,d as w}from"./select-z0EzYxFC.js";import{C as qe}from"./CrudTable-Dq4zN5Ad.js";import{C as se}from"./CrudFormModal-CIUswiAq.js";import{C as Re}from"./CrudDeleteModal-CAwcbZOF.js";import{u as Le}from"./use-initials-BPIvssA7.js";import{F as Ee}from"./filter-C99mLYzj.js";import{L as ke}from"./list-D1IfOmxs.js";import{E as Me}from"./eye-BGcEqodV.js";import{S as Ue}from"./square-pen-BE6Ef4zh.js";import{K as ze,L as De}from"./lock-open-B07HE5u7.js";import{L as Oe}from"./lock-BlSlbQY6.js";import{T as Ae}from"./trash-2-WsAE_ige.js";import"./vendor-B1hewrmX.js";import"./textarea-DPiv_-Qc.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./chevron-up-CaRG6751.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./clock-NAV_RQL_.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";import"./table-CxFq10cW.js";import"./activity-BmMDIvmq.js";import"./unlink-Da4sYO3X.js";import"./archive-B7y_TeQV.js";import"./minus-CDE_iHiI.js";import"./arrow-left-VMG9JuEa.js";import"./arrow-right-BKcgVE4F.js";import"./code-BqYpr4o9.js";import"./award-Bb-BmrHF.js";import"./indian-rupee-CXBAgLWO.js";import"./webhook-BDBcvkpM.js";import"./building-D7PWBF3-.js";import"./calendar-pZCS8WPy.js";import"./chart-column-CH-40Yjn.js";import"./chevron-left-BAvb6WGn.js";import"./circle-alert-DCoDy4PA.js";import"./circle-check-big-BMYVPbRH.js";import"./circle-check-B5E119oN.js";import"./circle-help-DcK-i_SQ.js";import"./circle-x-BnYRe0cI.js";import"./circle-B-lwSO-9.js";import"./coins-QSIO91L8.js";import"./columns-3-BJflJd0h.js";import"./crown-h0ONqO0b.js";import"./download-FY3rJJBK.js";import"./ellipsis-DhhTm3i6.js";import"./external-link-DZ7-d7Y_.js";import"./eye-off-CBRrilSi.js";import"./instagram-CVFp5Sx_.js";import"./file-3AWHN2l6.js";import"./grip-vertical-1PuRD1LT.js";import"./hard-drive-DkZiK8kb.js";import"./heart-CNQFES80.js";import"./house-Bz__QWIz.js";import"./info-CWa1AAnn.js";import"./key-Z3HmnV2-.js";import"./lightbulb-DQSQ9qNV.js";import"./link-2-pbuNzVBD.js";import"./link-DceUnw3z.js";import"./twitter-CZjBB1-K.js";import"./map-pin-wCNGu7TE.js";import"./menu-BH-rpoiU.js";import"./message-circle-DFnVEf3y.js";import"./monitor-U4qpGUkK.js";import"./wifi-CvP3D_V4.js";import"./paperclip-h_SfHoPk.js";import"./pause-vB4M0M_Y.js";import"./tag-OznyPslI.js";import"./phone-CcborKQC.js";import"./pin-z3kXVgm0.js";import"./play-C9ujj4pR.js";import"./power-DtAmx68i.js";import"./quote-DqGKb1gV.js";import"./send-B0OsKa7V.js";import"./server-CK254A3D.js";import"./shield-D21jpLkF.js";import"./square-DyzuZ8y2.js";import"./star-LRbmONxX.js";import"./sticky-note-BnqKoA0i.js";import"./target-LDs0Bf_v.js";import"./timer-Cde2YpCK.js";import"./toggle-right-uccKRcAk.js";import"./trending-down-CxK3FgOd.js";import"./type-DfB6MBM_.js";import"./user-check-DxK1QmPp.js";import"./user-plus-cb7gLVi3.js";import"./users-ClK0ij4u.js";import"./wallet-CH1oYh2R.js";import"./zap-D5bA-otg.js";import"./radio-group-JdhkNCQh.js";import"./checkbox-ux8-2I9a.js";import"./scroll-area-B8km6OEG.js";function Jr(){var I,V,$,H,K,B,J,W;const{t:r}=we(),{auth:h,users:a,roles:_,planLimits:j,filters:n={},flash:t}=Ne().props,g=(h==null?void 0:h.permissions)||[],k=Le(),[P,M]=u.useState("list"),[p,U]=u.useState(n.search||""),[x,z]=u.useState(n.role||"all"),[F,D]=u.useState(!1),[re,f]=u.useState(!1),[te,T]=u.useState(!1),[ie,q]=u.useState(!1),[c,O]=u.useState(null),[N,R]=u.useState("create");u.useEffect(()=>{t!=null&&t.success&&o.success(t.success),t!=null&&t.error&&o.error(t.error)},[t]);const L=()=>x!=="all"||p!=="",ae=()=>(x!=="all"?1:0)+(p?1:0),oe=s=>{s.preventDefault(),le()},le=()=>{const s={page:1};p&&(s.search=p),x!=="all"&&(s.role=x),n.per_page&&(s.per_page=n.per_page),m.get(route("users.index"),s,{preserveState:!0,preserveScroll:!0})},ne=s=>{z(s);const i={page:1};p&&(i.search=p),s!=="all"&&(i.role=s),n.per_page&&(i.per_page=n.per_page),m.get(route("users.index"),i,{preserveState:!0,preserveScroll:!0})},ce=s=>{const i=n.sort_field===s&&n.sort_direction==="asc"?"desc":"asc",l={sort_field:s,sort_direction:i,page:1};p&&(l.search=p),x!=="all"&&(l.role=x),n.per_page&&(l.per_page=n.per_page),m.get(route("users.index"),l,{preserveState:!0,preserveScroll:!0})},b=(s,i)=>{switch(O(i),s){case"view":R("view"),f(!0);break;case"edit":R("edit"),f(!0);break;case"delete":T(!0);break;case"reset-password":q(!0);break;case"toggle-status":xe(i);break}},de=()=>{O(null),R("create"),f(!0)},me=s=>{s.roles&&Array.isArray(s.roles)&&(s.roles=s.roles[0]),N==="create"?(o.loading(r("Creating user...")),m.post(route("users.store"),s,{onSuccess:()=>{f(!1),o.dismiss(),t!=null&&t.success&&o.success(t.success)},onError:i=>{o.dismiss(),t!=null&&t.error?o.error(t.error):o.error(r("Failed to create user")+`: ${Object.values(i).join(", ")}`)}})):N==="edit"&&(o.loading(r("Updating user...")),m.put(route("users.update",c.id),s,{onSuccess:()=>{f(!1),o.dismiss(),t!=null&&t.success&&o.success(t.success)},onError:i=>{o.dismiss(),t!=null&&t.error?o.error(t.error):o.error(r("Failed to update user")+`: ${Object.values(i).join(", ")}`)}}))},pe=()=>{o.loading(r("Deleting user...")),m.delete(route("users.destroy",c.id),{onSuccess:()=>{T(!1),o.dismiss(),t!=null&&t.success&&o.success(t.success)},onError:s=>{o.dismiss(),t!=null&&t.error?o.error(t.error):o.error(r("Failed to delete user")+`: ${Object.values(s).join(", ")}`)}})},ue=s=>{o.loading(r("Resetting password...")),m.put(route("users.reset-password",c.id),s,{onSuccess:()=>{q(!1),o.dismiss(),t!=null&&t.success&&o.success(t.success)},onError:i=>{o.dismiss(),t!=null&&t.error?o.error(t.error):o.error(r("Failed to reset password")+`: ${Object.values(i).join(", ")}`)}})},xe=s=>{const i=s.status==="active"?"inactive":"active";o.loading(`${r(i==="active"?"Activating":"Deactivating")} ${r("user")}...`),m.put(route("users.toggle-status",s.id),{},{onSuccess:()=>{o.dismiss(),t!=null&&t.success&&o.success(t.success)},onError:l=>{o.dismiss(),t!=null&&t.error?o.error(t.error):o.error(r("Failed to update user status")+`: ${Object.values(l).join(", ")}`)}})},he=()=>{z("all"),U(""),D(!1),m.get(route("users.index"),{page:1,per_page:n.per_page},{preserveState:!0,preserveScroll:!0})},A=[];if(v(g,"create-users")){const s=!j||j.can_create;A.push({label:j&&!s?r("User Limit Reached ({{current}}/{{max}})",{current:j.current_users,max:j.max_users}):r("Add User"),icon:e.jsx(Se,{className:"h-4 w-4 mr-2"}),variant:s?"default":"outline",onClick:s?()=>de():()=>o.error(r("User limit exceeded. Your plan allows maximum {{max}} users. Please upgrade your plan.",{max:j.max_users})),disabled:!s})}const ge=[{title:r("Dashboard"),href:route("dashboard")},{title:r("User Management"),href:route("users.index")},{title:((I=h.user)==null?void 0:I.type)==="superadmin"?r("All Users"):((V=h.user)==null?void 0:V.type)==="client"?r("My Profile"):r("Workspace Users")}],je=[{key:"name",label:r("Name"),sortable:!0,render:(s,i)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-primary text-white",children:k(i.name)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:i.email})]})]})},{key:"roles",label:r("Roles"),render:s=>!s||!s.length?e.jsx("span",{className:"text-muted-foreground",children:r("No roles assigned")}):s.map(i=>e.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10 mr-1",children:i.label||i.name},i.id))},{key:"created_at",label:r("Joined"),sortable:!0,render:s=>{var i;return((i=window.appSettings)==null?void 0:i.formatDateTime(s,!1))||new Date(s).toLocaleDateString()}}],fe=[{label:r("View"),icon:"Eye",action:"view",className:"text-blue-500",requiredPermission:"view-users"},{label:r("Edit"),icon:"Edit",action:"edit",className:"text-amber-500",requiredPermission:"edit-users"},{label:r("Reset Password"),icon:"KeyRound",action:"reset-password",className:"text-blue-500",requiredPermission:"reset-password-users"},{label:r("Toggle Status"),icon:"Lock",action:"toggle-status",className:"text-amber-500",requiredPermission:"toggle-status-users"},{label:r("Delete"),icon:"Trash2",action:"delete",className:"text-red-500",requiredPermission:"delete-users"}];return e.jsxs(be,{title:(($=h.user)==null?void 0:$.type)==="superadmin"?r("Users Management"):((H=h.user)==null?void 0:H.type)==="client"?r("My Profile"):r("Workspace Users"),url:"/users",actions:A,breadcrumbs:ge,noPadding:!0,children:[e.jsx("div",{className:"bg-white rounded-lg shadow mb-4",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("form",{onSubmit:oe,className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-64",children:[e.jsx(G,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ye,{placeholder:r("Search users..."),value:p,onChange:s=>U(s.target.value),className:"w-full pl-9"})]}),e.jsxs(d,{type:"submit",size:"sm",children:[e.jsx(G,{className:"h-4 w-4 mr-1.5"}),r("Search")]})]}),e.jsx("div",{className:"ml-2",children:e.jsxs(d,{variant:L()?"default":"outline",size:"sm",className:"h-8 px-2 py-1",onClick:()=>D(!F),children:[e.jsx(Ee,{className:"h-3.5 w-3.5 mr-1.5"}),r(F?"Hide Filters":"Filters"),L()&&e.jsx("span",{className:"ml-1 bg-primary-foreground text-primary rounded-full w-5 h-5 flex items-center justify-center text-xs",children:ae()})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"border rounded-md p-0.5 mr-2",children:[e.jsx(d,{size:"sm",variant:P==="list"?"default":"ghost",className:"h-7 px-2",onClick:()=>M("list"),children:e.jsx(ke,{className:"h-4 w-4"})}),e.jsx(d,{size:"sm",variant:P==="grid"?"default":"ghost",className:"h-7 px-2",onClick:()=>M("grid"),children:e.jsx(ve,{className:"h-4 w-4"})})]}),e.jsx(Y,{className:"text-xs text-muted-foreground",children:r("Per Page:")}),e.jsxs(Q,{value:((K=n.per_page)==null?void 0:K.toString())||"10",onValueChange:s=>{const i={page:1,per_page:parseInt(s)};p&&(i.search=p),x!=="all"&&(i.role=x),m.get(route("users.index"),i,{preserveState:!0,preserveScroll:!0})},children:[e.jsx(X,{className:"w-16 h-8",children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(w,{value:"10",children:"10"}),e.jsx(w,{value:"25",children:"25"}),e.jsx(w,{value:"50",children:"50"}),e.jsx(w,{value:"100",children:"100"})]})]})]})]}),F&&e.jsx("div",{className:"w-full mt-3 p-4 bg-gray-50 border rounded-md",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{children:r("Role")}),e.jsxs(Q,{value:x,onValueChange:ne,children:[e.jsx(X,{className:"w-40",children:e.jsx(Z,{placeholder:r("All Roles")})}),e.jsxs(ee,{children:[e.jsx(w,{value:"all",children:r("All Roles")}),_&&_.map(s=>e.jsx(w,{value:s.id.toString(),children:s.label||s.name},s.id))]})]})]}),e.jsx(d,{variant:"outline",size:"sm",className:"h-9",onClick:he,disabled:!L(),children:r("Reset Filters")})]})})]})}),P==="list"?e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx(qe,{columns:je,actions:fe,data:(a==null?void 0:a.data)||[],from:(a==null?void 0:a.from)||1,onAction:b,sortField:n.sort_field,sortDirection:n.sort_direction,onSort:ce,permissions:g,entityPermissions:{view:"view-users",create:"create-users",edit:"edit-users",delete:"delete-users"}}),e.jsxs("div",{className:"p-4 border-t flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[r("Showing")," ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.from)||0})," ",r("to")," ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.to)||0})," ",r("of")," ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.total)||0})," ",r("users")]}),e.jsx("div",{className:"flex gap-1",children:(B=a==null?void 0:a.links)==null?void 0:B.map((s,i)=>{const l=s.label==="&laquo; Previous"||s.label==="Next &raquo;",E=s.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(d,{variant:s.active?"default":"outline",size:l?"sm":"icon",className:l?"px-3":"h-8 w-8",disabled:!s.url,onClick:()=>s.url&&m.get(s.url),children:l?E:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},i)})})]})]}):e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:(J=a==null?void 0:a.data)==null?void 0:J.map(s=>{var i;return e.jsxs(Ce,{className:"overflow-hidden",children:[e.jsx(_e,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-primary text-white flex items-center justify-center",children:k(s.name)}),e.jsxs("div",{children:[e.jsx(Pe,{className:"text-base",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email})]})]})}),e.jsx(Fe,{className:"py-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex flex-wrap gap-1",children:s.roles&&s.roles.length>0?s.roles.map(l=>e.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10",children:l.label||l.name},l.id)):e.jsx("span",{className:"text-muted-foreground text-xs",children:r("No role")})}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[r("Joined:")," ",((i=window.appSettings)==null?void 0:i.formatDateTime(s.created_at,!1))||new Date(s.created_at).toLocaleDateString()]})]})}),e.jsxs(Te,{className:"flex justify-end gap-1 pt-0 pb-2",children:[v(g,"view-users")&&e.jsxs(S,{children:[e.jsx(y,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>b("view",s),className:"text-blue-500 hover:text-blue-700",children:e.jsx(Me,{className:"h-4 w-4"})})}),e.jsx(C,{children:r("View")})]}),v(g,"edit-users")&&e.jsxs(S,{children:[e.jsx(y,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>b("edit",s),className:"text-amber-500 hover:text-amber-700",children:e.jsx(Ue,{className:"h-4 w-4"})})}),e.jsx(C,{children:r("Edit")})]}),v(g,"edit-users")&&e.jsxs(S,{children:[e.jsx(y,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>b("reset-password",s),className:"text-blue-500 hover:text-blue-700",children:e.jsx(ze,{className:"h-4 w-4"})})}),e.jsx(C,{children:r("Reset Password")})]}),v(g,"edit-users")&&e.jsxs(S,{children:[e.jsx(y,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>b("toggle-status",s),className:"text-amber-500 hover:text-amber-700",children:s.status==="active"?e.jsx(Oe,{className:"h-4 w-4"}):e.jsx(De,{className:"h-4 w-4"})})}),e.jsx(C,{children:s.status==="active"?r("Disable User"):r("Enable User")})]}),v(g,"delete-users")&&e.jsxs(S,{children:[e.jsx(y,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700",onClick:()=>b("delete",s),children:e.jsx(Ae,{className:"h-4 w-4"})})}),e.jsx(C,{children:r("Delete")})]})]})]},s.id)})}),e.jsxs("div",{className:"mt-6 bg-white p-4 rounded-lg shadow flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[r("Showing")," ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.from)||0})," ",r("to")," ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.to)||0})," ",r("of")," ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.total)||0})," ",r("users")]}),e.jsx("div",{className:"flex gap-1",children:(W=a==null?void 0:a.links)==null?void 0:W.map((s,i)=>{const l=s.label==="&laquo; Previous"||s.label==="Next &raquo;",E=s.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(d,{variant:s.active?"default":"outline",size:l?"sm":"icon",className:l?"px-3":"h-8 w-8",disabled:!s.url,onClick:()=>s.url&&m.get(s.url),children:l?E:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},i)})})]})]}),e.jsx(se,{isOpen:re,onClose:()=>f(!1),onSubmit:me,formConfig:{fields:[{name:"name",label:r("Name"),type:"text",required:!0},{name:"email",label:r("Email"),type:"email",required:!0},{name:"password",label:r("Password"),type:"password",required:!0,conditional:s=>s==="create"},{name:"password_confirmation",label:r("Confirm Password"),type:"password",required:!0,conditional:s=>s==="create"},{name:"roles",label:r("Role"),type:"select",options:_?_.map(s=>({value:s.id.toString(),label:s.label||s.name})):[],required:!0}],modalSize:"lg"},initialData:c?{...c,roles:c.roles&&c.roles.length>0?c.roles[0].id.toString():""}:null,title:r(N==="create"?"Add New User":N==="edit"?"Edit User":"View User"),mode:N}),e.jsx(Re,{isOpen:te,onClose:()=>T(!1),onConfirm:pe,itemName:(c==null?void 0:c.name)||"",entityName:"user"}),e.jsx(se,{isOpen:ie,onClose:()=>q(!1),onSubmit:ue,formConfig:{fields:[{name:"password",label:r("New Password"),type:"password",required:!0},{name:"password_confirmation",label:r("Confirm Password"),type:"password",required:!0}],modalSize:"sm"},initialData:{},title:r("Reset Password for")+` ${(c==null?void 0:c.name)||r("User")}`,mode:"edit"})]})}export{Jr as default};
