import{r as d,j as e}from"./ui-Ps9nvBG1.js";import{P as V}from"./page-template-BeQadk1c.js";import{u as F,K,S as C,I as G,B as p,e as J,f as h,D as Q,l as W,n as X,o as Y,E as Z}from"./app-BTt_gkO3.js";import{S as H,a as ee,b as se,c as ae,d as i}from"./select-z0EzYxFC.js";import{E as re}from"./eye-BGcEqodV.js";import"./vendor-B1hewrmX.js";import"./textarea-DPiv_-Qc.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./chevron-up-CaRG6751.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./clock-NAV_RQL_.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";function Ee(){var j,u,N,b,f,v,w,S,k,U,_,D,L,T,I,P;const{t:a}=F(),{loginHistories:l,filters:o={}}=K().props,[m,z]=d.useState(o.search||""),[t,A]=d.useState(null),[E,y]=d.useState(!1),[R,g]=d.useState(!1),O=s=>{s.preventDefault(),h.get(route("users.all-logs"),{search:m,per_page:o.per_page||10})},$=async s=>{g(!0);try{const r=await Z.get(route("login-histories.show",s));A(r.data.loginHistory),y(!0)}catch(r){console.error("Failed to fetch login history details:",r)}finally{g(!1)}},q=[{title:a("Dashboard"),href:route("dashboard")},{title:a("User Management")},{title:a("All User Logs")}],M=s=>{if(!s)return"Unknown";const r=[];return s.city&&s.city!=="Unknown"&&r.push(s.city),s.regionName&&s.regionName!=="Unknown"&&r.push(s.regionName),s.country&&s.country!=="Unknown"&&r.push(s.country),r.length>0?r.join(", "):"Unknown"},B=s=>{if(!s)return"Unknown";const r=s.browser_name||"Unknown",n=s.os_name||"Unknown",c=s.device_type||"desktop";return`${r} on ${n} (${c})`},x=[{key:"user",label:a("User"),render:(s,r)=>{var n,c;return e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:((n=r.user)==null?void 0:n.name)||"Unknown User"}),e.jsx("div",{className:"text-sm text-gray-500",children:((c=r.user)==null?void 0:c.email)||"No email"})]})}},{key:"ip",label:a("IP Address"),render:s=>e.jsx("span",{className:"text-gray-900",children:s})},{key:"location_device",label:a("Location & Device"),render:(s,r)=>e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-900",children:M(r.details)}),e.jsx("div",{className:"text-sm text-gray-500",children:B(r.details)})]})},{key:"type",label:a("Role"),render:s=>e.jsx("span",{className:"text-gray-900",children:s})},{key:"created_at",label:a("Time"),render:s=>e.jsx("span",{className:"text-gray-900",children:new Date(s).toLocaleString()})}];return e.jsxs(V,{title:a("All User Logs"),breadcrumbs:q,noPadding:!0,children:[e.jsx("div",{className:"bg-white rounded-lg shadow mb-4",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("form",{onSubmit:O,className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-64",children:[e.jsx(C,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(G,{placeholder:a("Search users, emails, IPs..."),value:m,onChange:s=>z(s.target.value),className:"w-full pl-9"})]}),e.jsxs(p,{type:"submit",size:"sm",children:[e.jsx(C,{className:"h-4 w-4 mr-1.5"}),a("Search")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"text-xs text-muted-foreground",children:a("Per Page:")}),e.jsxs(H,{value:((j=o.per_page)==null?void 0:j.toString())||"10",onValueChange:s=>{h.get(route("users.all-logs"),{search:m,per_page:parseInt(s)})},children:[e.jsx(ee,{className:"w-16 h-8",children:e.jsx(se,{})}),e.jsxs(ae,{children:[e.jsx(i,{value:"10",children:"10"}),e.jsx(i,{value:"25",children:"25"}),e.jsx(i,{value:"50",children:"50"}),e.jsx(i,{value:"100",children:"100"})]})]})]})]})})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[x.map(s=>e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-500",children:s.label},s.key)),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-500",children:a("Actions")})]})}),e.jsxs("tbody",{children:[(u=l==null?void 0:l.data)==null?void 0:u.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[x.map(r=>e.jsx("td",{className:"px-4 py-3",children:r.render?r.render(s[r.key],s):s[r.key]},`${s.id}-${r.key}`)),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx(p,{variant:"ghost",size:"icon",className:"text-blue-500 hover:text-blue-700",onClick:()=>$(s.id),disabled:R,children:e.jsx(re,{className:"h-4 w-4"})})})]},s.id)),(!(l!=null&&l.data)||l.data.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:x.length+1,className:"px-4 py-8 text-center text-gray-500",children:a("No login histories found")})})]})]})}),e.jsxs("div",{className:"p-4 border-t flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[a("Showing")," ",e.jsx("span",{className:"font-medium",children:(l==null?void 0:l.from)||0})," ",a("to")," ",e.jsx("span",{className:"font-medium",children:(l==null?void 0:l.to)||0})," ",a("of")," ",e.jsx("span",{className:"font-medium",children:(l==null?void 0:l.total)||0})," ",a("results")]}),e.jsx("div",{className:"flex gap-1",children:(N=l==null?void 0:l.links)==null?void 0:N.map((s,r)=>{const n=s.label==="&laquo; Previous"||s.label==="Next &raquo;",c=s.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(p,{variant:s.active?"default":"outline",size:n?"sm":"icon",className:n?"px-3":"h-8 w-8",disabled:!s.url,onClick:()=>s.url&&h.get(s.url),children:n?c:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},r)})})]})]}),e.jsx(Q,{open:E,onOpenChange:y,children:e.jsxs(W,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(X,{children:e.jsx(Y,{className:"flex items-center gap-2",children:a("Login Details")})}),t&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"w-full text-sm border-collapse",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("User Name")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:((b=t.user)==null?void 0:b.name)||"Unknown"})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Email")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:((f=t.user)==null?void 0:f.email)||"No email"})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Role")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:t.type})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Login Time")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:new Date(t.created_at).toLocaleString()})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("IP Address")}),e.jsx("td",{className:"py-2 px-3 text-gray-900 font-mono",children:t.ip})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Country")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:((v=t.details)==null?void 0:v.country)||"Unknown"})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Region")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:((w=t.details)==null?void 0:w.regionName)||"Unknown"})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("City")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:((S=t.details)==null?void 0:S.city)||"Unknown"})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Browser")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:((k=t.details)==null?void 0:k.browser_name)||"Unknown"})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Operating System")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:((U=t.details)==null?void 0:U.os_name)||"Unknown"})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Device Type")}),e.jsx("td",{className:"py-2 px-3 text-gray-900 capitalize",children:((_=t.details)==null?void 0:_.device_type)||"Desktop"})]}),((D=t.details)==null?void 0:D.timezone)&&e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Timezone")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:t.details.timezone})]}),((L=t.details)==null?void 0:L.isp)&&e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("ISP")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:t.details.isp})]}),((T=t.details)==null?void 0:T.org)&&e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Organization")}),e.jsx("td",{className:"py-2 px-3 text-gray-900",children:t.details.org})]}),((I=t.details)==null?void 0:I.referrer_host)&&e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Referrer Host")}),e.jsx("td",{className:"py-2 px-3 text-gray-900 font-mono",children:t.details.referrer_host})]}),((P=t.details)==null?void 0:P.referrer_path)&&e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 px-3 font-medium text-gray-600 bg-gray-50",children:a("Referrer Path")}),e.jsx("td",{className:"py-2 px-3 text-gray-900 font-mono break-all",children:t.details.referrer_path})]})]})})})})]})})]})}export{Ee as default};
