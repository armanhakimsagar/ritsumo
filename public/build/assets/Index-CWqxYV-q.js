import{r as n,j as e}from"./ui-Ps9nvBG1.js";import{u as Se,K as Ce,t as o,P as ie,S as ce,I as _e,f as m,B as c,e as z,C as ke,a as Ae,b as Ee,g as de,d as Te,z as De,i as f,j as v,k as w}from"./app-BTt_gkO3.js";import{S as F,a as I,b as L,c as M,d as g}from"./select-z0EzYxFC.js";import{P as ze,L as Fe,A as ne,c as oe,a as me,R as Ie}from"./page-template-BeQadk1c.js";import{E as Le}from"./ExpenseFormModal-B2iwCfiU.js";import{E as Me}from"./EnhancedDeleteModal-BUN-gSW9.js";import{F as qe}from"./filter-C99mLYzj.js";import{L as Re}from"./list-D1IfOmxs.js";import{C as Ve}from"./calendar-pZCS8WPy.js";import{E as xe}from"./eye-BGcEqodV.js";import{S as he}from"./square-pen-BE6Ef4zh.js";import{C as ue}from"./trending-up-BkxnV74k.js";import{T as je}from"./trash-2-WsAE_ige.js";import{C as Be}from"./clock-NAV_RQL_.js";import{C as $e}from"./circle-alert-DCoDy4PA.js";import{C as Oe}from"./circle-x-BnYRe0cI.js";import{C as Pe}from"./circle-check-big-BMYVPbRH.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";import"./textarea-DPiv_-Qc.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";function Lt(){var J,Q,Y,Z,ee,te,se,ae,re;const{t:i}=Se(),{expenses:s,projects:y,categories:k,filters:l,auth:Ue,project_name:pe,userWorkspaceRole:He,workspace:A,budget_id:Ge,flash:x,permissions:ge}=Ce().props,r=ge;n.useEffect(()=>{x!=null&&x.success&&o.success(x.success),x!=null&&x.error&&o.error(x.error)},[x]);const S=pe||(l!=null&&l.project_id?(J=y==null?void 0:y.find(t=>t.id.toString()===l.project_id.toString()))==null?void 0:J.title:null),[E,q]=n.useState("grid"),[h,R]=n.useState((l==null?void 0:l.search)||""),[u,V]=n.useState((l==null?void 0:l.project_id)||"all"),[j,B]=n.useState((l==null?void 0:l.category_id)||"all"),[p,$]=n.useState((l==null?void 0:l.status)||"all"),[O,P]=n.useState(!1),[Ne,T]=n.useState(!1),[fe,U]=n.useState(null),[ve,H]=n.useState("create"),[d,_]=n.useState(null),we=t=>{t.preventDefault(),ye()},ye=()=>{const t={page:1};h&&(t.search=h),u!=="all"&&(t.project_id=u),j!=="all"&&(t.category_id=j),p!=="all"&&(t.status=p),m.get(route("expenses.index"),t,{preserveState:!0,preserveScroll:!0})},N=(t,a)=>{switch(t){case"view":m.get(route("expenses.show",a.id));break;case"edit":U(a),H("edit"),T(!0);break;case"duplicate":o.loading("Duplicating expense..."),m.post(route("expenses.duplicate",a.id),{},{onSuccess:()=>{o.dismiss()},onError:()=>{o.dismiss(),o.error("Failed to duplicate expense")}});break;case"delete":_(a);break}},G=()=>{U(null),H("create"),T(!0)},K=t=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",requires_info:"bg-blue-100 text-blue-800"})[t]||"bg-gray-100 text-gray-800",W=t=>{switch(t){case"approved":return e.jsx(Pe,{className:"h-4 w-4 text-green-600"});case"rejected":return e.jsx(Oe,{className:"h-4 w-4 text-red-600"});case"requires_info":return e.jsx($e,{className:"h-4 w-4 text-blue-600"});default:return e.jsx(Be,{className:"h-4 w-4 text-yellow-600"})}},C=t=>{var a;if(typeof window<"u"&&((a=window.appSettings)!=null&&a.formatCurrency)){const b=typeof t=="number"?t:parseFloat(t)||0;return window.appSettings.formatCurrency(b,{showSymbol:!0})}return t||0},X=[];r!=null&&r.create&&X.push({label:i("Add Expense"),icon:e.jsx(ie,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:G});const be=[{title:i("Dashboard"),href:route("dashboard")},{title:i("Budget & Expenses")},...S?[{title:i("Projects"),href:route("projects.index")},{title:i("Budgets"),href:route("budgets.index")}]:[],{title:S?`${S} - Expenses`:"Expenses"}];return e.jsxs(ze,{title:S?`${S} - Expense Management`:"Expense Management",url:"/expenses",actions:X,breadcrumbs:be,noPadding:!0,children:[e.jsx("div",{className:"bg-white rounded-lg shadow mb-4 p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(s==null?void 0:s.total)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:i("Total Expenses")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:((Q=s==null?void 0:s.data)==null?void 0:Q.filter(t=>t.status==="pending").length)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:i("Pending")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:((Y=s==null?void 0:s.data)==null?void 0:Y.filter(t=>t.status==="approved").length)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:i("Approved")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:((Z=s==null?void 0:s.data)==null?void 0:Z.filter(t=>t.status==="rejected").length)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:i("Rejected")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:(()=>{var a;if(!(s!=null&&s.data)||s.data.length===0)return C(0);const t=s.data.reduce((b,D)=>{var le;return b+(parseFloat((le=D.amount)==null?void 0:le.toString())||0)},0);return A!=null&&A.currency||(a=s.data[0])!=null&&a.currency,C(t)})()}),e.jsx("div",{className:"text-sm text-gray-600",children:i("Total Amount")})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow mb-4",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("form",{onSubmit:we,className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-64",children:[e.jsx(ce,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(_e,{placeholder:i("Search expenses..."),value:h,onChange:t=>{R(t.target.value),clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{const a={page:1};t.target.value&&(a.search=t.target.value),u!=="all"&&(a.project_id=u),j!=="all"&&(a.category_id=j),p!=="all"&&(a.status=p),m.get(route("expenses.index"),a,{preserveState:!0,preserveScroll:!0})},500)},className:"w-full pl-9"})]}),e.jsxs(c,{type:"submit",size:"sm",children:[e.jsx(ce,{className:"h-4 w-4 mr-1.5"}),i("Search")]})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>P(!O),children:[e.jsx(qe,{className:"h-4 w-4 mr-1.5"}),i("Filters")]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"border rounded-md p-0.5",children:[e.jsx(c,{size:"sm",variant:E==="list"?"default":"ghost",className:"h-7 px-2",onClick:()=>q("list"),children:e.jsx(Re,{className:"h-4 w-4"})}),e.jsx(c,{size:"sm",variant:E==="grid"?"default":"ghost",className:"h-7 px-2",onClick:()=>q("grid"),children:e.jsx(Fe,{className:"h-4 w-4"})})]})})]}),O&&e.jsx("div",{className:"p-4 bg-gray-50 border rounded-md",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Project"}),e.jsxs(F,{value:u,onValueChange:t=>{V(t);const a={page:1};h&&(a.search=h),t!=="all"&&(a.project_id=t),j!=="all"&&(a.category_id=j),p!=="all"&&(a.status=p),m.get(route("expenses.index"),a,{preserveState:!0,preserveScroll:!0})},children:[e.jsx(I,{className:"w-40",children:e.jsx(L,{placeholder:"All Projects"})}),e.jsxs(M,{children:[e.jsx(g,{value:"all",children:"All"}),y==null?void 0:y.map(t=>e.jsx(g,{value:t.id.toString(),children:t.title},t.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Category"}),e.jsxs(F,{value:j,onValueChange:t=>{B(t);const a={page:1};h&&(a.search=h),u!=="all"&&(a.project_id=u),t!=="all"&&(a.category_id=t),p!=="all"&&(a.status=p),m.get(route("expenses.index"),a,{preserveState:!0,preserveScroll:!0})},children:[e.jsx(I,{className:"w-40",children:e.jsx(L,{placeholder:"All Categories"})}),e.jsxs(M,{children:[e.jsx(g,{value:"all",children:"All"}),k==null?void 0:k.map(t=>e.jsx(g,{value:t.id.toString(),children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Status"}),e.jsxs(F,{value:p,onValueChange:t=>{$(t);const a={page:1};h&&(a.search=h),u!=="all"&&(a.project_id=u),j!=="all"&&(a.category_id=j),t!=="all"&&(a.status=t),m.get(route("expenses.index"),a,{preserveState:!0,preserveScroll:!0})},children:[e.jsx(I,{className:"w-40",children:e.jsx(L,{placeholder:"All Status"})}),e.jsxs(M,{children:[e.jsx(g,{value:"all",children:"All"}),e.jsx(g,{value:"pending",children:"Pending"}),e.jsx(g,{value:"approved",children:"Approved"}),e.jsx(g,{value:"rejected",children:"Rejected"}),e.jsx(g,{value:"requires_info",children:"Requires Info"})]})]})]}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>{V("all"),B("all"),$("all"),R(""),P(!1),m.get(route("expenses.index"),{page:1},{preserveState:!0,preserveScroll:!0})},children:"Reset Filters"})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow",children:E==="grid"?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:(ee=s==null?void 0:s.data)==null?void 0:ee.map(t=>{var a;return e.jsxs(ke,{className:"overflow-hidden hover:shadow-md transition-shadow",children:[e.jsxs(Ae,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(Ee,{className:"text-base line-clamp-1",children:t.title}),e.jsxs("div",{className:"flex items-center gap-1",children:[W(t.status),e.jsx(de,{className:K(t.status),variant:"secondary",children:t.status.replace("_"," ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:C(t.amount)}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:t.project.title})]})]}),e.jsx(Te,{className:"py-2",children:e.jsxs("div",{className:"space-y-3",children:[t.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"h-3 w-3"}),e.jsx("span",{children:new Date(t.expense_date).toLocaleDateString()})]}),t.budget_category&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.budget_category.color}}),e.jsx("span",{children:t.budget_category.name})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ne,{className:"h-6 w-6",children:[e.jsx(oe,{src:t.submitter.avatar}),e.jsx(me,{className:"text-xs",children:(a=t.submitter.name)==null?void 0:a.charAt(0)})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.submitter.name})]}),t.vendor&&e.jsx("span",{className:"text-xs text-muted-foreground",children:t.vendor})]})]})}),e.jsxs(De,{className:"flex justify-end gap-1 pt-0 pb-2",children:[e.jsxs(f,{children:[e.jsx(v,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>N("view",t),className:"text-blue-500 hover:text-blue-700 h-8 w-8",children:e.jsx(xe,{className:"h-4 w-4"})})}),e.jsx(w,{children:"View"})]}),(r==null?void 0:r.update)&&e.jsxs(f,{children:[e.jsx(v,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>N("edit",t),className:"text-amber-500 hover:text-amber-700 h-8 w-8",children:e.jsx(he,{className:"h-4 w-4"})})}),e.jsx(w,{children:"Edit"})]}),(r==null?void 0:r.create)&&e.jsxs(f,{children:[e.jsx(v,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>N("duplicate",t),className:"text-green-500 hover:text-green-700 h-8 w-8",children:e.jsx(ue,{className:"h-4 w-4"})})}),e.jsx(w,{children:"Duplicate"})]}),(r==null?void 0:r.delete)&&e.jsxs(f,{children:[e.jsx(v,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700 h-8 w-8",onClick:()=>N("delete",t),children:e.jsx(je,{className:"h-4 w-4"})})}),e.jsx(w,{children:"Delete"})]})]})]},t.id)})})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expense"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project & Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitter"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(te=s==null?void 0:s.data)==null?void 0:te.map(t=>{var a;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.title}),t.description&&e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:t.description})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:C(t.amount)}),t.vendor&&e.jsx("div",{className:"text-sm text-gray-500",children:t.vendor})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.project.title}),t.budget_category?e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:t.budget_category.color}}),e.jsx("span",{className:"text-xs text-gray-500",children:t.budget_category.name})]}):e.jsx("span",{className:"text-xs text-gray-400 mt-1 block",children:"Uncategorized"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[W(t.status),e.jsx(de,{className:K(t.status),variant:"secondary",children:t.status.replace("_"," ")})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ne,{className:"h-6 w-6",children:[e.jsx(oe,{src:t.submitter.avatar}),e.jsx(me,{className:"text-xs",children:(a=t.submitter.name)==null?void 0:a.charAt(0)})]}),e.jsx("span",{className:"text-sm",children:t.submitter.name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(t.expense_date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(f,{children:[e.jsx(v,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>N("view",t),className:"text-blue-500 hover:text-blue-700 h-8 w-8",children:e.jsx(xe,{className:"h-4 w-4"})})}),e.jsx(w,{children:"View"})]}),(r==null?void 0:r.update)&&e.jsxs(f,{children:[e.jsx(v,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>N("edit",t),className:"text-amber-500 hover:text-amber-700 h-8 w-8",children:e.jsx(he,{className:"h-4 w-4"})})}),e.jsx(w,{children:"Edit"})]}),(r==null?void 0:r.create)&&e.jsxs(f,{children:[e.jsx(v,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>N("duplicate",t),className:"text-green-500 hover:text-green-700 h-8 w-8",children:e.jsx(ue,{className:"h-4 w-4"})})}),e.jsx(w,{children:"Duplicate"})]}),(r==null?void 0:r.delete)&&e.jsxs(f,{children:[e.jsx(v,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700 h-8 w-8",onClick:()=>N("delete",t),children:e.jsx(je,{className:"h-4 w-4"})})}),e.jsx(w,{children:"Delete"})]})]})})]},t.id)})})]})})}),(s==null?void 0:s.links)&&((se=s.data)==null?void 0:se.length)>0&&e.jsxs("div",{className:"mt-6 bg-white p-4 rounded-lg shadow flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.from)||0})," to ",e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.to)||0})," of ",e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.total)||0})," expenses"]}),e.jsx("div",{className:"flex gap-1",children:(ae=s==null?void 0:s.links)==null?void 0:ae.map((t,a)=>{const b=t.label==="&laquo; Previous"||t.label==="Next &raquo;",D=t.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(c,{variant:t.active?"default":"outline",size:b?"sm":"icon",className:b?"px-3":"h-8 w-8",disabled:!t.url,onClick:()=>t.url&&m.get(t.url),children:b?D:e.jsx("span",{dangerouslySetInnerHTML:{__html:t.label}})},a)})})]}),((re=s==null?void 0:s.data)==null?void 0:re.length)===0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx(Ie,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500 mb-4",children:i("No expenses found")}),(r==null?void 0:r.create)&&e.jsxs(c,{onClick:G,children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),i("Add your first expense")]})]}),e.jsx(Le,{isOpen:Ne,onClose:()=>T(!1),expense:fe,projects:y,mode:ve,redirectUrl:route("expenses.index")}),e.jsx(Me,{isOpen:!!d,onClose:()=>_(null),onConfirm:()=>{d&&(o.loading("Deleting expense..."),m.delete(route("expenses.destroy",d.id),{onSuccess:()=>{o.dismiss(),_(null)},onError:()=>{o.dismiss(),o.error("Failed to delete expense"),_(null)}}))},itemName:(d==null?void 0:d.title)||"",entityName:"Expense",additionalInfo:[`Amount: ${d?C(d.amount):""}`,`Project: ${(d==null?void 0:d.project.title)||""}`,`Date: ${d?new Date(d.expense_date).toLocaleDateString():""}`]})]})}export{Lt as default};
