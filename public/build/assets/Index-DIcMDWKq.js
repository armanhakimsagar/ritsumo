import{r as d,j as e}from"./ui-Ps9nvBG1.js";import{u as oe,K as de,t as f,P as U,S as $,I as xe,B as i,e as G,f as v,C as me,a as he,b as pe,g as K,d as je,i as x,j as m,k as h,z as ue}from"./app-BTt_gkO3.js";import{S as W,a as J,b as Q,c as X,d as j}from"./select-z0EzYxFC.js";import{P as fe}from"./progress-B213Sqsa.js";import{P as Ne,L as ve}from"./page-template-BeQadk1c.js";import{B as we}from"./BudgetFormModal-CUZ0F7FS.js";import{C as ge}from"./CrudDeleteModal-CAwcbZOF.js";import{F as ye}from"./filter-C99mLYzj.js";import{L as Ce}from"./list-D1IfOmxs.js";import{T as Se}from"./triangle-alert-BuDHDWvi.js";import{E as Y}from"./eye-BGcEqodV.js";import{S as Z}from"./square-pen-BE6Ef4zh.js";import{T as ee}from"./trash-2-WsAE_ige.js";import{D as be}from"./dollar-sign-CY6xo33T.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";import"./textarea-DPiv_-Qc.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./clock-NAV_RQL_.js";import"./credit-card-BwPrmecT.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./use-favicon-vjALIuby.js";function hs(){var I,L,V,O,R,H,P;const{t:o}=oe(),{budgets:t,auth:ze,userWorkspaceRole:_e,flash:c,permissions:se}=de().props,r=se;d.useEffect(()=>{c!=null&&c.success&&f.success(c.success),c!=null&&c.error&&f.error(c.error),c!=null&&c.info&&f.info(c.info)},[c]);const[y,_]=d.useState("grid"),[w,k]=d.useState(""),[g,T]=d.useState("all"),[F,B]=d.useState(!1),[te,S]=d.useState(!1),[ae,C]=d.useState(!1),[N,b]=d.useState(null),[re,M]=d.useState("create"),le=s=>{s.preventDefault(),ie()},ie=()=>{const s={page:1};w&&(s.search=w),g!=="all"&&(s.status=g),v.get(route("budgets.index"),s,{preserveState:!0,preserveScroll:!0})},p=(s,a)=>{switch(b(a),s){case"view":v.get(route("budgets.show",a.id));break;case"edit":M("edit"),S(!0);break;case"delete":C(!0);break}},A=()=>{b(null),M("create"),S(!0)},ce=()=>{N&&(f.loading("Deleting budget..."),v.delete(route("budgets.destroy",N.id),{onSuccess:()=>{f.dismiss(),C(!1)},onError:()=>{f.dismiss(),f.error("Failed to delete budget"),C(!1)}}))},D=s=>({active:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",q=s=>s>=90?"text-red-600":s>=75?"text-yellow-600":"text-green-600",u=s=>{var a;if(typeof window<"u"&&((a=window.appSettings)!=null&&a.formatCurrency)){const l=typeof s=="number"?s:parseFloat(s)||0;return window.appSettings.formatCurrency(l)}return s||0},E=[];r!=null&&r.create&&E.push({label:o("Create Budget"),icon:e.jsx(U,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:A});const ne=[{title:o("Dashboard"),href:route("dashboard")},{title:o("Budget & Expenses")},{title:o("Budgets")}];return e.jsxs(Ne,{title:o("Budget Management"),url:"/budgets",actions:E,breadcrumbs:ne,noPadding:!0,children:[e.jsx("div",{className:"bg-white rounded-lg shadow mb-4",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("form",{onSubmit:le,className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-64",children:[e.jsx($,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(xe,{placeholder:o("Search budgets..."),value:w,onChange:s=>k(s.target.value),className:"w-full pl-9"})]}),e.jsxs(i,{type:"submit",size:"sm",children:[e.jsx($,{className:"h-4 w-4 mr-1.5"}),o("Search")]})]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>B(!F),children:[e.jsx(ye,{className:"h-3.5 w-3.5 mr-1.5"}),o("Filters")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"border rounded-md p-0.5",children:[e.jsx(i,{size:"sm",variant:y==="list"?"default":"ghost",className:"h-7 px-2",onClick:()=>_("list"),children:e.jsx(Ce,{className:"h-4 w-4"})}),e.jsx(i,{size:"sm",variant:y==="grid"?"default":"ghost",className:"h-7 px-2",onClick:()=>_("grid"),children:e.jsx(ve,{className:"h-4 w-4"})})]}),e.jsx(G,{className:"text-xs text-muted-foreground",children:o("Per Page:")}),e.jsxs(W,{value:((I=t==null?void 0:t.per_page)==null?void 0:I.toString())||"12",onValueChange:s=>{const a={page:1,per_page:parseInt(s)};w&&(a.search=w),g!=="all"&&(a.status=g),v.get(route("budgets.index"),a,{preserveState:!0,preserveScroll:!0})},children:[e.jsx(J,{className:"w-16 h-8",children:e.jsx(Q,{})}),e.jsxs(X,{children:[e.jsx(j,{value:"12",children:"12"}),e.jsx(j,{value:"24",children:"24"}),e.jsx(j,{value:"36",children:"36"}),e.jsx(j,{value:"48",children:"48"})]})]})]})]}),F&&e.jsx("div",{className:"w-full mt-3 p-4 bg-gray-50 border rounded-md",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{children:"Status"}),e.jsxs(W,{value:g,onValueChange:T,children:[e.jsx(J,{className:"w-40",children:e.jsx(Q,{placeholder:"All Status"})}),e.jsxs(X,{children:[e.jsx(j,{value:"all",children:"All Status"}),e.jsx(j,{value:"active",children:"Active"}),e.jsx(j,{value:"completed",children:"Completed"}),e.jsx(j,{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>{T("all"),k(""),B(!1)},children:"Reset Filters"})]})})]})}),y==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:(L=t==null?void 0:t.data)==null?void 0:L.map(s=>{var a,l;return e.jsxs(me,{className:"overflow-hidden hover:shadow-md transition-shadow",children:[e.jsxs(he,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(pe,{className:"text-base line-clamp-1 cursor-pointer hover:text-blue-600 transition-colors",onClick:()=>p("view",s),children:s.project.title}),e.jsx(K,{className:D(s.status),variant:"secondary",children:s.status})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:u(s.total_budget)}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"capitalize",children:s.period_type})]})]}),e.jsx(je,{className:"py-2",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Budget Utilization"}),e.jsxs("span",{className:q(s.utilization_percentage||0),children:[(s.utilization_percentage||0).toFixed(1),"%"]})]}),e.jsx(fe,{value:s.utilization_percentage,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Spent:"}),e.jsx("div",{className:"font-medium",children:u(s.total_spent)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Remaining:"}),e.jsx("div",{className:"font-medium",children:u(s.remaining_budget)})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex -space-x-1",children:[(a=s.categories)==null?void 0:a.slice(0,3).map((n,z)=>e.jsxs(x,{children:[e.jsx(m,{asChild:!0,children:e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center text-xs font-medium text-white",style:{backgroundColor:n.color},children:n.name.charAt(0)})}),e.jsxs(h,{children:[n.name,": ",u(n.allocated_amount)]})]},z)),((l=s.categories)==null?void 0:l.length)>3&&e.jsxs("div",{className:"w-6 h-6 rounded-full bg-gray-200 border-2 border-white flex items-center justify-center text-xs",children:["+",s.categories.length-3]})]}),(s.utilization_percentage||0)>=90&&e.jsxs(x,{children:[e.jsx(m,{asChild:!0,children:e.jsx(Se,{className:"h-4 w-4 text-red-500"})}),e.jsx(h,{children:"Budget nearly exhausted"})]})]})]})}),e.jsxs(ue,{className:"flex justify-end gap-1 pt-0 pb-2",children:[e.jsxs(x,{children:[e.jsx(m,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>p("view",s),className:"text-blue-500 hover:text-blue-700 h-8 w-8",children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsx(h,{children:"View"})]}),(r==null?void 0:r.update)&&e.jsxs(x,{children:[e.jsx(m,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>p("edit",s),className:"text-amber-500 hover:text-amber-700 h-8 w-8",children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsx(h,{children:"Edit"})]}),(r==null?void 0:r.delete)&&e.jsxs(x,{children:[e.jsx(m,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700 h-8 w-8",onClick:()=>p("delete",s),children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsx(h,{children:"Delete"})]})]})]},s.id)})}):e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Budget"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilization"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categories"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(V=t==null?void 0:t.data)==null?void 0:V.map(s=>{var a,l;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 cursor-pointer hover:text-blue-600 transition-colors",onClick:()=>p("view",s),children:s.project.title}),e.jsxs("div",{className:"text-sm text-gray-500 capitalize",children:[s.period_type," budget"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:u(s.total_budget)}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Spent: ",u(s.total_spent)]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(K,{className:D(s.status),variant:"secondary",children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(s.utilization_percentage||0,100)}%`}})}),e.jsxs("span",{className:`text-sm ${q(s.utilization_percentage||0)}`,children:[(s.utilization_percentage||0).toFixed(1),"%"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex -space-x-1",children:[(a=s.categories)==null?void 0:a.slice(0,4).map((n,z)=>e.jsxs(x,{children:[e.jsx(m,{asChild:!0,children:e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white flex items-center justify-center text-xs font-medium text-white",style:{backgroundColor:n.color},children:n.name.charAt(0)})}),e.jsxs(h,{children:[n.name,": ",u(n.allocated_amount)]})]},z)),((l=s.categories)==null?void 0:l.length)>4&&e.jsxs("div",{className:"w-6 h-6 rounded-full bg-gray-200 border-2 border-white flex items-center justify-center text-xs",children:["+",s.categories.length-4]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(x,{children:[e.jsx(m,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>p("view",s),className:"text-blue-500 hover:text-blue-700 h-8 w-8",children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsx(h,{children:"View"})]}),(r==null?void 0:r.update)&&e.jsxs(x,{children:[e.jsx(m,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>p("edit",s),className:"text-amber-500 hover:text-amber-700 h-8 w-8",children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsx(h,{children:"Edit"})]}),(r==null?void 0:r.delete)&&e.jsxs(x,{children:[e.jsx(m,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700 h-8 w-8",onClick:()=>p("delete",s),children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsx(h,{children:"Delete"})]})]})})]},s.id)})})]})}),(t==null?void 0:t.links)&&e.jsxs("div",{className:"p-4 border-t flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.from)||0})," to ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.to)||0})," of ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.total)||0})," budgets"]}),e.jsx("div",{className:"flex gap-1",children:(O=t==null?void 0:t.links)==null?void 0:O.map((s,a)=>{const l=s.label==="&laquo; Previous"||s.label==="Next &raquo;",n=s.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(i,{variant:s.active?"default":"outline",size:l?"sm":"icon",className:l?"px-3":"h-8 w-8",disabled:!s.url,onClick:()=>s.url&&v.get(s.url),children:l?n:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},a)})})]})]}),y==="grid"&&(t==null?void 0:t.links)&&e.jsxs("div",{className:"mt-6 bg-white p-4 rounded-lg shadow flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.from)||0})," to ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.to)||0})," of ",e.jsx("span",{className:"font-medium",children:(t==null?void 0:t.total)||0})," budgets"]}),e.jsx("div",{className:"flex gap-1",children:(R=t==null?void 0:t.links)==null?void 0:R.map((s,a)=>{const l=s.label==="&laquo; Previous"||s.label==="Next &raquo;",n=s.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(i,{variant:s.active?"default":"outline",size:l?"sm":"icon",className:l?"px-3":"h-8 w-8",disabled:!s.url,onClick:()=>s.url&&v.get(s.url),children:l?n:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},a)})})]}),((H=t==null?void 0:t.data)==null?void 0:H.length)===0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx(be,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No budgets found"}),(r==null?void 0:r.create)&&e.jsxs(i,{onClick:A,children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),o("Create your first budget")]})]}),e.jsx(we,{isOpen:te,onClose:()=>{S(!1),b(null)},budget:N,mode:re}),e.jsx(ge,{isOpen:ae,onClose:()=>C(!1),onConfirm:ce,itemName:((P=N==null?void 0:N.project)==null?void 0:P.title)||"",entityName:"budget"})]})}export{hs as default};
