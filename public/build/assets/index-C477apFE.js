import{r as u,j as e}from"./ui-Ps9nvBG1.js";import{P as ne}from"./page-template-BeQadk1c.js";import{u as de,K as ce,t as i,P as pe,S as U,I as me,B as h,e as S,f as x,i as D,j as F,k}from"./app-BTt_gkO3.js";import{S as L,a as R,b as V,c as $,d as g}from"./select-z0EzYxFC.js";import{D as B}from"./date-picker-B-c0ShZi.js";import{C as ue}from"./CrudFormModal-CIUswiAq.js";import{C as xe}from"./CrudDeleteModal-CAwcbZOF.js";import{D as he}from"./download-FY3rJJBK.js";import{F as ge}from"./filter-C99mLYzj.js";import{a as fe,T as be}from"./toggle-right-uccKRcAk.js";import{S as je}from"./square-pen-BE6Ef4zh.js";import{T as Se}from"./trash-2-WsAE_ige.js";import"./vendor-B1hewrmX.js";import"./textarea-DPiv_-Qc.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./chevron-up-CaRG6751.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./clock-NAV_RQL_.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";import"./calendar-pZCS8WPy.js";import"./radio-group-JdhkNCQh.js";import"./circle-B-lwSO-9.js";import"./checkbox-ux8-2I9a.js";import"./scroll-area-B8km6OEG.js";function ms(){var A,M,q;const{t}=de(),{auth:ve,newsletters:a,filters:l={},flash:o}=ce().props,[n,I]=u.useState(l.search||""),[d,v]=u.useState(l.start_date?new Date(l.start_date):void 0),[c,N]=u.useState(l.end_date?new Date(l.end_date):void 0),[p,E]=u.useState(l.status||"all"),[y,O]=u.useState(!1),[H,b]=u.useState(!1),[K,w]=u.useState(!1),[f,_]=u.useState(null),[j,P]=u.useState("create");u.useEffect(()=>{o!=null&&o.success&&i.success(o.success),o!=null&&o.error&&i.error(o.error)},[o]);const C=()=>p!=="all"||n!==""||d!==void 0||c!==void 0,G=()=>(p!=="all"?1:0)+(n?1:0)+(d?1:0)+(c?1:0),J=s=>{s.preventDefault(),z()},z=()=>{const s={page:1};n&&(s.search=n),p!=="all"&&(s.status=p),d&&(s.start_date=d.toISOString().split("T")[0]),c&&(s.end_date=c.toISOString().split("T")[0]),l.per_page&&(s.per_page=l.per_page),x.get(route("newsletters.index"),s,{preserveState:!0,preserveScroll:!0})},Q=s=>{E(s);const r={page:1};n&&(r.search=n),s!=="all"&&(r.status=s),d&&(r.start_date=d.toISOString().split("T")[0]),c&&(r.end_date=c.toISOString().split("T")[0]),l.per_page&&(r.per_page=l.per_page),x.get(route("newsletters.index"),r,{preserveState:!0,preserveScroll:!0})},W=s=>{const r=l.sort_field===s&&l.sort_direction==="asc"?"desc":"asc",m={sort_field:s,sort_direction:r,page:1};n&&(m.search=n),p!=="all"&&(m.status=p),d&&(m.start_date=d.toISOString().split("T")[0]),c&&(m.end_date=c.toISOString().split("T")[0]),l.per_page&&(m.per_page=l.per_page),x.get(route("newsletters.index"),m,{preserveState:!0,preserveScroll:!0})},X=()=>{_(null),P("create"),b(!0)},Y=s=>{_(s),P("edit"),b(!0)},Z=s=>{_(s),w(!0)},ee=s=>{i.loading(t("Updating status...")),x.put(route("newsletters.toggle-status",s.id),{},{onSuccess:()=>{i.dismiss(),o!=null&&o.success&&i.success(o.success)},onError:()=>{i.dismiss(),i.error(t("Failed to update status"))}})},se=s=>{j==="create"?(i.loading(t("Creating newsletter subscription...")),x.post(route("newsletters.store"),s,{onSuccess:()=>{b(!1),i.dismiss()},onError:r=>{i.dismiss(),i.error(t("Failed to create newsletter subscription"))}})):j==="edit"&&(i.loading(t("Updating newsletter subscription...")),x.put(route("newsletters.update",f.id),s,{onSuccess:()=>{b(!1),i.dismiss()},onError:r=>{i.dismiss(),i.error(t("Failed to update newsletter subscription"))}}))},te=()=>{i.loading(t("Deleting newsletter subscription...")),x.delete(route("newsletters.destroy",f.id),{onSuccess:()=>{w(!1),i.dismiss()},onError:()=>{i.dismiss(),i.error(t("Failed to delete newsletter subscription"))}})},re=()=>{E("all"),I(""),v(void 0),N(void 0),O(!1),x.get(route("newsletters.index"),{page:1,per_page:l.per_page},{preserveState:!0,preserveScroll:!0})},ae=()=>{const s=new URLSearchParams;n&&s.append("search",n),p!=="all"&&s.append("status",p),d&&s.append("start_date",d.toISOString().split("T")[0]),c&&s.append("end_date",c.toISOString().split("T")[0]),window.open(route("newsletters.export")+"?"+s.toString())},ie=[{label:t("Export"),icon:e.jsx(he,{className:"h-4 w-4 mr-2"}),variant:"outline",onClick:ae},{label:t("Add Newsletter"),icon:e.jsx(pe,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:X}],le=[{title:t("Dashboard"),href:route("dashboard")},{title:t("Newsletters")}],T=[{key:"email",label:t("Email"),sortable:!0,render:s=>e.jsx("span",{className:"font-medium",children:s})},{key:"status",label:t("Status"),sortable:!0,render:s=>e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s==="subscribed"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t(s==="subscribed"?"Subscribed":"Unsubscribed")})},{key:"source",label:t("Source"),render:s=>e.jsx("span",{className:"capitalize",children:s.replace("_"," ")})},{key:"created_at",label:t("Created At"),sortable:!0,render:s=>{var r;return((r=window.appSettings)==null?void 0:r.formatDateTime(s,!1))||new Date(s).toLocaleDateString()}}];return e.jsxs(ne,{title:t("Newsletter Management"),url:"/newsletters",actions:ie,breadcrumbs:le,noPadding:!0,children:[e.jsx("div",{className:"bg-white rounded-lg shadow mb-4",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("form",{onSubmit:J,className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-64",children:[e.jsx(U,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(me,{placeholder:t("Search by email..."),value:n,onChange:s=>I(s.target.value),className:"w-full pl-9"})]}),e.jsxs(h,{type:"submit",size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1.5"}),t("Search")]})]}),e.jsx("div",{className:"ml-2",children:e.jsxs(h,{variant:C()?"default":"outline",size:"sm",className:"h-8 px-2 py-1",onClick:()=>O(!y),children:[e.jsx(ge,{className:"h-3.5 w-3.5 mr-1.5"}),t(y?"Hide Filters":"Filters"),C()&&e.jsx("span",{className:"ml-1 bg-primary-foreground text-primary rounded-full w-5 h-5 flex items-center justify-center text-xs",children:G()})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"text-xs text-muted-foreground",children:t("Per Page:")}),e.jsxs(L,{value:((A=l.per_page)==null?void 0:A.toString())||"10",onValueChange:s=>{const r={page:1,per_page:parseInt(s)};n&&(r.search=n),p!=="all"&&(r.status=p),d&&(r.start_date=d.toISOString().split("T")[0]),c&&(r.end_date=c.toISOString().split("T")[0]),x.get(route("newsletters.index"),r,{preserveState:!0,preserveScroll:!0})},children:[e.jsx(R,{className:"w-16 h-8",children:e.jsx(V,{})}),e.jsxs($,{children:[e.jsx(g,{value:"10",children:"10"}),e.jsx(g,{value:"25",children:"25"}),e.jsx(g,{value:"50",children:"50"}),e.jsx(g,{value:"100",children:"100"})]})]})]})]}),y&&e.jsx("div",{className:"w-full mt-3 p-4 bg-gray-50 border rounded-md",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:t("Status")}),e.jsxs(L,{value:p,onValueChange:Q,children:[e.jsx(R,{className:"w-40",children:e.jsx(V,{placeholder:t("All Status")})}),e.jsxs($,{children:[e.jsx(g,{value:"all",children:t("All Status")}),e.jsx(g,{value:"subscribed",children:t("Subscribed")}),e.jsx(g,{value:"unsubscribed",children:t("Unsubscribed")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:t("Start Date")}),e.jsx(B,{selected:d,onSelect:v,onChange:s=>v(s)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{children:t("End Date")}),e.jsx(B,{selected:c,onSelect:N,onChange:s=>N(s)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:"default",size:"sm",className:"h-9",onClick:z,children:t("Apply Filters")}),e.jsx(h,{variant:"outline",size:"sm",className:"h-9",onClick:re,disabled:!C(),children:t("Reset Filters")})]})]})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[T.map(s=>e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-500 cursor-pointer hover:bg-gray-100",onClick:()=>s.sortable&&W(s.key),children:e.jsxs("div",{className:"flex items-center",children:[s.label,s.sortable&&e.jsx("span",{className:"ml-1",children:l.sort_field===s.key?l.sort_direction==="asc"?"↑":"↓":""})]})},s.key)),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-500",children:t("Actions")})]})}),e.jsxs("tbody",{children:[(M=a==null?void 0:a.data)==null?void 0:M.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-900 dark:hover:bg-gray-800",children:[T.map(r=>e.jsx("td",{className:"px-4 py-3",children:r.render?r.render(s[r.key],s):s[r.key]},`${s.id}-${r.key}`)),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsxs(D,{children:[e.jsx(F,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>ee(s),className:s.status==="subscribed"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800",children:s.status==="subscribed"?e.jsx(fe,{className:"h-4 w-4"}):e.jsx(be,{className:"h-4 w-4"})})}),e.jsx(k,{children:s.status==="subscribed"?t("Unsubscribe"):t("Subscribe")})]}),e.jsxs(D,{children:[e.jsx(F,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>Y(s),className:"text-amber-500 hover:text-amber-700",children:e.jsx(je,{className:"h-4 w-4"})})}),e.jsx(k,{children:t("Edit")})]}),e.jsxs(D,{children:[e.jsx(F,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700",onClick:()=>Z(s),children:e.jsx(Se,{className:"h-4 w-4"})})}),e.jsx(k,{children:t("Delete")})]})]})})]},s.id)),(!(a!=null&&a.data)||a.data.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:T.length+1,className:"px-4 py-8 text-center text-gray-500",children:t("No newsletter subscriptions found")})})]})]})}),e.jsxs("div",{className:"p-4 border-t flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[t("Showing")," ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.from)||0})," ",t("to")," ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.to)||0})," ",t("of")," ",e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.total)||0})," ",t("subscriptions")]}),e.jsx("div",{className:"flex gap-1",children:(q=a==null?void 0:a.links)==null?void 0:q.map((s,r)=>{const m=s.label==="&laquo; Previous"||s.label==="Next &raquo;",oe=s.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(h,{variant:s.active?"default":"outline",size:m?"sm":"icon",className:m?"px-3":"h-8 w-8",disabled:!s.url,onClick:()=>s.url&&x.get(s.url),children:m?oe:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},r)})})]})]}),e.jsx(ue,{isOpen:H,onClose:()=>b(!1),onSubmit:se,formConfig:{fields:[{name:"email",label:t("Email"),type:"email",required:!0},{name:"status",label:t("Status"),type:"select",required:!0,options:[{value:"subscribed",label:t("Subscribed")},{value:"unsubscribed",label:t("Unsubscribed")}]}],modalSize:"md"},initialData:f,title:t(j==="create"?"Add Newsletter Subscription":"Edit Newsletter Subscription"),mode:j}),e.jsx(xe,{isOpen:K,onClose:()=>w(!1),onConfirm:te,itemName:(f==null?void 0:f.email)||"",entityName:"newsletter subscription"})]})}export{ms as default};
