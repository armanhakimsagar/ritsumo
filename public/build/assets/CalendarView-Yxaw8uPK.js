import{r as c,j as e}from"./ui-Ps9nvBG1.js";import{D as k,l as y,n as O,o as $,B as p,P as F,C as A,d as V,g as E,f as _,a as B,b as H,u as I,K as P,t as M,L}from"./app-BTt_gkO3.js";import{f as U,P as R}from"./page-template-BeQadk1c.js";import{T as z}from"./TimeEntryForm-Bcc_Wmjo.js";import{C as q}from"./clock-NAV_RQL_.js";import{S as K}from"./square-pen-BE6Ef4zh.js";import{T as W}from"./trash-2-WsAE_ige.js";import{C as G}from"./chevron-left-BAvb6WGn.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./textarea-DPiv_-Qc.js";import"./select-z0EzYxFC.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";import"./checkbox-ux8-2I9a.js";function J({date:j,entries:n,projects:g,timesheetId:f,isOpen:C,onClose:a,onEntryUpdate:r,permissions:l}){const[N,i]=c.useState(!1),[v,d]=c.useState(null),[m,o]=c.useState(!1),[x,u]=c.useState(null),D=()=>new Date(j).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),T=()=>n.reduce((t,b)=>t+(Number(b.hours)||0),0),S=()=>n.filter(t=>t.is_billable).reduce((t,b)=>t+(Number(b.hours)||0),0),w=t=>{d(t),i(!0)},s=t=>{u(t),o(!0)},h=()=>{x&&_.delete(route("timesheet-entries.destroy",x.id),{onSuccess:()=>{r(),o(!1),u(null)},onError:()=>{console.error("Failed to delete entry"),o(!1),u(null)}})};return e.jsx(k,{open:C,onOpenChange:a,children:e.jsxs(y,{className:"max-w-2xl",style:{zIndex:1e3},children:[e.jsx(O,{children:e.jsxs($,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),D()]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:[T().toFixed(1),"h"]}),e.jsx("div",{className:"text-sm text-blue-600",children:"Total"})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-900",children:[S().toFixed(1),"h"]}),e.jsx("div",{className:"text-sm text-green-600",children:"Billable"})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-900",children:n.length}),e.jsx("div",{className:"text-sm text-purple-600",children:"Entries"})]})]}),e.jsxs(p,{onClick:()=>i(!0),className:"w-full",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Add Time Entry"]}),e.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[n.map(t=>e.jsx(A,{children:e.jsx(V,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium",children:t.project.title}),e.jsx(E,{variant:t.is_billable?"default":"secondary",children:t.is_billable?"Billable":"Non-billable"}),(l==null?void 0:l.canAccessAllData)&&t.user&&e.jsx(E,{variant:"outline",className:"text-xs",children:t.user.name})]}),t.task&&e.jsxs("div",{className:"text-sm text-muted-foreground mb-1",children:["Task: ",t.task.title]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.start_time&&t.end_time?`${t.start_time} - ${t.end_time}`:`${t.hours}h`}),t.description&&e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[t.hours,"h"]}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>w(t),className:"h-8 w-8 text-amber-500 hover:text-amber-700",title:"Edit",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>s(t),className:"h-8 w-8 text-red-500 hover:text-red-700",title:"Delete",children:e.jsx(W,{className:"h-4 w-4"})})]})]})})},t.id)),n.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No time entries for this day"})]})]}),e.jsx(z,{isOpen:N,onClose:()=>{i(!1),d(null)},timeEntry:v||void 0,timesheetId:f,projects:g,className:"z-50"}),m&&e.jsx(k,{open:m,onOpenChange:()=>{o(!1),u(null)},children:e.jsxs(y,{className:"sm:max-w-md",style:{zIndex:1e4},children:[e.jsxs(O,{children:[e.jsx($,{children:"Delete time entry"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Are you sure you want to delete ",x?`${x.hours}h entry for ${x.project.title}`:"this time entry","? This action cannot be undone."]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>{o(!1),u(null)},children:"Cancel"}),e.jsx(p,{type:"button",variant:"destructive",onClick:h,children:"Delete"})]})]})})]})})}function Q({calendarData:j,currentMonth:n,projects:g,timesheetId:f,onMonthChange:C,permissions:a}){var w;const[r,l]=c.useState(""),[N,i]=c.useState(!1),[v,d]=c.useState(!1),m=new Date(n),o=s=>{const h=new Date(m);h.setMonth(h.getMonth()+(s==="next"?1:-1)),C(h.toISOString().slice(0,7))},x=()=>m.toLocaleDateString("en-US",{year:"numeric",month:"long"}),u=s=>new Date(s).getDate(),D=s=>{l(s),i(!0)},T=s=>{l(s),d(!0)},S=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return e.jsxs(A,{children:[e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(H,{className:"flex items-center gap-4",children:[e.jsx(p,{variant:"outline",size:"icon",onClick:()=>o("prev"),children:e.jsx(G,{className:"h-4 w-4"})}),e.jsx("span",{children:x()}),e.jsx(p,{variant:"outline",size:"icon",onClick:()=>o("next"),children:e.jsx(U,{className:"h-4 w-4"})})]})})}),e.jsx(V,{children:e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[S.map(s=>e.jsx("div",{className:"p-2 text-center text-sm font-medium text-muted-foreground",children:s},s)),j.map((s,h)=>e.jsxs("div",{className:`
                                min-h-[100px] p-1 border rounded-md cursor-pointer hover:bg-gray-50
                                ${s.isCurrentMonth?"":"bg-gray-50 text-muted-foreground"}
                                ${s.isToday?"ring-2 ring-blue-500":""}
                            `,onClick:()=>s.entries.length>0?T(s.date):D(s.date),children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:`text-sm ${s.isToday?"font-bold":""}`,children:u(s.date)}),s.totalHours>0&&e.jsxs(E,{variant:"secondary",className:"text-xs",children:[s.totalHours.toFixed(1),"h"]})]}),e.jsxs("div",{className:"space-y-1",children:[s.entries.slice(0,2).map((t,b)=>e.jsx("div",{className:`
                                            text-xs p-1 rounded truncate
                                            ${t.is_billable?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}
                                        `,title:`${t.project.title} - ${t.hours}h${a!=null&&a.canAccessAllData&&t.user?` (${t.user.name})`:""}`,children:e.jsxs("div",{className:"truncate",children:[t.project.title,(a==null?void 0:a.canAccessAllData)&&t.user&&e.jsx("div",{className:"text-xs opacity-75 truncate",children:t.user.name})]})},b)),s.entries.length>2&&e.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:["+",s.entries.length-2," more"]})]}),s.entries.length===0&&s.isCurrentMonth&&e.jsx("div",{className:"flex items-center justify-center h-full opacity-0 hover:opacity-100 transition-opacity",children:e.jsx(F,{className:"h-4 w-4 text-muted-foreground"})})]},h))]})}),e.jsx(z,{isOpen:N,onClose:()=>{i(!1),l("")},timesheetId:f,projects:g}),e.jsx(J,{date:r,entries:((w=j.find(s=>s.date===r))==null?void 0:w.entries)||[],projects:g,timesheetId:f,isOpen:v,onClose:()=>{d(!1),l("")},onEntryUpdate:()=>window.location.reload(),permissions:a})]})}function Fe({calendarData:j,currentMonth:n,projects:g,timesheetId:f,permissions:C}){const{t:a}=I(),{flash:r,auth:l}=P().props,N=(l==null?void 0:l.permissions)||[];c.useEffect(()=>{r!=null&&r.success&&M.success(r.success),r!=null&&r.error&&M.error(r.error)},[r]);const i=m=>{_.get(route("timesheets.calendar-view"),{month:m},{preserveState:!0})},v=[],d=[{title:a("Dashboard"),href:route("dashboard")},{title:a("Timesheets"),href:route("timesheets.index")},{title:a("Calendar View")}];return e.jsxs(R,{title:a("Calendar View"),actions:v,breadcrumbs:d,children:[e.jsx(L,{title:a("Calendar View")}),e.jsx(Q,{calendarData:j,currentMonth:n,projects:g,timesheetId:f,onMonthChange:i,permissions:N})]})}export{Fe as default};
