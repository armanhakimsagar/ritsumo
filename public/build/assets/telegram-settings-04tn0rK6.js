import{r as c,j as e}from"./ui-Ps9nvBG1.js";import{u as q,al as L,C as E,a as O,d as F,e as h,I as M,B as D,r as R,t as i,f as U}from"./app-BTt_gkO3.js";import{S as l}from"./switch-DG4amuEJ.js";import{M as V}from"./message-circle-DFnVEf3y.js";import{C as H}from"./circle-help-DcK-i_SQ.js";import{S as z}from"./send-B0OsKa7V.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";function ae({settings:a={}}){var w,N,v,k,C,y,S,T,B,I;const{t:s}=q(),[n,p]=c.useState(a.telegram_enabled===1||a.telegram_enabled===!0),[d,_]=c.useState(a.telegram_bot_token??""),[m,j]=c.useState(a.telegram_chat_id??""),[o,f]=c.useState({new_project:!!((w=a.telegram_notifications)!=null&&w.new_project),new_task:!!((N=a.telegram_notifications)!=null&&N.new_task),task_stage_updated:!!((v=a.telegram_notifications)!=null&&v.task_stage_updated),new_milestone:!!((k=a.telegram_notifications)!=null&&k.new_milestone),milestone_status_updated:!!((C=a.telegram_notifications)!=null&&C.milestone_status_updated),new_task_comment:!!((y=a.telegram_notifications)!=null&&y.new_task_comment),new_invoice:!!((S=a.telegram_notifications)!=null&&S.new_invoice),invoice_status_updated:!!((T=a.telegram_notifications)!=null&&T.invoice_status_updated),expense_approval:!!((B=a.telegram_notifications)!=null&&B.expense_approval),new_budget:!!((I=a.telegram_notifications)!=null&&I.new_budget)}),[J,u]=c.useState(!1),[b,g]=c.useState(!1);c.useEffect(()=>{p(a.telegram_enabled===1||a.telegram_enabled===!0),_(a.telegram_bot_token??""),j(a.telegram_chat_id??"");const t=a.telegram_notifications||{};f({new_project:!!t.new_project,new_task:!!t.new_task,task_stage_updated:!!t.task_stage_updated,new_milestone:!!t.new_milestone,milestone_status_updated:!!t.milestone_status_updated,new_task_comment:!!t.new_task_comment,new_invoice:!!t.new_invoice,invoice_status_updated:!!t.invoice_status_updated,expense_approval:!!t.expense_approval,new_budget:!!t.new_budget})},[a]);const A=async t=>{t.preventDefault(),u(!0),i.loading(s("Saving Telegram settings..."));try{await U.post(route("telegram.settings.update"),{telegram_enabled:n,telegram_bot_token:d,telegram_chat_id:m,telegram_notifications:o},{preserveState:!0,onSuccess:()=>{i.dismiss(),i.success(s("Telegram settings updated successfully"))},onError:x=>{i.dismiss(),i.error(s("Failed to save Telegram settings")),console.error("Telegram settings error:",x)},onFinish:()=>{u(!1)}})}catch{i.dismiss(),i.error(s("Failed to save Telegram settings")),u(!1)}},G=async()=>{if(!d||!m){i.error(s("Please enter both Bot Token and Chat ID first"));return}g(!0),i.loading(s("Sending test message..."));try{await U.post(route("telegram.test"),{telegram_bot_token:d,telegram_chat_id:m},{preserveState:!0,onSuccess:()=>{i.dismiss(),i.success(s("Test message sent successfully to Telegram!"))},onError:t=>{i.dismiss(),i.error(s("Failed to send test message")),console.error("Telegram test error:",t)},onFinish:()=>{g(!1)}})}catch{i.dismiss(),i.error(s("Failed to send test message")),g(!1)}},r=(t,x)=>{f(P=>({...P,[t]:x}))};return e.jsx(L,{title:s("Telegram Integration"),description:s("Configure Telegram bot integration for real-time notifications"),action:e.jsxs(D,{type:"submit",form:"telegram-settings-form",size:"sm",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),s("Save Changes")]}),children:e.jsx("form",{id:"telegram-settings-form",onSubmit:A,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(E,{children:[e.jsx(O,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-base font-medium",children:s("Integration Settings")})]})}),e.jsxs(F,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-md",children:[e.jsxs("div",{children:[e.jsx(h,{className:"font-medium",children:s("Enable Telegram Integration")}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s("Turn on to receive notifications in Telegram")})]}),e.jsx(l,{checked:n,onCheckedChange:p})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"font-medium",children:s("Bot Token")}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(M,{type:"password",placeholder:s("123456789:ABCdefGHIjklMNOpqrsTUVwxyz"),value:d,onChange:t=>_(t.target.value),disabled:!n,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("Create a bot with @BotFather to get this token")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"font-medium",children:s("Chat ID")}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(M,{placeholder:s("123456789 or -123456789"),value:m,onChange:t=>j(t.target.value),disabled:!n,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("Use @userinfobot to get your chat ID")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(h,{className:"font-medium",children:s("Notification Types")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Project")}),e.jsx(l,{checked:o.new_project,onCheckedChange:t=>r("new_project",t),disabled:!n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Task")}),e.jsx(l,{checked:o.new_task,onCheckedChange:t=>r("new_task",t),disabled:!n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("Task Stage Updated")}),e.jsx(l,{checked:o.task_stage_updated,onCheckedChange:t=>r("task_stage_updated",t),disabled:!n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Milestone")}),e.jsx(l,{checked:o.new_milestone,onCheckedChange:t=>r("new_milestone",t),disabled:!n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("Milestone Status Updated")}),e.jsx(l,{checked:o.milestone_status_updated,onCheckedChange:t=>r("milestone_status_updated",t),disabled:!n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Task Comment")}),e.jsx(l,{checked:o.new_task_comment,onCheckedChange:t=>r("new_task_comment",t),disabled:!n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Invoice")}),e.jsx(l,{checked:o.new_invoice,onCheckedChange:t=>r("new_invoice",t),disabled:!n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("Invoice Status Updated")}),e.jsx(l,{checked:o.invoice_status_updated,onCheckedChange:t=>r("invoice_status_updated",t),disabled:!n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("Expense Approval")}),e.jsx(l,{checked:o.expense_approval,onCheckedChange:t=>r("expense_approval",t),disabled:!n})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s("New Budget")}),e.jsx(l,{checked:o.new_budget,onCheckedChange:t=>r("new_budget",t),disabled:!n})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("Select which types of notifications to send to Telegram")})]})]})]})}),e.jsx("div",{className:"space-y-6",children:e.jsx(E,{children:e.jsxs(F,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(z,{className:"h-4 w-4 text-primary"}),e.jsx("h3",{className:"text-base font-medium",children:s("Test Telegram Integration")})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:s("Send a test message to verify your Telegram configuration is working correctly.")}),e.jsxs(D,{type:"button",onClick:G,disabled:!n||!d||!m||b,className:"w-full",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),s(b?"Sending...":"Send Test Message")]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center mb-6 mt-4",children:s("Enter bot token and chat ID to test the integration")}),e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-2",children:s("Setup Instructions")}),e.jsxs("ol",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:s("Message @BotFather on Telegram")}),e.jsx("li",{children:s("Create a new bot with /newbot")}),e.jsx("li",{children:s("Copy the bot token")}),e.jsx("li",{children:s("Get your chat ID from @userinfobot")}),e.jsx("li",{children:s("Enter both values above")})]})]})]})})})]})})})}export{ae as default};
