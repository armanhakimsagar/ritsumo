import{r as a,j as e}from"./ui-Ps9nvBG1.js";import{P as y}from"./page-template-BeQadk1c.js";import{u as R,C as b,a as f,b as C,d as S,B as o,g as D}from"./app-BTt_gkO3.js";import{T as q}from"./textarea-DPiv_-Qc.js";import{C as A}from"./circle-check-big-BMYVPbRH.js";import{C as T}from"./circle-x-BnYRe0cI.js";import{C as M}from"./circle-alert-DCoDy4PA.js";import{C as L}from"./clock-NAV_RQL_.js";import"./vendor-B1hewrmX.js";import"./select-z0EzYxFC.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./message-square-DGoN5Yg5.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";function ge(){const{t}=R(),[m,_]=a.useState([]),[B,E]=a.useState(!0),[l,x]=a.useState([]),[i,h]=a.useState([]),[j,u]=a.useState("");a.useEffect(()=>{d()},[]);const d=async()=>{try{const r=await(await fetch(route("api.expense-workflows.my-approvals"))).json();_(r.approvals.data||[])}catch(s){console.error("Failed to load approvals:",s)}finally{E(!1)}},p=async(s,r,n)=>{var N;x(c=>[...c,s]);try{await fetch(route("expense-workflows.process",s),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((N=document.querySelector('meta[name="csrf-token"]'))==null?void 0:N.getAttribute("content"))||""},body:JSON.stringify({action:r,notes:n})}),d()}catch(c){console.error("Failed to process approval:",c)}finally{x(c=>c.filter(P=>P!==s))}},v=async s=>{var r;if(i.length!==0)try{await fetch(route("expense-workflows.bulk-process"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({workflow_ids:i,action:s,notes:j})}),h([]),u(""),d()}catch(n){console.error("Failed to process bulk approvals:",n)}},F=(s,r)=>new Intl.NumberFormat("en-US",{style:"currency",currency:r}).format(s),O=s=>{h(r=>r.includes(s)?r.filter(n=>n!==s):[...r,s])},g=[{title:t("Dashboard"),href:route("dashboard")},{title:t("My Approvals")}];return B?e.jsx(y,{title:t("My Approvals"),breadcrumbs:g,children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:t("Loading approvals...")})})}):e.jsx(y,{title:t("My Approvals"),breadcrumbs:g,noPadding:!0,children:e.jsxs("div",{className:"space-y-6",children:[i.length>0&&e.jsxs(b,{children:[e.jsx(f,{children:e.jsxs(C,{children:[t("Bulk Actions")," (",i.length," ",t("selected"),")"]})}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(q,{placeholder:t("Add notes for bulk action (optional)..."),value:j,onChange:s=>u(s.target.value),rows:3}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{onClick:()=>v("approve"),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),t("Approve Selected")]}),e.jsxs(o,{onClick:()=>v("reject"),variant:"destructive",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),t("Reject Selected")]})]})]})})]}),m.length>0?e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsxs(b,{className:"overflow-hidden",children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:i.includes(s.id),onChange:()=>O(s.id),className:"rounded"}),e.jsxs("div",{children:[e.jsx(C,{className:"text-lg",children:s.project_expense.title}),e.jsxs("div",{className:"text-sm text-gray-600",children:[s.project_expense.project.title," â€¢",t("Submitted by")," ",s.project_expense.submitter.name]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:F(s.project_expense.amount)}),e.jsxs(D,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[t("Step")," ",s.step]})]})]})}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-4",children:[s.project_expense.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:t("Description")}),e.jsx("p",{className:"text-gray-600",children:s.project_expense.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[t("Expense Date"),":"]}),e.jsx("div",{children:new Date(s.project_expense.expense_date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[t("Vendor"),":"]}),e.jsx("div",{children:s.project_expense.vendor||t("Not specified")})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(o,{onClick:()=>p(s.id,"approve"),disabled:l.includes(s.id),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),t("Approve")]}),e.jsxs(o,{onClick:()=>p(s.id,"reject"),disabled:l.includes(s.id),variant:"destructive",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),t("Reject")]}),e.jsxs(o,{onClick:()=>p(s.id,"request_info"),disabled:l.includes(s.id),variant:"outline",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),t("Request Info")]})]})]})})]},s.id))}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx(L,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500 mb-4",children:t("No pending approvals")}),e.jsx("p",{className:"text-sm text-gray-400",children:t("All expenses have been processed")})]})]})})}export{ge as default};
