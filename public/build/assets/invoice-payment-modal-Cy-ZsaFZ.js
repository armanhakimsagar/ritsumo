import{r as p,j as e}from"./ui-Ps9nvBG1.js";import{u as k,t as g,f as E,B as f,E as q,e as A,I as R,D as H,l as J,n as V,o as W,C as O,d as B,g as U}from"./app-BTt_gkO3.js";import{I as Q,a as Z}from"./invoice-payment-form-DWi7BJoK.js";import{L as F}from"./loader-circle-LF6za7Wc.js";import{A as v,a as w}from"./alert-CnBrcYs9.js";import{C as _}from"./credit-card-BwPrmecT.js";import{C as P}from"./circle-alert-DCoDy4PA.js";import{E as z}from"./external-link-DZ7-d7Y_.js";import{f as X}from"./currency-kzm_C5pv.js";import{B as ee,I as se}from"./indian-rupee-CXBAgLWO.js";import{D as te}from"./dollar-sign-CY6xo33T.js";function ae({invoice:n,paypalClientId:d,amount:i,onSuccess:j,onCancel:y}){const{t:s}=k(),t=p.useRef(null);return p.useEffect(()=>{if(!d||!t.current)return;const c=document.createElement("script");return c.src=`https://www.paypal.com/sdk/js?client-id=${d}&currency=USD&disable-funding=credit,card`,c.async=!0,c.onload=()=>{window.paypal&&t.current&&window.paypal.Buttons({createOrder:(m,o)=>{const a=parseFloat(i.toString()).toFixed(2);return console.log("Creating PayPal order for amount:",a),o.order.create({purchase_units:[{amount:{value:a,currency_code:"USD"}}]})},onApprove:(m,o)=>{console.log("PayPal payment approved:",m),E.post(route("invoices.payment.process",n.payment_token),{payment_method:"paypal",invoice_token:n.payment_token,amount:i,order_id:m.orderID,payment_id:m.paymentID||m.orderID},{onSuccess:()=>{j()},onError:a=>{console.error("Payment error:",a),g.error(a.message||s("Payment failed"))}})},onError:m=>{console.error("PayPal error:",m),m.message&&m.message.includes("declined")?g.error(s("Card was declined. Please try a different payment method.")):g.error(s("Payment failed. Please try again."))},onCancel:()=>{y()}}).render(t.current)},document.head.appendChild(c),()=>{document.head.contains(c)&&document.head.removeChild(c)}},[d,n.id,i]),d?e.jsx("div",{className:"space-y-4",children:e.jsx("div",{ref:t})}):e.jsx("div",{className:"p-4 text-center text-red-500",children:s("PayPal not configured")})}function re({invoice:n,razorpayKey:d,amount:i,onSuccess:j,onCancel:y}){const{t:s}=k(),t=p.useRef(null);return p.useEffect(()=>{if(!d||!t.current)return;const c=document.createElement("script");return c.src="https://checkout.razorpay.com/v1/checkout.js",c.async=!0,c.onload=()=>{if(window.Razorpay&&t.current){const m={key:d,amount:Math.round(i*100),currency:"INR",name:"Invoice Payment",description:`Invoice ${n.id} Payment`,handler:function(x){console.log("Razorpay payment success:",x),E.post(route("invoices.payment.process",n.payment_token),{payment_method:"razorpay",invoice_token:n.payment_token,amount:i,razorpay_payment_id:x.razorpay_payment_id,razorpay_order_id:x.razorpay_order_id||null,razorpay_signature:x.razorpay_signature||null},{onSuccess:()=>{j()},onError:r=>{console.error("Payment error:",r),g.error(r.message||s("Payment failed"))}})},prefill:{name:"Customer",email:"customer@example.com"},theme:{color:"#3399cc"},modal:{ondismiss:function(){console.log("Razorpay payment cancelled"),y()}}},o=new window.Razorpay(m),a=document.createElement("button");a.className="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-md transition-colors",a.textContent=`Pay â‚¹${i.toFixed(2)}`,a.onclick=()=>o.open(),t.current.appendChild(a)}},c.onerror=()=>{console.error("Failed to load Razorpay SDK"),g.error(s("Failed to load Razorpay. Please check your internet connection."))},document.head.appendChild(c),()=>{document.head.contains(c)&&document.head.removeChild(c),t.current&&(t.current.innerHTML="")}},[d,n.id,i]),d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ’°"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:s("Pay with Razorpay")}),e.jsxs("p",{className:"text-xl font-bold text-blue-600",children:["â‚¹",i.toFixed(2)]})]}),e.jsx("div",{ref:t}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",onClick:y,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:s("Cancel")})})]}):e.jsx("div",{className:"p-4 text-center text-red-500",children:s("Razorpay not configured")})}function ne({invoice:n,mercadopagoAccessToken:d,amount:i,onSuccess:j,onCancel:y}){const{t:s}=k(),[t,c]=p.useState(!1),m=async()=>{var o,a;try{c(!0);const x=await q.post(route("invoices.payment.process",{token:n.payment_token}),{payment_method:"mercadopago",amount:i},{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});x.data.redirect_url?window.location.href=x.data.redirect_url:(g.error(s("Failed to create payment preference")),c(!1))}catch(x){const r=((a=(o=x.response)==null?void 0:o.data)==null?void 0:a.error)||x.message||s("Failed to create payment preference");g.error(r),c(!1)}};return d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ’³"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:s("Pay with Mercado Pago")}),e.jsxs("p",{className:"text-xl font-bold text-blue-600",children:["$",i.toFixed(2)]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(f,{onClick:m,disabled:t,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-4 rounded-md transition-colors",children:t?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}),s("Processing...")]}):s("Pay with Mercado Pago")}),e.jsx("div",{className:"text-xs text-gray-500 text-center",children:s("You will be redirected to Mercado Pago to complete your payment")})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",onClick:y,disabled:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:s("Cancel")})})]}):e.jsx("div",{className:"p-4 text-center text-red-500",children:s("Mercado Pago not configured")})}function ce({invoice:n,paystackPublicKey:d,amount:i,onSuccess:j,onCancel:y}){const{t:s}=k(),t=p.useRef(null),[c,m]=p.useState(!1);if(p.useEffect(()=>{if(!d)return;const a=document.createElement("script");return a.src="https://js.paystack.co/v1/inline.js",a.async=!0,a.onload=()=>{window.PaystackPop&&t.current&&window.PaystackPop.setup({key:d,email:"customer@example.com",amount:Math.round(i*100),currency:"NGN",ref:"inv_"+Date.now(),callback:function(x){console.log("Paystack payment successful:",x),E.post(route("invoices.payment.process",n.payment_token),{payment_method:"paystack",invoice_token:n.payment_token,amount:i,payment_id:x.reference},{onSuccess:()=>{j()},onError:r=>{console.error("Payment error:",r),g.error(r.message||s("Payment failed"))}})},onClose:function(){y()}})},document.head.appendChild(a),()=>{document.head.contains(a)&&document.head.removeChild(a)}},[d,n.id,i]),!d)return e.jsx("div",{className:"p-4 text-center text-red-500",children:s("Paystack not configured")});const o=a=>{a.preventDefault(),m(!0),window.PaystackPop&&window.PaystackPop.setup({key:d,email:"customer@example.com",amount:Math.round(i*100),currency:"NGN",ref:"inv_"+Date.now(),callback:function(r){E.post(route("invoices.payment.process",n.payment_token),{payment_method:"paystack",invoice_token:n.payment_token,amount:i,payment_id:r.reference},{onSuccess:()=>{j()},onError:u=>{g.error(u.message||s("Payment failed")),m(!1)}})},onClose:function(){m(!1)}}).openIframe()};return e.jsxs("div",{className:"space-y-4",ref:t,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("h3",{className:"text-lg font-semibold",children:s("Paystack Payment")})]}),e.jsxs(v,{children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:s("You will be redirected to Paystack to complete your payment securely.")})]}),e.jsx("div",{className:"bg-muted p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:s("Amount to Pay")}),e.jsxs("span",{className:"text-lg font-bold",children:["$",i.toFixed(2)]})]})}),e.jsx("form",{onSubmit:o,className:"space-y-4",children:e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:y,className:"flex-1",disabled:c,children:s("Cancel")}),e.jsx(f,{type:"submit",disabled:c,className:"flex-1",children:c?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),s("Processing...")]}):s("Pay with Paystack")})]})}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:s("Powered by Paystack - Secure payment processing")})]})}function ie({invoice:n,flutterwavePublicKey:d,amount:i,onSuccess:j,onCancel:y}){const{t:s}=k(),[t,c]=p.useState(!1);p.useEffect(()=>{if(!d)return;const o=document.createElement("script");return o.src="https://checkout.flutterwave.com/v3.js",o.async=!0,document.head.appendChild(o),()=>{document.head.contains(o)&&document.head.removeChild(o)}},[d]);const m=o=>{if(o.preventDefault(),c(!0),window.FlutterwaveCheckout){const a="inv_"+Date.now();window.FlutterwaveCheckout({public_key:d,tx_ref:a,amount:i,currency:"USD",payment_options:"card,mobilemoney,ussd",customer:{email:"customer@example.com",phone_number:"080****4528",name:"Customer Name"},callback:function(x){console.log("Flutterwave payment successful:",x),E.post(route("invoices.payment.process",n.payment_token),{payment_method:"flutterwave",invoice_token:n.payment_token,amount:i,payment_id:x.transaction_id,tx_ref:a},{onSuccess:()=>{j()},onError:r=>{console.error("Payment error:",r),g.error(r.message||s("Payment failed")),c(!1)}})},onclose:function(){c(!1)},customizations:{title:"Invoice Payment",description:`Payment for Invoice #${n.id}`,logo:""}})}else g.error(s("Flutterwave SDK not loaded")),c(!1)};return d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("h3",{className:"text-lg font-semibold",children:s("Flutterwave Payment")})]}),e.jsxs(v,{children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:s("You will be redirected to Flutterwave to complete your payment securely.")})]}),e.jsx("div",{className:"bg-muted p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:s("Amount to Pay")}),e.jsxs("span",{className:"text-lg font-bold",children:["$",i.toFixed(2)]})]})}),e.jsx("form",{onSubmit:m,className:"space-y-4",children:e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:y,className:"flex-1",disabled:t,children:s("Cancel")}),e.jsx(f,{type:"submit",disabled:t,className:"flex-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),s("Processing...")]}):s("Pay with Flutterwave")})]})}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:s("Powered by Flutterwave - Secure payment processing")})]}):e.jsx("div",{className:"p-4 text-center text-red-500",children:s("Flutterwave not configured")})}function le({invoice:n,tapPublicKey:d,amount:i,onSuccess:j,onCancel:y}){const{t:s}=k(),[t,c]=p.useState(!1),[m,o]=p.useState(null),a=async()=>{var x;c(!0),o(null);try{const r=new FormData;r.append("invoice_id",n.id.toString()),r.append("amount",i.toString()),r.append("_token",((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.getAttribute("content"))||"");const u=await fetch(route("tap.create-invoice-payment"),{method:"POST",body:r});if(!u.ok)throw new Error("Network response was not ok");const C=await u.json();if(C&&C.redirect_url)window.location.href=C.redirect_url;else throw C&&C.error?new Error(C.error):new Error(s("Payment creation failed"))}catch(r){console.error("Tap payment error:",r),o(r instanceof Error?r.message:s("Payment initialization failed")),c(!1)}};return d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("h3",{className:"text-lg font-semibold",children:s("Tap Payment")})]}),m&&e.jsxs(v,{variant:"destructive",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:m})]}),e.jsx("div",{className:"bg-muted p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:s("Amount to Pay")}),e.jsxs("span",{className:"text-lg font-bold",children:["$",i.toFixed(2)]})]})}),e.jsxs(v,{children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:s("You will be redirected to Tap to complete your payment securely.")})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:s("Supported Payment Methods")}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Credit/Debit Cards"}),e.jsx("li",{children:"â€¢ Apple Pay"}),e.jsx("li",{children:"â€¢ Google Pay"}),e.jsx("li",{children:"â€¢ KNET"}),e.jsx("li",{children:"â€¢ Benefit Pay"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{variant:"outline",onClick:y,className:"flex-1",disabled:t,children:s("Cancel")}),e.jsx(f,{onClick:a,disabled:t,className:"flex-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),s("Redirecting...")]}):s("Pay with Tap")})]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:s("Powered by Tap - Secure payment processing")})]}):e.jsx("div",{className:"p-4 text-center text-red-500",children:s("Tap not configured")})}function oe({invoice:n,xenditApiKey:d,amount:i,onSuccess:j,onCancel:y}){const{t:s}=k(),[t,c]=p.useState(!1),[m,o]=p.useState(null),a=async()=>{var x;c(!0),o(null);try{const u=await(await fetch(route("xendit.create-invoice-payment"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.getAttribute("content"))||""},body:JSON.stringify({invoice_id:n.id,amount:i})})).json();if(u.success&&u.redirect_url)window.location.href=u.redirect_url;else throw new Error(u.error||s("Payment creation failed"))}catch(r){console.error("Xendit payment error:",r),o(r instanceof Error?r.message:s("Payment initialization failed")),c(!1)}};return d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("h3",{className:"text-lg font-semibold",children:s("Xendit Payment")})]}),m&&e.jsxs(v,{variant:"destructive",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:m})]}),e.jsx("div",{className:"bg-muted p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:s("Amount to Pay")}),e.jsxs("span",{className:"text-lg font-bold",children:["$",i.toFixed(2)]})]})}),e.jsxs(v,{children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:s("You will be redirected to Xendit to complete your payment securely.")})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:s("Supported Payment Methods")}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Credit/Debit Cards"}),e.jsx("li",{children:"â€¢ Bank Transfer"}),e.jsx("li",{children:"â€¢ E-Wallets (OVO, DANA, LinkAja)"}),e.jsx("li",{children:"â€¢ Virtual Accounts"}),e.jsx("li",{children:"â€¢ Retail Outlets"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{variant:"outline",onClick:y,className:"flex-1",disabled:t,children:s("Cancel")}),e.jsx(f,{onClick:a,disabled:t,className:"flex-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),s("Redirecting...")]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),s("Pay with Xendit")]})})]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:s("Powered by Xendit - Secure payment processing")})]}):e.jsx("div",{className:"p-4 text-center text-red-500",children:s("Xendit not configured")})}function de({invoice:n,paytrMerchantId:d,amount:i,onSuccess:j,onCancel:y}){const{t:s}=k(),[t,c]=p.useState(!1),[m,o]=p.useState(null),a=async()=>{var x;c(!0),o(null);try{const u=await(await fetch(route("paytr.create-invoice-payment"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.getAttribute("content"))||""},body:JSON.stringify({invoice_id:n.id,amount:i})})).json();if(u.success&&u.redirect_url)window.location.href=u.redirect_url;else throw new Error(u.error||s("Payment creation failed"))}catch(r){console.error("PayTR payment error:",r),o(r instanceof Error?r.message:s("Payment initialization failed")),c(!1)}};return d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("h3",{className:"text-lg font-semibold",children:s("PayTR Payment")})]}),m&&e.jsxs(v,{variant:"destructive",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:m})]}),e.jsx("div",{className:"bg-muted p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:s("Amount to Pay")}),e.jsxs("span",{className:"text-lg font-bold",children:["â‚º",i.toFixed(2)]})]})}),e.jsxs(v,{children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:s("You will be redirected to PayTR to complete your payment securely.")})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:s("Supported Payment Methods")}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Credit Cards (Visa, MasterCard, American Express)"}),e.jsx("li",{children:"â€¢ Debit Cards"}),e.jsx("li",{children:"â€¢ Turkish Bank Cards"}),e.jsx("li",{children:"â€¢ Installment Options Available"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{variant:"outline",onClick:y,className:"flex-1",disabled:t,children:s("Cancel")}),e.jsx(f,{onClick:a,disabled:t,className:"flex-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),s("Redirecting...")]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),s("Pay with PayTR")]})})]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:s("Powered by PayTR - Secure payment processing for Turkey")})]}):e.jsx("div",{className:"p-4 text-center text-red-500",children:s("PayTR not configured")})}function me({invoice:n,mollieApiKey:d,amount:i,onSuccess:j,onCancel:y}){const{t:s}=k(),[t,c]=p.useState(!1),[m,o]=p.useState(null),a=async()=>{var x;c(!0),o(null);try{const u=await(await fetch(route("mollie.create-invoice-payment"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.getAttribute("content"))||""},body:JSON.stringify({invoice_id:n.id,amount:i})})).json();if(u.success&&u.redirect_url)window.location.href=u.redirect_url;else throw new Error(u.error||s("Payment creation failed"))}catch(r){console.error("Mollie payment error:",r),o(r instanceof Error?r.message:s("Payment initialization failed")),c(!1)}};return d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("h3",{className:"text-lg font-semibold",children:s("Mollie Payment")})]}),m&&e.jsxs(v,{variant:"destructive",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:m})]}),e.jsx("div",{className:"bg-muted p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:s("Amount to Pay")}),e.jsxs("span",{className:"text-lg font-bold",children:["â‚¬",i.toFixed(2)]})]})}),e.jsxs(v,{children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:s("You will be redirected to Mollie to complete your payment securely.")})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:s("Supported Payment Methods")}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Credit Cards (Visa, MasterCard, American Express)"}),e.jsx("li",{children:"â€¢ iDEAL (Netherlands)"}),e.jsx("li",{children:"â€¢ SEPA Direct Debit"}),e.jsx("li",{children:"â€¢ PayPal"}),e.jsx("li",{children:"â€¢ Bancontact (Belgium)"}),e.jsx("li",{children:"â€¢ SOFORT Banking"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{variant:"outline",onClick:y,className:"flex-1",disabled:t,children:s("Cancel")}),e.jsx(f,{onClick:a,disabled:t,className:"flex-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),s("Redirecting...")]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),s("Pay with Mollie")]})})]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:s("Powered by Mollie - Secure payment processing for Europe")})]}):e.jsx("div",{className:"p-4 text-center text-red-500",children:s("Mollie not configured")})}function ue({invoice:n,toyyibpayCategoryCode:d,amount:i,onSuccess:j,onCancel:y}){const{t:s}=k(),[t,c]=p.useState(!1),[m,o]=p.useState(null),[a,x]=p.useState({name:"",email:"",phone:""}),[r,u]=p.useState({}),C=()=>{const h={};return a.name.trim()||(h.name=s("Full name is required")),a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)||(h.email=s("Please enter a valid email address")):h.email=s("Email address is required"),a.phone.trim()?a.phone.length<10&&(h.phone=s("Please enter a valid Malaysian phone number")):h.phone=s("Phone number is required"),u(h),Object.keys(h).length===0},I=h=>{const l=h.replace(/[^0-9]/g,"");return l.startsWith("60")?l.slice(0,12):l.startsWith("0")?"60"+l.slice(1,11):"60"+l.slice(0,10)},M=async()=>{var h;if(!C()){g.error(s("Please fill in all required fields"));return}c(!0),o(null);try{const b=await(await fetch(route("toyyibpay.create-invoice-payment"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((h=document.querySelector('meta[name="csrf-token"]'))==null?void 0:h.getAttribute("content"))||""},body:JSON.stringify({invoice_id:n.id,amount:i,billTo:a.name.trim(),billEmail:a.email.trim(),billPhone:a.phone.trim()})})).json();if(b.success&&b.redirect_url)window.location.href=b.redirect_url;else throw new Error(b.error||s("Payment creation failed"))}catch(l){console.error("ToyyibPay payment error:",l),o(l instanceof Error?l.message:s("Payment initialization failed")),c(!1)}};return d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("h3",{className:"text-lg font-semibold",children:s("ToyyibPay Payment")})]}),m&&e.jsxs(v,{variant:"destructive",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:m})]}),e.jsxs(v,{children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(w,{children:s("You will be redirected to toyyibPay to complete your payment securely via FPX (Malaysian Online Banking)")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(A,{htmlFor:"name",children:[s("Full Name")," *"]}),e.jsx(R,{id:"name",value:a.name,onChange:h=>{x(l=>({...l,name:h.target.value})),r.name&&u(l=>({...l,name:""}))},placeholder:s("Enter your full name"),className:r.name?"border-red-500":"",required:!0}),r.name&&e.jsx("p",{className:"text-sm text-red-500",children:r.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(A,{htmlFor:"email",children:[s("Email Address")," *"]}),e.jsx(R,{id:"email",type:"email",value:a.email,onChange:h=>{x(l=>({...l,email:h.target.value})),r.email&&u(l=>({...l,email:""}))},placeholder:s("Enter your email address"),className:r.email?"border-red-500":"",required:!0}),r.email&&e.jsx("p",{className:"text-sm text-red-500",children:r.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(A,{htmlFor:"phone",children:[s("Phone Number")," *"]}),e.jsx(R,{id:"phone",value:a.phone,onChange:h=>{const l=I(h.target.value);x(b=>({...b,phone:l})),r.phone&&u(b=>({...b,phone:""}))},placeholder:"60123456789",className:r.phone?"border-red-500":"",maxLength:12,required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("Malaysian format: 60123456789 (numbers only)")}),r.phone&&e.jsx("p",{className:"text-sm text-red-500",children:r.phone})]})]}),e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(_,{className:"h-4 w-4 text-primary"}),e.jsx("p",{className:"text-sm font-medium",children:s("Payment Method: FPX (Online Banking)")})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("Secure payment via Malaysian banks including Maybank, CIMB, Public Bank, RHB, and more")})]}),e.jsx("div",{className:"bg-muted rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:s("Amount to Pay")}),e.jsxs("span",{className:"text-lg font-bold",children:["RM",i.toFixed(2)]})]})}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(f,{variant:"outline",onClick:y,className:"flex-1",disabled:t,children:s("Cancel")}),e.jsx(f,{onClick:M,disabled:t||!a.name||!a.email||!a.phone,className:"flex-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),s("Redirecting...")]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),s("Pay with ToyyibPay")]})})]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:s("Powered by ToyyibPay - Secure FPX payment processing for Malaysia")})]}):e.jsx("div",{className:"p-4 text-center text-red-500",children:s("ToyyibPay not configured")})}function Pe({invoice:n,open:d,onClose:i,onSuccess:j,enabledGateways:y=[],remainingAmount:s}){const{t}=k(),[c,m]=p.useState([]),[o,a]=p.useState(""),[x,r]=p.useState(!0),[u,C]=p.useState({}),[I,M]=p.useState(!1),h=s||(n==null?void 0:n.balance_due)||(n==null?void 0:n.total_amount)-((n==null?void 0:n.paid_amount)||0)||0,[l,b]=p.useState(h);p.useEffect(()=>{d&&K()},[d]);const K=async()=>{try{r(!0);const N=await q.get(route("api.invoices.payment-methods",n.id));m(N.data.gateways),C(N.data)}catch{g.error(t("Failed to load payment methods"))}finally{r(!1)}},$=N=>{a(N),M(!0)},D=()=>{j(),i()},T=()=>{M(!1),a("")},L=N=>{switch(N){case"stripe":case"mercadopago":case"paystack":case"flutterwave":case"paytabs":case"payfast":case"toyyibpay":case"paytr":case"mollie":case"cashfree":case"iyzipay":case"benefit":case"ozow":case"easebuzz":case"khalti":case"authorizenet":case"fedapay":case"payhere":case"cinetpay":case"paiement":case"nepalste":case"yookassa":case"aamarpay":case"midtrans":case"paymentwall":case"sspay":case"tap":case"xendit":return e.jsx(_,{className:"h-5 w-5"});case"paypal":case"skrill":return e.jsx(te,{className:"h-5 w-5"});case"razorpay":return e.jsx(se,{className:"h-5 w-5"});case"bank":return e.jsx(ee,{className:"h-5 w-5"});default:return e.jsx(_,{className:"h-5 w-5"})}},Y=()=>{if(!c.find(G=>G.id===o))return null;const S={invoice:n,onSuccess:D,onCancel:T};switch(o){case"stripe":return e.jsx(Z,{invoice:{...n,amount:l},stripeKey:u.stripeKey||"pk_test_default",amount:l,onSuccess:D,onCancel:T});case"bank":return e.jsx(Q,{invoiceToken:n.payment_token,amount:l,paymentMethod:"bank",onSuccess:D,onCancel:T});case"paypal":return e.jsx(ae,{...S,paypalClientId:u.paypalClientId,amount:l});case"razorpay":return e.jsx(re,{...S,razorpayKey:u.razorpayKey,amount:l});case"mercadopago":return e.jsx(ne,{...S,mercadopagoAccessToken:u.mercadopagoAccessToken,amount:l});case"paystack":return e.jsx(ce,{...S,paystackPublicKey:u.paystackPublicKey,amount:l});case"flutterwave":return e.jsx(ie,{...S,flutterwavePublicKey:u.flutterwavePublicKey,amount:l});case"tap":return e.jsx(le,{...S,tapPublicKey:u.tapPublicKey,amount:l});case"xendit":return e.jsx(oe,{...S,xenditApiKey:u.xenditApiKey,amount:l});case"paytr":return e.jsx(de,{...S,paytrMerchantId:u.paytrMerchantId,amount:l});case"mollie":return e.jsx(me,{...S,mollieApiKey:u.mollieApiKey,amount:l});case"toyyibpay":return e.jsx(ue,{...S,toyyibpayCategoryCode:u.toyyibpayCategoryCode,amount:l});case"paytabs":case"skrill":case"coingate":case"payfast":case"cashfree":case"iyzipay":case"benefit":case"ozow":case"easebuzz":case"khalti":case"authorizenet":case"fedapay":case"payhere":case"cinetpay":case"paiement":case"nepalste":case"yookassa":case"aamarpay":case"midtrans":case"paymentwall":case"sspay":return e.jsx("div",{className:"p-4 text-center text-muted-foreground",children:t("Payment method not implemented yet")});default:return null}};return e.jsx(H,{open:d,onOpenChange:i,children:e.jsxs(J,{className:"max-w-md",children:[e.jsx(V,{children:e.jsxs(W,{children:[t("Pay Invoice")," ",n.invoice_number]})}),x?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(F,{className:"h-6 w-6 animate-spin"})}):I?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:t("Complete Payment")}),e.jsx(f,{variant:"outline",size:"sm",onClick:T,children:t("Back")})]}),Y()]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{children:e.jsx(B,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:n.invoice_number}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t("Invoice Payment")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold",children:X(h)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("Amount Due")})]})]})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"payment-amount",children:t("Payment Amount")}),e.jsx(R,{id:"payment-amount",type:"number",step:"0.01",min:"0.01",max:h,value:l,onChange:N=>b(Number(N.target.value)),placeholder:t("Enter amount to pay")}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:()=>b(h/2),children:"50%"}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>b(h),children:t("Full Amount")})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:t("Select Payment Method")}),c.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:t("No payment methods available")}):e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:c.map(N=>e.jsx(O,{className:`cursor-pointer transition-colors ${o===N.id?"border-primary bg-primary/5":"hover:border-primary"}`,onClick:()=>a(N.id),children:e.jsx(B,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-primary",children:L(N.id)}),e.jsx("span",{className:"font-medium",children:N.name}),e.jsx(U,{variant:"secondary",className:"ml-auto",children:t("Available")})]})})},N.id))})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{variant:"outline",onClick:i,className:"flex-1",children:t("Cancel")}),e.jsxs(f,{onClick:()=>{if(!o){g.error(t("Please select a payment method"));return}if(!l||l<=0){g.error(t("Please enter a valid payment amount"));return}if(l>h){g.error(t("Payment amount cannot exceed balance due"));return}$(o)},disabled:!o||!l||l<=0,className:"flex-1",children:[t("Pay")," ",X(l)]})]})]})]})})}export{Pe as I};
