import{r as m,j as e}from"./ui-Ps9nvBG1.js";import{P as xe}from"./page-template-BeQadk1c.js";import{u as he,K as ge,t as i,P as fe,S as U,I as je,B as h,e as v,f as p,i as N,j as y,k as w}from"./app-BTt_gkO3.js";import{S as L,a as V,b as $,c as B,d as g}from"./select-z0EzYxFC.js";import{D as H}from"./date-picker-B-c0ShZi.js";import{C as K}from"./CrudFormModal-CIUswiAq.js";import{C as Se}from"./CrudDeleteModal-CAwcbZOF.js";import{D as be}from"./download-FY3rJJBK.js";import{F as ve}from"./filter-C99mLYzj.js";import{E as Ne}from"./eye-BGcEqodV.js";import{M as ye}from"./message-square-DGoN5Yg5.js";import{S as we}from"./square-pen-BE6Ef4zh.js";import{T as Ce}from"./trash-2-WsAE_ige.js";import"./vendor-B1hewrmX.js";import"./textarea-DPiv_-Qc.js";import"./react-country-flag.esm-2v5ikZ5v.js";import"./language-BbwPiY59.js";import"./loader-circle-LF6za7Wc.js";import"./trending-up-BkxnV74k.js";import"./language-switcher-AzCP_3T2.js";import"./switch-DG4amuEJ.js";import"./dropdown-menu-CvJwe1WI.js";import"./globe-BYIVGjA8.js";import"./chevron-up-CaRG6751.js";import"./building-2-CVOsE0mA.js";import"./square-check-big-B29hCoNu.js";import"./bug-DP5pb0Nw.js";import"./clock-NAV_RQL_.js";import"./credit-card-BwPrmecT.js";import"./dollar-sign-CY6xo33T.js";import"./mail-CZ8KgBhk.js";import"./settings-CG31wyPI.js";import"./user-DZ3jVi18.js";import"./triangle-alert-BuDHDWvi.js";import"./use-favicon-vjALIuby.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";import"./calendar-pZCS8WPy.js";import"./radio-group-JdhkNCQh.js";import"./circle-B-lwSO-9.js";import"./checkbox-ux8-2I9a.js";import"./scroll-area-B8km6OEG.js";function ft(){var z,P,R;const{t:s}=he(),{auth:_e,contacts:r,filters:l={},flash:x}=ge().props,[n,I]=m.useState(l.search||""),[o,C]=m.useState(l.start_date?new Date(l.start_date):void 0),[d,_]=m.useState(l.end_date?new Date(l.end_date):void 0),[c,E]=m.useState(l.status||"all"),[D,M]=m.useState(!1),[G,j]=m.useState(!1),[J,T]=m.useState(!1),[Q,F]=m.useState(!1),[f,S]=m.useState(null),[b,q]=m.useState("create");m.useEffect(()=>{x!=null&&x.success&&i.success(x.success),x!=null&&x.error&&i.error(x.error)},[x]);const k=()=>c!=="all"||n!==""||o!==void 0||d!==void 0,W=()=>(c!=="all"?1:0)+(n?1:0)+(o?1:0)+(d?1:0),X=t=>{t.preventDefault(),A()},A=()=>{const t={page:1};n&&(t.search=n),c!=="all"&&(t.status=c),o&&(t.start_date=o.toISOString().split("T")[0]),d&&(t.end_date=d.toISOString().split("T")[0]),l.per_page&&(t.per_page=l.per_page),p.get(route("contacts.index"),t,{preserveState:!0,preserveScroll:!0})},Y=t=>{E(t);const a={page:1};n&&(a.search=n),t!=="all"&&(a.status=t),o&&(a.start_date=o.toISOString().split("T")[0]),d&&(a.end_date=d.toISOString().split("T")[0]),l.per_page&&(a.per_page=l.per_page),p.get(route("contacts.index"),a,{preserveState:!0,preserveScroll:!0})},Z=t=>{const a=l.sort_field===t&&l.sort_direction==="asc"?"desc":"asc",u={sort_field:t,sort_direction:a,page:1};n&&(u.search=n),c!=="all"&&(u.status=c),o&&(u.start_date=o.toISOString().split("T")[0]),d&&(u.end_date=d.toISOString().split("T")[0]),l.per_page&&(u.per_page=l.per_page),p.get(route("contacts.index"),u,{preserveState:!0,preserveScroll:!0})},ee=()=>{S(null),q("create"),j(!0)},te=t=>{p.get(route("contacts.show",t.id))},se=t=>{S(t),q("edit"),j(!0)},ae=t=>{S(t),T(!0)},re=t=>{S(t),F(!0)},le=t=>{b==="create"?(i.loading(s("Creating contact...")),p.post(route("contacts.store"),t,{onSuccess:()=>{j(!1),i.dismiss()},onError:a=>{i.dismiss(),i.error(s("Failed to create contact"))}})):b==="edit"&&(i.loading(s("Updating contact...")),p.put(route("contacts.update",f.id),t,{onSuccess:()=>{j(!1),i.dismiss()},onError:a=>{i.dismiss(),i.error(s("Failed to update contact"))}}))},ie=t=>{i.loading(s("Updating status...")),p.put(route("contacts.update-status",f.id),t,{onSuccess:()=>{F(!1),i.dismiss()},onError:()=>{i.dismiss(),i.error(s("Failed to update status"))}})},ne=()=>{i.loading(s("Deleting contact...")),p.delete(route("contacts.destroy",f.id),{onSuccess:()=>{T(!1),i.dismiss()},onError:()=>{i.dismiss(),i.error(s("Failed to delete contact"))}})},oe=()=>{E("all"),I(""),C(void 0),_(void 0),M(!1),p.get(route("contacts.index"),{page:1,per_page:l.per_page},{preserveState:!0,preserveScroll:!0})},de=()=>{const t=new URLSearchParams;n&&t.append("search",n),c!=="all"&&t.append("status",c),o&&t.append("start_date",o.toISOString().split("T")[0]),d&&t.append("end_date",d.toISOString().split("T")[0]),window.open(route("contacts.export")+"?"+t.toString())},ce=t=>{switch(t){case"new":return"bg-blue-100 text-blue-800";case"read":return"bg-yellow-100 text-yellow-800";case"replied":return"bg-green-100 text-green-800";case"closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},me=[{label:s("Export"),icon:e.jsx(be,{className:"h-4 w-4 mr-2"}),variant:"outline",onClick:de},{label:s("Add Contact"),icon:e.jsx(fe,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:ee}],pe=[{title:s("Dashboard"),href:route("dashboard")},{title:s("Contacts")}],O=[{key:"name",label:s("Name"),sortable:!0,render:(t,a)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a.email})]})},{key:"subject",label:s("Subject"),sortable:!0,render:t=>e.jsx("div",{className:"max-w-xs truncate",title:t,children:t})},{key:"status",label:s("Status"),sortable:!0,render:t=>e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ce(t)}`,children:s(t.charAt(0).toUpperCase()+t.slice(1))})},{key:"created_at",label:s("Created At"),sortable:!0,render:t=>{var a;return((a=window.appSettings)==null?void 0:a.formatDateTime(t,!1))||new Date(t).toLocaleDateString()}}];return e.jsxs(xe,{title:s("Contact Management"),url:"/contacts",actions:me,breadcrumbs:pe,noPadding:!0,children:[e.jsx("div",{className:"bg-white rounded-lg shadow mb-4",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("form",{onSubmit:X,className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-64",children:[e.jsx(U,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(je,{placeholder:s("Search contacts..."),value:n,onChange:t=>I(t.target.value),className:"w-full pl-9"})]}),e.jsxs(h,{type:"submit",size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1.5"}),s("Search")]})]}),e.jsx("div",{className:"ml-2",children:e.jsxs(h,{variant:k()?"default":"outline",size:"sm",className:"h-8 px-2 py-1",onClick:()=>M(!D),children:[e.jsx(ve,{className:"h-3.5 w-3.5 mr-1.5"}),s(D?"Hide Filters":"Filters"),k()&&e.jsx("span",{className:"ml-1 bg-primary-foreground text-primary rounded-full w-5 h-5 flex items-center justify-center text-xs",children:W()})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"text-xs text-muted-foreground",children:s("Per Page:")}),e.jsxs(L,{value:((z=l.per_page)==null?void 0:z.toString())||"10",onValueChange:t=>{const a={page:1,per_page:parseInt(t)};n&&(a.search=n),c!=="all"&&(a.status=c),o&&(a.start_date=o.toISOString().split("T")[0]),d&&(a.end_date=d.toISOString().split("T")[0]),p.get(route("contacts.index"),a,{preserveState:!0,preserveScroll:!0})},children:[e.jsx(V,{className:"w-16 h-8",children:e.jsx($,{})}),e.jsxs(B,{children:[e.jsx(g,{value:"10",children:"10"}),e.jsx(g,{value:"25",children:"25"}),e.jsx(g,{value:"50",children:"50"}),e.jsx(g,{value:"100",children:"100"})]})]})]})]}),D&&e.jsx("div",{className:"w-full mt-3 p-4 bg-gray-50 border rounded-md",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:s("Status")}),e.jsxs(L,{value:c,onValueChange:Y,children:[e.jsx(V,{className:"w-40",children:e.jsx($,{placeholder:s("All Status")})}),e.jsxs(B,{children:[e.jsx(g,{value:"all",children:s("All Status")}),e.jsx(g,{value:"new",children:s("New")}),e.jsx(g,{value:"read",children:s("Read")}),e.jsx(g,{value:"replied",children:s("Replied")}),e.jsx(g,{value:"closed",children:s("Closed")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:s("Start Date")}),e.jsx(H,{selected:o,onSelect:C,onChange:t=>C(t)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:s("End Date")}),e.jsx(H,{selected:d,onSelect:_,onChange:t=>_(t)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:"default",size:"sm",className:"h-9",onClick:A,children:s("Apply Filters")}),e.jsx(h,{variant:"outline",size:"sm",className:"h-9",onClick:oe,disabled:!k(),children:s("Reset Filters")})]})]})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[O.map(t=>e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-500 cursor-pointer hover:bg-gray-100",onClick:()=>t.sortable&&Z(t.key),children:e.jsxs("div",{className:"flex items-center",children:[t.label,t.sortable&&e.jsx("span",{className:"ml-1",children:l.sort_field===t.key?l.sort_direction==="asc"?"↑":"↓":""})]})},t.key)),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-500",children:s("Actions")})]})}),e.jsxs("tbody",{children:[(P=r==null?void 0:r.data)==null?void 0:P.map(t=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-900 dark:hover:bg-gray-800",children:[O.map(a=>e.jsx("td",{className:"px-4 py-3",children:a.render?a.render(t[a.key],t):t[a.key]},`${t.id}-${a.key}`)),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsxs(N,{children:[e.jsx(y,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>te(t),className:"text-blue-500 hover:text-blue-700",children:e.jsx(Ne,{className:"h-4 w-4"})})}),e.jsx(w,{children:s("View")})]}),e.jsxs(N,{children:[e.jsx(y,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>re(t),className:"text-green-500 hover:text-green-700",children:e.jsx(ye,{className:"h-4 w-4"})})}),e.jsx(w,{children:s("Update Status")})]}),e.jsxs(N,{children:[e.jsx(y,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>se(t),className:"text-amber-500 hover:text-amber-700",children:e.jsx(we,{className:"h-4 w-4"})})}),e.jsx(w,{children:s("Edit")})]}),e.jsxs(N,{children:[e.jsx(y,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700",onClick:()=>ae(t),children:e.jsx(Ce,{className:"h-4 w-4"})})}),e.jsx(w,{children:s("Delete")})]})]})})]},t.id)),(!(r!=null&&r.data)||r.data.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:O.length+1,className:"px-4 py-8 text-center text-gray-500",children:s("No contacts found")})})]})]})}),e.jsxs("div",{className:"p-4 border-t flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s("Showing")," ",e.jsx("span",{className:"font-medium",children:(r==null?void 0:r.from)||0})," ",s("to")," ",e.jsx("span",{className:"font-medium",children:(r==null?void 0:r.to)||0})," ",s("of")," ",e.jsx("span",{className:"font-medium",children:(r==null?void 0:r.total)||0})," ",s("contacts")]}),e.jsx("div",{className:"flex gap-1",children:(R=r==null?void 0:r.links)==null?void 0:R.map((t,a)=>{const u=t.label==="&laquo; Previous"||t.label==="Next &raquo;",ue=t.label.replace("&laquo; ","").replace(" &raquo;","");return e.jsx(h,{variant:t.active?"default":"outline",size:u?"sm":"icon",className:u?"px-3":"h-8 w-8",disabled:!t.url,onClick:()=>t.url&&p.get(t.url),children:u?ue:e.jsx("span",{dangerouslySetInnerHTML:{__html:t.label}})},a)})})]})]}),e.jsx(K,{isOpen:G,onClose:()=>j(!1),onSubmit:le,formConfig:{fields:[{name:"name",label:s("Name"),type:"text",required:!0},{name:"email",label:s("Email"),type:"email",required:!0},{name:"subject",label:s("Subject"),type:"text",required:!0},{name:"message",label:s("Message"),type:"textarea",required:!0},{name:"status",label:s("Status"),type:"select",required:!0,options:[{value:"new",label:s("New")},{value:"read",label:s("Read")},{value:"replied",label:s("Replied")},{value:"closed",label:s("Closed")}]},{name:"admin_notes",label:s("Admin Notes"),type:"textarea",required:!1}],modalSize:"lg"},initialData:f,title:s(b==="create"?"Add Contact":"Edit Contact"),mode:b}),e.jsx(K,{isOpen:Q,onClose:()=>F(!1),onSubmit:ie,formConfig:{fields:[{name:"status",label:s("Status"),type:"select",required:!0,options:[{value:"new",label:s("New")},{value:"read",label:s("Read")},{value:"replied",label:s("Replied")},{value:"closed",label:s("Closed")}]},{name:"admin_notes",label:s("Admin Notes"),type:"textarea",required:!1}],modalSize:"md"},initialData:f,title:s("Update Contact Status"),mode:"edit"}),e.jsx(Se,{isOpen:J,onClose:()=>T(!1),onConfirm:ne,itemName:(f==null?void 0:f.name)||"",entityName:"contact"})]})}export{ft as default};
