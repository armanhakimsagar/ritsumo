import{r as d,j as e}from"./ui-Ps9nvBG1.js";import{u as q,al as X,T as D,i as W,j as E,B as u,k as M,D as $,l as J,n as K,o as Q,e as v,I as Y,X as Z,r as _,P as ee,E as S,t as j}from"./app-BTt_gkO3.js";import{S as I,a as O,b as P,c as L,d as n}from"./select-z0EzYxFC.js";import{T as se,a as te,b as y,c as g,d as ae,e as p}from"./table-CxFq10cW.js";import{C as le}from"./CrudDeleteModal-CAwcbZOF.js";import{L as re}from"./link-2-pbuNzVBD.js";import{S as ne}from"./square-pen-BE6Ef4zh.js";import{T as oe}from"./trash-2-WsAE_ige.js";import"./vendor-B1hewrmX.js";/* empty css            *//* empty css                  */import"./utils-DVuJ_tgg.js";import"./index-C9qibMqK.js";import"./chevron-up-CaRG6751.js";function Se({webhooks:z=[]}){const{t:s}=q(),[T,N]=d.useState(z),[A,c]=d.useState(!1),[m,C]=d.useState(null),[B,f]=d.useState(!1),[o,b]=d.useState(null),[h,x]=d.useState({module:"",method:"",url:""}),w=()=>{x({module:"",method:"",url:""}),C(null)},F=()=>{w(),c(!0)},R=t=>{x({module:t.module,method:t.method,url:t.url}),C(t),c(!0)},G=async t=>{var a,i;t.preventDefault();try{if(m){const l=await S.put(route("settings.webhooks.update",m.id),h);N(r=>r.map(k=>k.id===m.id?l.data.webhook:k)),j.success(l.data.message)}else{const l=await S.post(route("settings.webhooks.store"),h);N(r=>[...r,l.data.webhook]),j.success(l.data.message)}c(!1),w()}catch(l){const r=((i=(a=l.response)==null?void 0:a.data)==null?void 0:i.message)||s("An error occurred");j.error(r)}},H=t=>{b(t),f(!0)},U=async()=>{var t,a;if(o)try{const i=await S.delete(route("settings.webhooks.destroy",o.id));N(l=>l.filter(r=>r.id!==o.id)),j.success(i.data.message)}catch(i){const l=((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.message)||s("An error occurred");j.error(l)}finally{f(!1),b(null)}},V=()=>{f(!1),b(null)};return e.jsx(X,{title:s("Webhook Settings"),description:s("Manage webhooks for external integrations"),action:e.jsxs(u,{onClick:F,size:"sm",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),s("Add Webhook")]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(y,{className:"bg-gray-50 border-b",children:[e.jsx(g,{className:"py-2.5 font-semibold",children:s("Module")}),e.jsx(g,{className:"py-2.5 font-semibold",children:s("Method")}),e.jsx(g,{className:"py-2.5 font-semibold",children:s("URL")}),e.jsx(g,{className:"w-24 py-2.5 font-semibold text-right",children:s("Actions")})]})}),e.jsx(ae,{children:T.length===0?e.jsx(y,{children:e.jsx(p,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:s("No webhooks configured")})}):T.map(t=>e.jsxs(y,{className:"hover:bg-gray-50 border-b",children:[e.jsx(p,{className:"py-2.5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:t.module})]})}),e.jsx(p,{className:"py-2.5",children:e.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${t.method==="GET"?"bg-blue-50 text-blue-700 ring-blue-700/10":"bg-green-50 text-green-700 ring-green-700/10"}`,children:t.method})}),e.jsx(p,{className:"py-2.5",children:e.jsx("div",{className:"max-w-xs truncate text-sm font-mono text-muted-foreground",children:t.url})}),e.jsx(p,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(D,{children:e.jsxs(W,{children:[e.jsx(E,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",className:"h-8 w-8 text-amber-500 hover:text-amber-700",onClick:()=>R(t),children:e.jsx(ne,{className:"h-4 w-4"})})}),e.jsx(M,{children:e.jsx("p",{children:s("Edit")})})]})}),e.jsx(D,{children:e.jsxs(W,{children:[e.jsx(E,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500 hover:text-red-700",onClick:()=>H(t),children:e.jsx(oe,{className:"h-4 w-4"})})}),e.jsx(M,{children:e.jsx("p",{children:s("Delete")})})]})})]})})]},t.id))})]}),e.jsx($,{open:A,onOpenChange:c,children:e.jsxs(J,{children:[e.jsx(K,{children:e.jsx(Q,{children:s(m?"Edit Webhook":"Add New Webhook")})}),e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(v,{htmlFor:"module",children:s("Module")}),e.jsxs(I,{value:h.module,onValueChange:t=>x(a=>({...a,module:t})),children:[e.jsx(O,{children:e.jsx(P,{placeholder:s("Select module")})}),e.jsxs(L,{className:"z-[60000]",children:[e.jsx(n,{value:"Workspace Invitation",children:s("Workspace Invitation")}),e.jsx(n,{value:"New Project",children:s("New Project")}),e.jsx(n,{value:"New Task",children:s("New Task")}),e.jsx(n,{value:"New Budget",children:s("New Budget")}),e.jsx(n,{value:"New Invoice",children:s("New Invoice")})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(v,{htmlFor:"method",children:s("Method")}),e.jsxs(I,{value:h.method,onValueChange:t=>x(a=>({...a,method:t})),children:[e.jsx(O,{children:e.jsx(P,{placeholder:s("Select method")})}),e.jsxs(L,{className:"z-[60000]",children:[e.jsx(n,{value:"GET",children:"GET"}),e.jsx(n,{value:"POST",children:"POST"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(v,{htmlFor:"url",children:s("URL")}),e.jsx(Y,{id:"url",type:"url",placeholder:"https://example.com/webhook",value:h.url,onChange:t=>x(a=>({...a,url:t.target.value})),required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(u,{type:"button",variant:"outline",onClick:()=>c(!1),children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),s("Cancel")]}),e.jsxs(u,{type:"submit",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),s(m?"Update":"Create")]})]})]})]})}),e.jsx(le,{isOpen:B,onClose:V,onConfirm:U,itemName:(o==null?void 0:o.module)||"",entityName:s("Webhook")})]})})}export{Se as default};
